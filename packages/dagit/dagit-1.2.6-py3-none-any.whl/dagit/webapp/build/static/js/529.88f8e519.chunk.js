"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[529],{77523:function(e,n,r){r.d(n,{C:function(){return h}});var t=r(19065),o=r(8358),i=r(32030),s=r(75453),a=r(85370),l=r(325),c=r(93141),d=r(76336),u=r(32289),h=function(){var e=l.useContext(d.C5),n=e.allRepos,r=e.visibleRepos,h=e.toggleVisible,p=l.useState(!1),f=(0,t.Z)(p,2),x=f[0],m=f[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(o.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:x,style:{width:"auto"},onClose:function(){return m(!1)},children:[(0,u.jsx)(o.fK,{icon:"repo",label:"Filter code locations"}),(0,u.jsx)(c.e,{options:n,onBrowse:function(){return m(!1)},onToggle:h,selected:r}),(0,u.jsx)(o.cN,{children:(0,u.jsx)(i.x,{padding:{top:8},children:(0,u.jsx)(s.zx,{intent:"none",onClick:function(){return m(!1)},children:"Done"})})})]}),(0,u.jsx)(s.zx,{intent:"none",icon:(0,u.jsx)(a.JO,{name:"folder"}),rightIcon:(0,u.jsx)(a.JO,{name:"expand_more"}),onClick:function(){return m(!0)},children:"".concat(r.length," of ").concat(n.length)})]})}},78003:function(e,n,r){r.r(n),r.d(n,{OverviewRoot:function(){return Ye},default:function(){return en}});var t,o,i,s,a,l,c,d,u,h=r(325),p=r(27601),f=r(99500),x=r(95764),m=r(73701),g=r(3159),v=r(30804),j=r(31112),y=r(12745),b=r(32030),w=r(89646),k=r(47387),E=r(79082),S=r(12436),C=r(19102),O=r(78093),A=r(82348),T=r(31269),L=r(37286),N=r(32289),I=function(e){var n=e.refreshState,r=e.tab;return(0,N.jsxs)(b.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,N.jsxs)(T.mQ,{selectedTabId:r,children:[(0,N.jsx)(L.f,{id:"timeline",title:"Timeline",to:"/overview/timeline"}),(0,N.jsx)(L.f,{id:"jobs",title:"Jobs",to:"/overview/jobs"}),(0,N.jsx)(L.f,{id:"schedules",title:"Schedules",to:"/overview/schedules"}),(0,N.jsx)(L.f,{id:"sensors",title:"Sensors",to:"/overview/sensors"}),(0,N.jsx)(L.f,{id:"backfills",title:"Backfills",to:"/overview/backfills"})]}),n?(0,N.jsx)(b.x,{padding:{bottom:8},children:(0,N.jsx)(C.xi,{refreshState:n})}):null]})},z=r(79253),F=r(77892),_=r(50741),Z=r(76450),R=r(78042),P=function(){(0,O.Px)(),(0,A.j)("Overview | Backfills");var e=(0,m.a)(U),n=(0,F.l)({query:q,variables:{},pageSize:10,nextCursorForResult:function(e){var n;return"PartitionBackfills"===e.partitionBackfillsOrError.__typename?null===(n=e.partitionBackfillsOrError.results[9])||void 0===n?void 0:n.backfillId:void 0},getResultArray:function(e){return"PartitionBackfills"===(null===e||void 0===e?void 0:e.partitionBackfillsOrError.__typename)?e.partitionBackfillsOrError.results:[]}}),r=n.queryResult,t=n.paginationProps,o=(0,C.C4)(r,C.dT);return(0,N.jsxs)(v.T,{children:[(0,N.jsx)(j.m,{title:(0,N.jsx)(y.X6,{children:"Overview"}),tabs:(0,N.jsx)(I,{tab:"backfills",refreshState:o})}),(0,N.jsx)(_.g,{queryResult:r,allowStaleData:!0,children:function(n){var o,i=n.partitionBackfillsOrError;if("PythonError"===i.__typename)return(0,N.jsx)(S.T9,{error:i});if(!i.results.length)return(0,N.jsx)(b.x,{padding:{vertical:64},children:(0,N.jsx)(w.t,{icon:"no-results",title:"No backfills found",description:(0,N.jsx)("p",{children:"This instance does not have any backfill jobs."})})});var s=((null===(o=e.data)||void 0===o?void 0:o.instance.daemonHealth.allDaemonStatuses)||[]).filter((function(e){return"BACKFILL"===e.daemonType})).map((function(e){return e.required&&e.healthy})),a=s.length&&s.every((function(e){return e}));return(0,N.jsxs)("div",{children:[a?null:(0,N.jsx)(b.x,{padding:{horizontal:24,vertical:16},children:(0,N.jsx)(z.B1,{})}),(0,N.jsx)(Z.G,{backfills:i.results.slice(0,10),refetch:r.refetch}),i.results.length>0?(0,N.jsx)("div",{style:{marginTop:"16px"},children:(0,N.jsx)(k.b$,(0,x.Z)({},t))}):null]})}})]})},U=(0,g.Ps)(t||(t=(0,f.Z)(["\n  query InstanceHealthForBackfillsQuery {\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n"])),R.O),q=(0,g.Ps)(o||(o=(0,f.Z)(["\n  query InstanceBackfillsQuery($cursor: String, $limit: Int) {\n    partitionBackfillsOrError(cursor: $cursor, limit: $limit) {\n      ... on PartitionBackfills {\n        results {\n          backfillId\n          status\n          isValidSerialization\n          numPartitions\n          timestamp\n          partitionSetName\n          partitionSet {\n            id\n            name\n            mode\n            pipelineName\n            repositoryOrigin {\n              id\n              repositoryName\n              repositoryLocationName\n            }\n          }\n          error {\n            ...PythonErrorFragment\n          }\n\n          ...BackfillTableFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),E.B,Z.b),B=r(47427),$=r(19065),M=r(34595),V=r(7838),W=r(88863),D=r(39061),K=r(44198),H=r(77523),J=r(76336),Q=r(37099),G=r(33902),X=r(11831),Y=r(54268),ee=r(519),ne=r(3580),re=r(65864),te=r(71824),oe=r(82426),ie=r(16279),se=r(13688),ae=function(e){var n=e.repos,r=h.useRef(null),t=h.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,G.Uz)(n)}))}),[n]),o=(0,te.N)(se.y,t),i=o.expandedKeys,s=o.onToggle,a=o.onToggleAll,l=h.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.jobs;e.push({type:"header",repoAddress:r,jobCount:t.length});var o=(0,G.Uz)(r);i.includes(o)&&t.forEach((function(n){var t=n.isJob,o=n.name;e.push({type:"job",repoAddress:r,isJob:t,name:o})}))})),e}),[n,i]),c=(0,re.w)(n.map((function(e){return e.repoAddress.name}))),d=(0,ee.useVirtualizer)({count:l.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=l[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),u=d.getTotalSize(),p=d.getVirtualItems();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(oe.I,{}),(0,N.jsx)("div",{style:{overflow:"hidden"},children:(0,N.jsx)(ne.W2,{ref:r,children:(0,N.jsx)(ne.Nh,{$totalHeight:u,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,o=e.start,d=l[n];return"header"===d.type?(0,N.jsx)(ie.vG,{repoAddress:d.repoAddress,height:t,start:o,onToggle:s,onToggleAll:a,expanded:i.includes((0,G.Uz)(d.repoAddress)),showLocation:c.has(d.repoAddress.name),rightElement:(0,N.jsx)(X.u,{content:1===d.jobCount?"1 job":"".concat(d.jobCount," jobs"),placement:"top",children:(0,N.jsx)(Y.V,{children:d.jobCount})})},r):(0,N.jsx)(oe.b,{name:d.name,isJob:d.isJob,repoAddress:d.repoAddress,height:t,start:o},r)}))})})})]})},le=r(59019),ce=function(e){return(0,le.Z)(e).sort((function(e,n){var r=(0,G.Uz)(e.repoAddress),t=(0,G.Uz)(n.repoAddress);return r.localeCompare(t)}))},de=function(e){return new Set(e.map((function(e){return(0,G.Uz)((0,Q.kQ)(e.repository.name,e.repositoryLocation.name))})))},ue=function(){(0,O.Px)(),(0,A.j)("Overview | Jobs");var e=h.useContext(J.C5),n=e.allRepos,r=e.visibleRepos,t=(0,K.q)({queryKey:"search",defaults:{search:""}}),o=(0,$.Z)(t,2),i=o[0],s=o[1],a=n.length,l=(0,m.a)(pe,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),c=l.data,d=l.loading,u=(0,C.C4)(l,C.dT),p=h.useMemo((function(){var e=de(r);return he(c).filter((function(n){var r=n.repoAddress;return e.has((0,G.Uz)(r))}))}),[c,r]),f=i.trim().toLocaleLowerCase(),x=f.length>0,g=h.useMemo((function(){var e=f.toLocaleLowerCase();return p.map((function(n){return{repoAddress:n.repoAddress,jobs:n.jobs.filter((function(n){return n.name.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.jobs.length>0}))}),[p,f]);return(0,N.jsxs)(b.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,N.jsx)(j.m,{title:(0,N.jsx)(y.X6,{children:"Overview"}),tabs:(0,N.jsx)(I,{tab:"jobs",refreshState:u})}),(0,N.jsxs)(b.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[a>1?(0,N.jsx)(H.C,{}):null,(0,N.jsx)(W.oi,{icon:"search",value:i,onChange:function(e){return s(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"340px"}})]}),d&&!a?(0,N.jsx)(b.x,{padding:64,children:(0,N.jsx)(M.$,{purpose:"page"})}):function(){if(d&&!c)return(0,N.jsx)(b.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,N.jsxs)(b.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,N.jsx)(M.$,{purpose:"body-text"}),(0,N.jsx)("div",{style:{color:V.w.Gray600},children:"Loading jobs\u2026"})]})});var e=n.length>r.length;return g.length?(0,N.jsx)(ae,{repos:g}):x?(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No matching jobs",description:e?(0,N.jsxs)("div",{children:["No jobs matching ",(0,N.jsx)("strong",{children:i})," were found in the selected code locations"]}):(0,N.jsxs)("div",{children:["No jobs matching ",(0,N.jsx)("strong",{children:i})," were found in your definitions"]})})}):(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},he=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],o=(0,B.Z)(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,B.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.pipelines,u=(0,Q.kQ)(c,i.name),h=d.filter((function(e){var n=e.name;return!(0,D.pv)(n)})).map((function(e){return{isJob:e.isJob,name:e.name}}));h.length>0&&t.push({repoAddress:u,jobs:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return ce(t)},pe=(0,g.Ps)(i||(i=(0,f.Z)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"])),E.B),fe=r(60736),xe=r(75453),me=r(8358),ge=r(45352),ve=r(56313),je=r(89324),ye=r(31834),be=function(e){var n=e.repos,r=h.useRef(null),t=h.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,G.Uz)(n)}))}),[n]),o=(0,te.N)(se.y,t),i=o.expandedKeys,s=o.onToggle,a=o.onToggleAll,l=h.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.schedules;e.push({type:"header",repoAddress:r,scheduleCount:t.length});var o=(0,G.Uz)(r);i.includes(o)&&t.forEach((function(n){e.push({type:"schedule",repoAddress:r,name:n})}))})),e}),[n,i]),c=(0,re.w)(n.map((function(e){return e.repoAddress.name}))),d=(0,ee.useVirtualizer)({count:l.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=l[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),u=d.getTotalSize(),p=d.getVirtualItems();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ye.o,{}),(0,N.jsx)("div",{style:{overflow:"hidden"},children:(0,N.jsx)(ne.W2,{ref:r,children:(0,N.jsx)(ne.Nh,{$totalHeight:u,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,o=e.start,d=l[n];return"header"===d.type?(0,N.jsx)(ie.vG,{repoAddress:d.repoAddress,height:t,start:o,onToggle:s,onToggleAll:a,expanded:i.includes((0,G.Uz)(d.repoAddress)),showLocation:c.has(d.repoAddress.name),rightElement:(0,N.jsx)(X.u,{content:1===d.scheduleCount?"1 schedule":"".concat(d.scheduleCount," schedules"),placement:"top",children:(0,N.jsx)(Y.V,{children:d.scheduleCount})})},r):(0,N.jsx)(ye.i,{name:d.name,repoAddress:d.repoAddress,height:t,start:o},r)}))})})})]})},we=function(){(0,O.Px)(),(0,A.j)("Overview | Schedules");var e=h.useContext(J.C5),n=e.allRepos,r=e.visibleRepos,t=n.length,o=(0,K.q)({queryKey:"search",defaults:{search:""}}),i=(0,$.Z)(o,2),s=i[0],a=i[1],l=(0,m.a)(Ce,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),c=l.data,d=l.loading,u=(0,C.C4)(l,C.dT),p=h.useMemo((function(){var e=de(r);return Se(c).filter((function(n){var r=n.repoAddress;return e.has((0,G.Uz)(r))}))}),[c,r]),f=s.trim().toLocaleLowerCase(),x=f.length>0,g=h.useMemo((function(){var e=f.toLocaleLowerCase();return p.map((function(n){return{repoAddress:n.repoAddress,schedules:n.schedules.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.schedules.length>0}))}),[p,f]);return(0,N.jsxs)(b.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,N.jsx)(j.m,{title:(0,N.jsx)(y.X6,{children:"Overview"}),tabs:(0,N.jsx)(I,{tab:"schedules",refreshState:u})}),(0,N.jsxs)(b.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[t>0?(0,N.jsx)(H.C,{}):null,(0,N.jsx)(W.oi,{icon:"search",value:s,onChange:function(e){return a(e.target.value)},placeholder:"Filter by schedule name\u2026",style:{width:"340px"}})]}),d&&!t?(0,N.jsx)(b.x,{padding:64,children:(0,N.jsx)(M.$,{purpose:"page"})}):(0,N.jsxs)(N.Fragment,{children:["InstigationStates"===(null===c||void 0===c?void 0:c.unloadableInstigationStatesOrError.__typename)?(0,N.jsx)(ke,{count:c.unloadableInstigationStatesOrError.results.length}):null,(0,N.jsx)(je.K,{daemonHealth:null===c||void 0===c?void 0:c.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:V.w.KeylineGray}}),function(){if(d&&!c)return(0,N.jsx)(b.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,N.jsxs)(b.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,N.jsx)(M.$,{purpose:"body-text"}),(0,N.jsx)("div",{style:{color:V.w.Gray600},children:"Loading schedules\u2026"})]})});var e=n.length>r.length;return g.length?(0,N.jsx)(be,{repos:g}):x?(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No matching schedules",description:e?(0,N.jsxs)("div",{children:["No schedules matching ",(0,N.jsx)("strong",{children:s})," were found in the selected code locations"]}):(0,N.jsxs)("div",{children:["No schedules matching ",(0,N.jsx)("strong",{children:s})," were found in your definitions"]})})}):(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No schedules",description:e?"No schedules were found in the selected code locations":"No schedules were found in your definitions"})})}()]})]})},ke=function(e){var n=e.count,r=h.useState(!1),t=(0,$.Z)(r,2),o=t[0],i=t[1];if(!n)return null;var s=1===n?"1 unloadable schedule":"".concat(n," unloadable schedules");return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(b.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:V.w.KeylineGray},children:(0,N.jsx)(fe.b,{intent:"warning",title:s,description:(0,N.jsxs)(b.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,N.jsx)("div",{children:"Schedules were previously started but now cannot be loaded. They may be part of a code locations that no longer exist. You can turn them off, but you cannot turn them back on."}),(0,N.jsx)(xe.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable schedule":"View unloadable schedules"})]})})}),(0,N.jsxs)(me.Vq,{isOpen:o,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,N.jsx)(b.x,{padding:{bottom:8},children:(0,N.jsx)(Ee,{})}),(0,N.jsx)(me.cN,{children:(0,N.jsx)(xe.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},Ee=function(){var e=(0,m.a)(Oe).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,N.jsx)(ve.Y,{scheduleStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,N.jsx)(S.T9,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,N.jsx)(M.$,{purpose:"section"})},Se=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],o=(0,B.Z)(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,B.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.schedules,u=(0,Q.kQ)(c,i.name),h=d.map((function(e){return e.name}));h.length>0&&t.push({repoAddress:u,schedules:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return ce(t)},Ce=(0,g.Ps)(s||(s=(0,f.Z)(["\n  query OverviewSchedulesQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                schedules {\n                  id\n                  name\n                  description\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),E.B,R.O),Oe=(0,g.Ps)(a||(a=(0,f.Z)(["\n  query UnloadableSchedulesQuery {\n    unloadableInstigationStatesOrError(instigationType: SCHEDULE) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),ge.ai,E.B),Ae=r(57466),Te=r(19377),Le=function(e){var n=e.repos,r=h.useRef(null),t=h.useMemo((function(){return n.map((function(e){var n=e.repoAddress;return(0,G.Uz)(n)}))}),[n]),o=(0,te.N)(se.y,t),i=o.expandedKeys,s=o.onToggle,a=o.onToggleAll,l=h.useMemo((function(){var e=[];return n.forEach((function(n){var r=n.repoAddress,t=n.sensors;e.push({type:"header",repoAddress:r,sensorCount:t.length});var o=(0,G.Uz)(r);i.includes(o)&&t.forEach((function(n){e.push({type:"sensor",repoAddress:r,name:n})}))})),e}),[n,i]),c=(0,re.w)(n.map((function(e){return e.repoAddress.name}))),d=(0,ee.useVirtualizer)({count:l.length,getScrollElement:function(){return r.current},estimateSize:function(e){var n=l[e];return"header"===(null===n||void 0===n?void 0:n.type)?32:64},overscan:10}),u=d.getTotalSize(),p=d.getVirtualItems();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Te.K,{}),(0,N.jsx)("div",{style:{overflow:"hidden"},children:(0,N.jsx)(ne.W2,{ref:r,children:(0,N.jsx)(ne.Nh,{$totalHeight:u,children:p.map((function(e){var n=e.index,r=e.key,t=e.size,o=e.start,d=l[n];return"header"===d.type?(0,N.jsx)(ie.vG,{repoAddress:d.repoAddress,height:t,start:o,onToggle:s,onToggleAll:a,expanded:i.includes((0,G.Uz)(d.repoAddress)),showLocation:c.has(d.repoAddress.name),rightElement:(0,N.jsx)(X.u,{content:1===d.sensorCount?"1 sensor":"".concat(d.sensorCount," sensors"),placement:"top",children:(0,N.jsx)(Y.V,{children:d.sensorCount})})},r):(0,N.jsx)(Te.R,{name:d.name,repoAddress:d.repoAddress,height:t,start:o},r)}))})})})]})},Ne=function(){(0,O.Px)(),(0,A.j)("Overview | Sensors");var e=h.useContext(J.C5),n=e.allRepos,r=e.visibleRepos,t=n.length,o=(0,K.q)({queryKey:"search",defaults:{search:""}}),i=(0,$.Z)(o,2),s=i[0],a=i[1],l=(0,m.a)(_e,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),c=l.data,d=l.loading,u=(0,C.C4)(l,C.dT),p=h.useMemo((function(){var e=de(r);return Fe(c).filter((function(n){var r=n.repoAddress;return e.has((0,G.Uz)(r))}))}),[c,r]),f=s.trim().toLocaleLowerCase(),x=f.length>0,g=h.useMemo((function(){var e=f.toLocaleLowerCase();return p.map((function(n){return{repoAddress:n.repoAddress,sensors:n.sensors.filter((function(n){return n.toLocaleLowerCase().includes(e)}))}})).filter((function(e){return e.sensors.length>0}))}),[p,f]);return(0,N.jsxs)(b.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,N.jsx)(j.m,{title:(0,N.jsx)(y.X6,{children:"Overview"}),tabs:(0,N.jsx)(I,{tab:"sensors",refreshState:u})}),(0,N.jsxs)(b.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[t>0?(0,N.jsx)(H.C,{}):null,(0,N.jsx)(W.oi,{icon:"search",value:s,onChange:function(e){return a(e.target.value)},placeholder:"Filter by sensor name\u2026",style:{width:"340px"}})]}),d&&!t?(0,N.jsx)(b.x,{padding:64,children:(0,N.jsx)(M.$,{purpose:"page"})}):(0,N.jsxs)(N.Fragment,{children:["InstigationStates"===(null===c||void 0===c?void 0:c.unloadableInstigationStatesOrError.__typename)?(0,N.jsx)(Ie,{count:c.unloadableInstigationStatesOrError.results.length}):null,(0,N.jsx)(Ae.F,{daemonHealth:null===c||void 0===c?void 0:c.instance.daemonHealth,padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:V.w.KeylineGray}}),function(){if(d&&!c)return(0,N.jsx)(b.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,N.jsxs)(b.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,N.jsx)(M.$,{purpose:"body-text"}),(0,N.jsx)("div",{style:{color:V.w.Gray600},children:"Loading sensors\u2026"})]})});var e=n.length>r.length;return g.length?(0,N.jsx)(Le,{repos:g}):x?(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No matching sensors",description:e?(0,N.jsxs)("div",{children:["No sensors matching ",(0,N.jsx)("strong",{children:s})," were found in the selected code locations"]}):(0,N.jsxs)("div",{children:["No sensors matching ",(0,N.jsx)("strong",{children:s})," were found in your definitions"]})})}):(0,N.jsx)(b.x,{padding:{top:20},children:(0,N.jsx)(w.t,{icon:"search",title:"No sensors",description:e?"No sensors were found in the selected code locations":"No sensors were found in your definitions"})})}()]})]})},Ie=function(e){var n=e.count,r=h.useState(!1),t=(0,$.Z)(r,2),o=t[0],i=t[1];if(!n)return null;var s=1===n?"1 unloadable sensor":"".concat(n," unloadable sensors");return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(b.x,{padding:{vertical:16,horizontal:24},border:{side:"top",width:1,color:V.w.KeylineGray},children:(0,N.jsx)(fe.b,{intent:"warning",title:s,description:(0,N.jsxs)(b.x,{flex:{direction:"column",gap:12,alignItems:"flex-start"},children:[(0,N.jsx)("div",{children:"Sensors were previously started but now cannot be loaded. They may be part of a code location that no longer exists. You can turn them off, but you cannot turn them back on."}),(0,N.jsx)(xe.zx,{onClick:function(){return i(!0)},children:1===n?"View unloadable sensor":"View unloadable sensors"})]})})}),(0,N.jsxs)(me.Vq,{isOpen:o,title:"Unloadable schedules",style:{width:"90vw",maxWidth:"1200px"},children:[(0,N.jsx)(b.x,{padding:{bottom:8},children:(0,N.jsx)(ze,{})}),(0,N.jsx)(me.cN,{children:(0,N.jsx)(xe.zx,{intent:"primary",onClick:function(){return i(!1)},children:"Done"})})]})]})},ze=function(){var e=(0,m.a)(Ze).data;return e?"InstigationStates"===(null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError.__typename)?(0,N.jsx)(ve.e,{sensorStates:e.unloadableInstigationStatesOrError.results,showSubheading:!1}):(0,N.jsx)(S.T9,{error:null===e||void 0===e?void 0:e.unloadableInstigationStatesOrError}):(0,N.jsx)(M.$,{purpose:"section"})},Fe=function(e){if("Workspace"!==(null===e||void 0===e?void 0:e.workspaceOrError.__typename))return[];var n,r=e.workspaceOrError.locationEntries.map((function(e){return e.locationOrLoadError})),t=[],o=(0,B.Z)(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("RepositoryLocation"===(null===i||void 0===i?void 0:i.__typename)){var s,a=(0,B.Z)(i.repositories);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,d=l.sensors,u=(0,Q.kQ)(c,i.name),h=d.map((function(e){return e.name}));h.length>0&&t.push({repoAddress:u,sensors:h})}}catch(p){a.e(p)}finally{a.f()}}}}catch(p){o.e(p)}finally{o.f()}return ce(t)},_e=(0,g.Ps)(l||(l=(0,f.Z)(["\n  query OverviewSensorsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                sensors {\n                  id\n                  name\n                  description\n                  sensorType\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n        }\n      }\n    }\n    instance {\n      ...InstanceHealthFragment\n    }\n  }\n\n  ","\n  ","\n"])),E.B,R.O),Ze=(0,g.Ps)(c||(c=(0,f.Z)(["\n  query UnloadableSensorsQuery {\n    unloadableInstigationStatesOrError(instigationType: SENSOR) {\n      ... on InstigationStates {\n        results {\n          id\n          ...InstigationStateFragment\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"])),ge.ai,E.B),Re=r(87011),Pe=r(32028),Ue=r(52453),qe=r(76314),Be=r(16798),$e=r(69305),Me=(r(68156),(0,g.Ps)(d||(d=(0,f.Z)(["\n  fragment ScheduleFutureTicksFragment on Schedule {\n    id\n    executionTimezone\n    scheduleState {\n      id\n      status\n    }\n    futureTicks(cursor: $tickCursor, until: $ticksUntil) {\n      results {\n        timestamp\n      }\n    }\n  }\n"])))),Ve=r(25582),We=r(34653),De=r(55752),Ke=r(18499),He=function(e,n){return"".concat(n,"-").concat((0,G.Uz)(e))},Je=(0,g.Ps)(u||(u=(0,f.Z)(["\n  query RunTimelineQuery(\n    $inProgressFilter: RunsFilter!\n    $terminatedFilter: RunsFilter!\n    $tickCursor: Float\n    $ticksUntil: Float\n  ) {\n    unterminated: runsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    terminated: runsOrError(filter: $terminatedFilter) {\n      ... on Runs {\n        results {\n          id\n          pipelineName\n          repositoryOrigin {\n            id\n            repositoryName\n            repositoryLocationName\n          }\n          ...RunTimeFragment\n        }\n      }\n    }\n    workspaceOrError {\n      ... on Workspace {\n        locationEntries {\n          id\n          name\n          loadStatus\n          displayMetadata {\n            key\n            value\n          }\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n                schedules {\n                  id\n                  name\n                  pipelineName\n                  scheduleState {\n                    id\n                    status\n                  }\n                  ...ScheduleFutureTicksFragment\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n"])),De.$X,Me),Qe=36e5,Ge=function(e){switch(e){case"1":return Qe;case"6":return 216e5;case"12":return 432e5;case"24":return 864e5}},Xe=function(){(0,O.Px)(),(0,A.j)("Overview | Timeline");var e=h.useContext(J.C5),n=e.allRepos,r=e.visibleRepos,t=function(e){var n=h.useCallback((function(n){switch(n){case"1":case"6":case"12":case"24":return n;default:return e}}),[e]),r=(0,qe.U)("dagit.run-timeline-hour-window",n),t=(0,$.Z)(r,2),o=t[0],i=t[1],s=h.useCallback((function(n){i(n||e)}),[e,i]);return h.useMemo((function(){return[o,s]}),[o,s])}("12"),o=(0,$.Z)(t,2),i=o[0],s=o[1],a=h.useState((function(){return Date.now()})),l=(0,$.Z)(a,2),c=l[0],d=l[1],u=h.useState((function(){return 0})),p=(0,$.Z)(u,2),f=p[0],g=p[1],w=(0,K.q)({queryKey:"search",defaults:{search:""}}),k=(0,$.Z)(w,2),E=k[0],S=k[1];h.useEffect((function(){d(Date.now());var e=setInterval((function(){d(Date.now())}),6e4);return function(){clearInterval(e)}}),[i]);var T=h.useCallback((function(){g((function(e){return e-Ge(i)}))}),[i]),L=h.useCallback((function(){g((function(e){return e+Ge(i)}))}),[i]),z=h.useCallback((function(){g(0)}),[]),F=h.useMemo((function(){return[c-Number(i)*Qe+f,c+36e5+f]}),[i,c,f]),_=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,$.Z)(e,2),t=r[0],o=r[1],i=t/1e3,s=o/1e3,a=(0,m.a)(Je,{notifyOnNetworkStatusChange:!0,variables:{inProgressFilter:(0,x.Z)((0,x.Z)({},n),{},{statuses:[$e.VOA.CANCELING,$e.VOA.STARTED],createdBefore:s}),terminatedFilter:(0,x.Z)((0,x.Z)({},n),{},{statuses:Array.from(We.cv),createdBefore:s,updatedAfter:i}),tickCursor:i,ticksUntil:s}}),l=a.data,c=a.previousData,d=a.loading&&!l,u=l||c||{},p=u.unterminated,f=u.terminated,g=u.workspaceOrError,v=h.useMemo((function(){var e={},n=Date.now();return[].concat((0,le.Z)("Runs"===(null===p||void 0===p?void 0:p.__typename)?p.results:[]),(0,le.Z)("Runs"===(null===f||void 0===f?void 0:f.__typename)?f.results:[])).forEach((function(r){if(r.startTime&&r.repositoryOrigin&&(0,Ke.a)({start:t,end:o},{start:1e3*r.startTime,end:r.endTime?1e3*r.endTime:n})){var i=He({name:r.repositoryOrigin.repositoryName,location:r.repositoryOrigin.repositoryLocationName},r.pipelineName);e[i]=[].concat((0,le.Z)(e[i]||[]),[{id:r.id,status:r.status,startTime:1e3*r.startTime,endTime:r.endTime?1e3*r.endTime:n}])}})),e}),[o,p,f,t]),j=h.useMemo((function(){if(!g||"Workspace"!==g.__typename)return[];var e,n=[],r=(0,B.Z)(g.locationEntries);try{var i=function(){var r,i=e.value;if("WorkspaceLocationEntry"!==i.__typename||"RepositoryLocation"!==(null===(r=i.locationOrLoadError)||void 0===r?void 0:r.__typename))return"continue";var s,a=Date.now(),l=(0,B.Z)(i.locationOrLoadError.repositories);try{for(l.s();!(s=l.n()).done;){var c,d=s.value,u=(0,Q.kQ)(d.name,i.locationOrLoadError.name),h=(0,B.Z)(d.pipelines);try{var p=function(){var e,r=c.value,i=(d.schedules||[]).filter((function(e){return e.pipelineName===r.name})),s=[],l=(0,B.Z)(i);try{var h=function(){var n=e.value;n.scheduleState.status===$e.ynu.RUNNING&&n.futureTicks.results.forEach((function(e){var r=e.timestamp,i=1e3*r;i>a&&(0,Ke.a)({start:t,end:o},{start:i,end:i})&&s.push({id:"".concat(n.pipelineName,"-future-run-").concat(r),status:"SCHEDULED",startTime:i,endTime:i+5e3})}))};for(l.s();!(e=l.n()).done;)h()}catch(g){l.e(g)}finally{l.f()}var p=(0,D.pv)(r.name),f=He(u,r.name),x=p?"Ad hoc materializations":r.name,m=v[f]||[];(s.length||m.length)&&n.push({key:f,jobName:x,jobType:p?"asset":"job",repoAddress:u,path:(0,Ve.jT)({repoName:u.name,repoLocation:u.location,pipelineName:r.name,isJob:r.isJob}),runs:[].concat((0,le.Z)(m),s)})};for(h.s();!(c=h.n()).done;)p()}catch(f){h.e(f)}finally{h.f()}}}catch(f){l.e(f)}finally{l.f()}};for(r.s();!(e=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}var s=n.reduce((function(e,n){var r=n.runs.map((function(e){return e.startTime}));return(0,x.Z)((0,x.Z)({},e),{},(0,Be.Z)({},n.key,Math.min.apply(Math,(0,le.Z)(r))))}),{});return n.sort((function(e,n){return s[e.key]-s[n.key]}))}),[g,v,t,o]);return h.useMemo((function(){return{jobs:j,initialLoading:d,queryData:a}}),[d,j,a])}(F),Z=_.jobs,R=_.initialLoading,P=_.queryData,U=(0,C.C4)(P,C.dT),q=h.useMemo((function(){var e=E.toLocaleLowerCase().trim(),n=r.flatMap((function(n){var r=(0,Q.kQ)(n.repository.name,n.repositoryLocation.name);return n.repository.pipelines.filter((function(n){return n.name.toLocaleLowerCase().includes(e)})).map((function(e){return He(r,e.name)}))}));return new Set(n)}),[r,E]),M=h.useMemo((function(){return Z.filter((function(e){var n=e.key;return q.has(n)}))}),[Z,q]);return(0,N.jsxs)(v.T,{children:[(0,N.jsx)(j.m,{title:(0,N.jsx)(y.X6,{children:"Overview"}),tabs:(0,N.jsx)(I,{tab:"timeline",refreshState:U})}),(0,N.jsxs)(b.x,{padding:{horizontal:24,vertical:16},flex:{alignItems:"center",justifyContent:"space-between"},children:[(0,N.jsxs)(b.x,{flex:{direction:"row",alignItems:"center",gap:12,grow:0},children:[n.length>1&&(0,N.jsx)(H.C,{}),(0,N.jsx)(W.oi,{icon:"search",value:E,onChange:function(e){return S(e.target.value)},placeholder:"Filter by job name\u2026",style:{width:"200px"}})]}),(0,N.jsxs)(b.x,{flex:{direction:"row",gap:16,alignItems:"center"},children:[(0,N.jsx)(Re.h,{activeItems:new Set([i]),buttons:[{id:"1",label:"1hr"},{id:"6",label:"6hr"},{id:"12",label:"12hr"},{id:"24",label:"24hr"}],onClick:function(e){return s(e)}}),(0,N.jsxs)(b.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,N.jsx)(xe.zx,{onClick:T,children:"\u2190"}),(0,N.jsx)(xe.zx,{onClick:z,children:"Now"}),(0,N.jsx)(xe.zx,{onClick:L,children:"\u2192"})]})]})]}),(0,N.jsx)(Pe.S,{region:"timeline",children:(0,N.jsx)(Ue.q,{loading:R,range:F,jobs:M})})]})},Ye=function(){return(0,N.jsxs)(p.rs,{children:[(0,N.jsx)(p.AW,{path:"/overview/timeline",children:(0,N.jsx)(Xe,{})}),(0,N.jsx)(p.AW,{path:"/overview/jobs",children:(0,N.jsx)(ue,{})}),(0,N.jsx)(p.AW,{path:"/overview/schedules",children:(0,N.jsx)(we,{})}),(0,N.jsx)(p.AW,{path:"/overview/sensors",children:(0,N.jsx)(Ne,{})}),(0,N.jsx)(p.AW,{path:"/overview/backfills",children:(0,N.jsx)(P,{})}),(0,N.jsx)(p.AW,{path:"*",render:function(){return(0,N.jsx)(p.l_,{to:"/overview/timeline"})}})]})},en=Ye}}]);
//# sourceMappingURL=529.88f8e519.chunk.js.map