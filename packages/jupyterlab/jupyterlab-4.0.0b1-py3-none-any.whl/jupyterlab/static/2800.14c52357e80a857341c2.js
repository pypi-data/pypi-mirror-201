"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[2800],{52800:(e,t,r)=>{r.r(t);r.d(t,{RegExpCursor:()=>u,SearchCursor:()=>a,SearchQuery:()=>V,closeSearchPanel:()=>ue,findNext:()=>re,findPrevious:()=>ie,getSearchQuery:()=>U,gotoLine:()=>w,highlightSelectionMatches:()=>k,openSearchPanel:()=>he,replaceAll:()=>le,replaceNext:()=>oe,search:()=>I,searchKeymap:()=>fe,searchPanelOpen:()=>J,selectMatches:()=>ne,selectNextOccurrence:()=>F,selectSelectionMatches:()=>se,setSearchQuery:()=>K});var i=r(48839);var n=r(37496);function s(){var e=arguments[0];if(typeof e=="string")e=document.createElement(e);var t=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var n=r[i];if(typeof n=="string")e.setAttribute(i,n);else if(n!=null)e[i]=n}t++}for(;t<arguments.length;t++)o(e,arguments[t]);return e}function o(e,t){if(typeof t=="string"){e.appendChild(document.createTextNode(t))}else if(t==null){}else if(t.nodeType!=null){e.appendChild(t)}else if(Array.isArray(t)){for(var r=0;r<t.length;r++)o(e,t[r])}else{throw new RangeError("Unsupported child node: "+t)}}const l=typeof String.prototype.normalize=="function"?e=>e.normalize("NFKD"):e=>e;class a{constructor(e,t,r=0,i=e.length,n,s){this.test=s;this.value={from:0,to:0};this.done=false;this.matches=[];this.buffer="";this.bufferPos=0;this.iter=e.iterRange(r,i);this.bufferStart=r;this.normalize=n?e=>n(l(e)):l;this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){this.bufferStart+=this.buffer.length;this.iter.next();if(this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value}return(0,n.codePointAt)(this.buffer,this.bufferPos)}next(){while(this.matches.length)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0){this.done=true;return this}let t=(0,n.fromCodePoint)(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=(0,n.codePointSize)(e);let i=this.normalize(t);for(let n=0,s=r;;n++){let e=i.charCodeAt(n);let o=this.match(e,s);if(o){this.value=o;return this}if(n==i.length-1)break;if(s==r&&n<t.length&&t.charCodeAt(n)==e)s++}}}match(e,t){let r=null;for(let i=0;i<this.matches.length;i+=2){let n=this.matches[i],s=false;if(this.query.charCodeAt(n)==e){if(n==this.query.length-1){r={from:this.matches[i+1],to:t+1}}else{this.matches[i]++;s=true}}if(!s){this.matches.splice(i,2);i-=2}}if(this.query.charCodeAt(0)==e){if(this.query.length==1)r={from:t,to:t+1};else this.matches.push(1,t)}if(r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferPos))r=null;return r}}if(typeof Symbol!="undefined")a.prototype[Symbol.iterator]=function(){return this};const c={from:-1,to:-1,match:/.*/.exec("")};const h="gm"+(/x/.unicode==null?"":"u");class u{constructor(e,t,r,i=0,n=e.length){this.text=e;this.to=n;this.curLine="";this.done=false;this.value=c;if(/\\[sWDnr]|\n|\r|\[\^/.test(t))return new p(e,t,r,i,n);this.re=new RegExp(t,h+((r===null||r===void 0?void 0:r.ignoreCase)?"i":""));this.test=r===null||r===void 0?void 0:r.test;this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from;this.matchPos=g(e,i);this.getLine(this.curLineStart)}getLine(e){this.iter.next(e);if(this.iter.lineBreak){this.curLine=""}else{this.curLine=this.iter.value;if(this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next()}}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;if(this.curLineStart>this.to)this.curLine="";else this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;this.matchPos=g(this.text,i+(r==i?1:0));if(r==this.curLineStart+this.curLine.length)this.nextLine();if((r<i||r>this.value.to)&&(!this.test||this.test(r,i,t))){this.value={from:r,to:i,match:t};return this}e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to){this.nextLine();e=0}else{this.done=true;return this}}}}const f=new WeakMap;class d{constructor(e,t){this.from=e;this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=f.get(e);if(!i||i.from>=r||i.to<=t){let i=new d(t,e.sliceString(t,r));f.set(e,i);return i}if(i.from==t&&i.to==r)return i;let{text:n,from:s}=i;if(s>t){n=e.sliceString(t,s)+n;s=t}if(i.to<r)n+=e.sliceString(i.to,r);f.set(e,new d(s,n));return new d(t,n.slice(t-s,r-s))}}class p{constructor(e,t,r,i,n){this.text=e;this.to=n;this.done=false;this.value=c;this.matchPos=g(e,i);this.re=new RegExp(t,h+((r===null||r===void 0?void 0:r.ignoreCase)?"i":""));this.test=r===null||r===void 0?void 0:r.test;this.flat=d.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from;let t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e){this.re.lastIndex=e+1;t=this.re.exec(this.flat.text)}if(t){let e=this.flat.from+t.index,r=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,r,t))){this.value={from:e,to:r,match:t};this.matchPos=g(this.text,r+(e==r?1:0));return this}}if(this.flat.to==this.to){this.done=true;return this}this.flat=d.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}if(typeof Symbol!="undefined"){u.prototype[Symbol.iterator]=p.prototype[Symbol.iterator]=function(){return this}}function m(e){try{new RegExp(e,h);return true}catch(t){return false}}function g(e,t){if(t>=e.length)return t;let r=e.lineAt(t),i;while(t<r.to&&(i=r.text.charCodeAt(t-r.from))>=56320&&i<57344)t++;return t}function v(e){let t=s("input",{class:"cm-textfield",name:"line"});let r=s("form",{class:"cm-gotoLine",onkeydown:t=>{if(t.keyCode==27){t.preventDefault();e.dispatch({effects:x.of(false)});e.focus()}else if(t.keyCode==13){t.preventDefault();i()}},onsubmit:e=>{e.preventDefault();i()}},s("label",e.state.phrase("Go to line"),": ",t)," ",s("button",{class:"cm-button",type:"submit"},e.state.phrase("go")));function i(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!r)return;let{state:i}=e,s=i.doc.lineAt(i.selection.main.head);let[,o,l,a,c]=r;let h=a?+a.slice(1):0;let u=l?+l:s.number;if(l&&c){let e=u/100;if(o)e=e*(o=="-"?-1:1)+s.number/i.doc.lines;u=Math.round(i.doc.lines*e)}else if(l&&o){u=u*(o=="-"?-1:1)+s.number}let f=i.doc.line(Math.max(1,Math.min(i.doc.lines,u)));e.dispatch({effects:x.of(false),selection:n.EditorSelection.cursor(f.from+Math.max(0,Math.min(h,f.length))),scrollIntoView:true});e.focus()}return{dom:r}}const x=n.StateEffect.define();const y=n.StateField.define({create(){return true},update(e,t){for(let r of t.effects)if(r.is(x))e=r.value;return e},provide:e=>i.showPanel.from(e,(e=>e?v:null))});const w=e=>{let t=(0,i.getPanel)(e,v);if(!t){let r=[x.of(true)];if(e.state.field(y,false)==null)r.push(n.StateEffect.appendConfig.of([y,b]));e.dispatch({effects:r});t=(0,i.getPanel)(e,v)}if(t)t.dom.querySelector("input").focus();return true};const b=i.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}});const S={highlightWordAroundCursor:false,minSelectionLength:1,maxMatches:100,wholeWords:false};const C=n.Facet.define({combine(e){return(0,n.combineConfig)(e,S,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function k(e){let t=[P,L];if(e)t.push(C.of(e));return t}const M=i.Decoration.mark({class:"cm-selectionMatch"});const D=i.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function E(e,t,r,i){return(r==0||e(t.sliceDoc(r-1,r))!=n.CharCategory.Word)&&(i==t.doc.length||e(t.sliceDoc(i,i+1))!=n.CharCategory.Word)}function q(e,t,r,i){return e(t.sliceDoc(r,r+1))==n.CharCategory.Word&&e(t.sliceDoc(i-1,i))==n.CharCategory.Word}const L=i.ViewPlugin.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){if(e.selectionSet||e.docChanged||e.viewportChanged)this.decorations=this.getDeco(e.view)}getDeco(e){let t=e.state.facet(C);let{state:r}=e,n=r.selection;if(n.ranges.length>1)return i.Decoration.none;let s=n.main,o,l=null;if(s.empty){if(!t.highlightWordAroundCursor)return i.Decoration.none;let e=r.wordAt(s.head);if(!e)return i.Decoration.none;l=r.charCategorizer(s.head);o=r.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return i.Decoration.none;if(t.wholeWords){o=r.sliceDoc(s.from,s.to);l=r.charCategorizer(s.head);if(!(E(l,r,s.from,s.to)&&q(l,r,s.from,s.to)))return i.Decoration.none}else{o=r.sliceDoc(s.from,s.to).trim();if(!o)return i.Decoration.none}}let c=[];for(let h of e.visibleRanges){let e=new a(r.doc,o,h.from,h.to);while(!e.next().done){let{from:n,to:o}=e.value;if(!l||E(l,r,n,o)){if(s.empty&&n<=s.from&&o>=s.to)c.push(D.range(n,o));else if(n>=s.to||o<=s.from)c.push(M.range(n,o));if(c.length>t.maxMatches)return i.Decoration.none}}}return i.Decoration.set(c)}},{decorations:e=>e.decorations});const P=i.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const A=({state:e,dispatch:t})=>{let{selection:r}=e;let i=n.EditorSelection.create(r.ranges.map((t=>e.wordAt(t.head)||n.EditorSelection.cursor(t.head))),r.mainIndex);if(i.eq(r))return false;t(e.update({selection:i}));return true};function W(e,t){let{main:r,ranges:i}=e.selection;let n=e.wordAt(r.head),s=n&&n.from==r.from&&n.to==r.to;for(let o=false,l=new a(e.doc,t,i[i.length-1].to);;){l.next();if(l.done){if(o)return null;l=new a(e.doc,t,0,Math.max(0,i[i.length-1].from-1));o=true}else{if(o&&i.some((e=>e.from==l.value.from)))continue;if(s){let t=e.wordAt(l.value.from);if(!t||t.from!=l.value.from||t.to!=l.value.to)continue}return l.value}}}const F=({state:e,dispatch:t})=>{let{ranges:r}=e.selection;if(r.some((e=>e.from===e.to)))return A({state:e,dispatch:t});let s=e.sliceDoc(r[0].from,r[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=s)))return false;let o=W(e,s);if(!o)return false;t(e.update({selection:e.selection.addRange(n.EditorSelection.range(o.from,o.to),false),effects:i.EditorView.scrollIntoView(o.to)}));return true};const R=n.Facet.define({combine(e){return(0,n.combineConfig)(e,{top:false,caseSensitive:false,literal:false,wholeWord:false,createPanel:e=>new de(e)})}});function I(e){return e?[R.of(e),ye]:ye}class V{constructor(e){this.search=e.search;this.caseSensitive=!!e.caseSensitive;this.literal=!!e.literal;this.regexp=!!e.regexp;this.replace=e.replace||"";this.valid=!!this.search&&(!this.regexp||m(this.search));this.unquoted=this.unquote(this.search);this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,((e,t)=>t=="n"?"\n":t=="r"?"\r":t=="t"?"\t":"\\"))}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new B(this):new T(this)}getCursor(e,t=0,r){let i=e.doc?e:n.EditorState.create({doc:e});if(r==null)r=i.doc.length;return this.regexp?_(this,i,t,r):O(this,i,t,r)}}class z{constructor(e){this.spec=e}}function O(e,t,r,i){return new a(t.doc,e.unquoted,r,i,e.caseSensitive?undefined:e=>e.toLowerCase(),e.wholeWord?$(t.doc,t.charCategorizer(t.selection.main.head)):undefined)}function $(e,t){return(r,i,s,o)=>{if(o>r||o+s.length<i){o=Math.max(0,r-2);s=e.sliceString(o,Math.min(e.length,i+2))}return(t(N(s,r-o))!=n.CharCategory.Word||t(Q(s,r-o))!=n.CharCategory.Word)&&(t(Q(s,i-o))!=n.CharCategory.Word||t(N(s,i-o))!=n.CharCategory.Word)}}class T extends z{constructor(e){super(e)}nextMatch(e,t,r){let i=O(this.spec,e,r,e.doc.length).nextOverlapping();if(i.done)i=O(this.spec,e,0,t).nextOverlapping();return i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let r=Math.max(t,i-1e4-this.spec.unquoted.length);let n=O(this.spec,e,r,i),s=null;while(!n.nextOverlapping().done)s=n.value;if(s)return s;if(r==t)return null;i-=1e4}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=O(this.spec,e,0,e.doc.length),i=[];while(!r.next().done){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let n=O(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));while(!n.next().done)i(n.value.from,n.value.to)}}function _(e,t,r,i){return new u(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?j(t.charCategorizer(t.selection.main.head)):undefined},r,i)}function N(e,t){return e.slice((0,n.findClusterBreak)(e,t,false),t)}function Q(e,t){return e.slice(t,(0,n.findClusterBreak)(e,t))}function j(e){return(t,r,i)=>!i[0].length||(e(N(i.input,i.index))!=n.CharCategory.Word||e(Q(i.input,i.index))!=n.CharCategory.Word)&&(e(Q(i.input,i.index+i[0].length))!=n.CharCategory.Word||e(N(i.input,i.index+i[0].length))!=n.CharCategory.Word)}class B extends z{nextMatch(e,t,r){let i=_(this.spec,e,r,e.doc.length).next();if(i.done)i=_(this.spec,e,0,t).next();return i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let n=Math.max(t,r-i*1e4);let s=_(this.spec,e,n,r),o=null;while(!s.next().done)o=s.value;if(o&&(n==t||o.from>n+10))return o;if(n==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,((t,r)=>r=="$"?"$":r=="&"?e.match[0]:r!="0"&&+r<e.match.length?e.match[r]:t)))}matchAll(e,t){let r=_(this.spec,e,0,e.doc.length),i=[];while(!r.next().done){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let n=_(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));while(!n.next().done)i(n.value.from,n.value.to)}}const K=n.StateEffect.define();const G=n.StateEffect.define();const H=n.StateField.define({create(e){return new X(ce(e).create(),null)},update(e,t){for(let r of t.effects){if(r.is(K))e=new X(r.value.create(),e.panel);else if(r.is(G))e=new X(e.query,r.value?ae:null)}return e},provide:e=>i.showPanel.from(e,(e=>e.panel))});function U(e){let t=e.field(H,false);return t?t.query.spec:ce(e)}function J(e){var t;return((t=e.field(H,false))===null||t===void 0?void 0:t.panel)!=null}class X{constructor(e,t){this.query=e;this.panel=t}}const Y=i.Decoration.mark({class:"cm-searchMatch"}),Z=i.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"});const ee=i.ViewPlugin.fromClass(class{constructor(e){this.view=e;this.decorations=this.highlight(e.state.field(H))}update(e){let t=e.state.field(H);if(t!=e.startState.field(H)||e.docChanged||e.selectionSet||e.viewportChanged)this.decorations=this.highlight(t)}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return i.Decoration.none;let{view:r}=this;let s=new n.RangeSetBuilder;for(let i=0,n=r.visibleRanges,o=n.length;i<o;i++){let{from:t,to:l}=n[i];while(i<o-1&&l>n[i+1].from-2*250)l=n[++i].to;e.highlight(r.state,t,l,((e,t)=>{let i=r.state.selection.ranges.some((r=>r.from==e&&r.to==t));s.add(e,t,i?Z:Y)}))}return s.finish()}},{decorations:e=>e.decorations});function te(e){return t=>{let r=t.state.field(H,false);return r&&r.query.spec.valid?e(t,r):he(t)}}const re=te(((e,{query:t})=>{let{to:r}=e.state.selection.main;let i=t.nextMatch(e.state,r,r);if(!i)return false;e.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:true,effects:ve(e,i),userEvent:"select.search"});return true}));const ie=te(((e,{query:t})=>{let{state:r}=e,{from:i}=r.selection.main;let n=t.prevMatch(r,i,i);if(!n)return false;e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:true,effects:ve(e,n),userEvent:"select.search"});return true}));const ne=te(((e,{query:t})=>{let r=t.matchAll(e.state,1e3);if(!r||!r.length)return false;e.dispatch({selection:n.EditorSelection.create(r.map((e=>n.EditorSelection.range(e.from,e.to)))),userEvent:"select.search.matches"});return true}));const se=({state:e,dispatch:t})=>{let r=e.selection;if(r.ranges.length>1||r.main.empty)return false;let{from:i,to:s}=r.main;let o=[],l=0;for(let c=new a(e.doc,e.sliceDoc(i,s));!c.next().done;){if(o.length>1e3)return false;if(c.value.from==i)l=o.length;o.push(n.EditorSelection.range(c.value.from,c.value.to))}t(e.update({selection:n.EditorSelection.create(o,l),userEvent:"select.search.matches"}));return true};const oe=te(((e,{query:t})=>{let{state:r}=e,{from:n,to:s}=r.selection.main;if(r.readOnly)return false;let o=t.nextMatch(r,n,n);if(!o)return false;let l=[],a,c;let h=[];if(o.from==n&&o.to==s){c=r.toText(t.getReplacement(o));l.push({from:o.from,to:o.to,insert:c});o=t.nextMatch(r,o.from,o.to);h.push(i.EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))}if(o){let t=l.length==0||l[0].from>=o.to?0:o.to-o.from-c.length;a={anchor:o.from-t,head:o.to-t};h.push(ve(e,o))}e.dispatch({changes:l,selection:a,scrollIntoView:!!a,effects:h,userEvent:"input.replace"});return true}));const le=te(((e,{query:t})=>{if(e.state.readOnly)return false;let r=t.matchAll(e.state,1e9).map((e=>{let{from:r,to:i}=e;return{from:r,to:i,insert:t.getReplacement(e)}}));if(!r.length)return false;let n=e.state.phrase("replaced $ matches",r.length)+".";e.dispatch({changes:r,effects:i.EditorView.announce.of(n),userEvent:"input.replace.all"});return true}));function ae(e){return e.state.facet(R).createPanel(e)}function ce(e,t){var r,i,n,s;let o=e.selection.main;let l=o.empty||o.to>o.from+100?"":e.sliceDoc(o.from,o.to);if(t&&!l)return t;let a=e.facet(R);return new V({search:((r=t===null||t===void 0?void 0:t.literal)!==null&&r!==void 0?r:a.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=t===null||t===void 0?void 0:t.caseSensitive)!==null&&i!==void 0?i:a.caseSensitive,literal:(n=t===null||t===void 0?void 0:t.literal)!==null&&n!==void 0?n:a.literal,wholeWord:(s=t===null||t===void 0?void 0:t.wholeWord)!==null&&s!==void 0?s:a.wholeWord})}const he=e=>{let t=e.state.field(H,false);if(t&&t.panel){let r=(0,i.getPanel)(e,ae);if(!r)return false;let n=r.dom.querySelector("[main-field]");if(n&&n!=e.root.activeElement){let r=ce(e.state,t.query.spec);if(r.valid)e.dispatch({effects:K.of(r)});n.focus();n.select()}}else{e.dispatch({effects:[G.of(true),t?K.of(ce(e.state,t.query.spec)):n.StateEffect.appendConfig.of(ye)]})}return true};const ue=e=>{let t=e.state.field(H,false);if(!t||!t.panel)return false;let r=(0,i.getPanel)(e,ae);if(r&&r.dom.contains(e.root.activeElement))e.focus();e.dispatch({effects:G.of(false)});return true};const fe=[{key:"Mod-f",run:he,scope:"editor search-panel"},{key:"F3",run:re,shift:ie,scope:"editor search-panel",preventDefault:true},{key:"Mod-g",run:re,shift:ie,scope:"editor search-panel",preventDefault:true},{key:"Escape",run:ue,scope:"editor search-panel"},{key:"Mod-Shift-l",run:se},{key:"Alt-g",run:w},{key:"Mod-d",run:F,preventDefault:true}];class de{constructor(e){this.view=e;let t=this.query=e.state.field(H).query.spec;this.commit=this.commit.bind(this);this.searchField=s("input",{value:t.search,placeholder:pe(e,"Find"),"aria-label":pe(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit});this.replaceField=s("input",{value:t.replace,placeholder:pe(e,"Replace"),"aria-label":pe(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit});this.caseField=s("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit});this.reField=s("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit});this.wordField=s("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(e,t,r){return s("button",{class:"cm-button",name:e,onclick:t,type:"button"},r)}this.dom=s("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,r("next",(()=>re(e)),[pe(e,"next")]),r("prev",(()=>ie(e)),[pe(e,"previous")]),r("select",(()=>ne(e)),[pe(e,"all")]),s("label",null,[this.caseField,pe(e,"match case")]),s("label",null,[this.reField,pe(e,"regexp")]),s("label",null,[this.wordField,pe(e,"by word")]),...e.state.readOnly?[]:[s("br"),this.replaceField,r("replace",(()=>oe(e)),[pe(e,"replace")]),r("replaceAll",(()=>le(e)),[pe(e,"replace all")])],s("button",{name:"close",onclick:()=>ue(e),"aria-label":pe(e,"close"),type:"button"},["×"])])}commit(){let e=new V({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!e.eq(this.query)){this.query=e;this.view.dispatch({effects:K.of(e)})}}keydown(e){if((0,i.runScopeHandlers)(this.view,e,"search-panel")){e.preventDefault()}else if(e.keyCode==13&&e.target==this.searchField){e.preventDefault();(e.shiftKey?ie:re)(this.view)}else if(e.keyCode==13&&e.target==this.replaceField){e.preventDefault();oe(this.view)}}update(e){for(let t of e.transactions)for(let e of t.effects){if(e.is(K)&&!e.value.eq(this.query))this.setQuery(e.value)}}setQuery(e){this.query=e;this.searchField.value=e.search;this.replaceField.value=e.replace;this.caseField.checked=e.caseSensitive;this.reField.checked=e.regexp;this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(R).top}}function pe(e,t){return e.state.phrase(t)}const me=30;const ge=/[\s\.,:;?!]/;function ve(e,{from:t,to:r}){let n=e.state.doc.lineAt(t),s=e.state.doc.lineAt(r).to;let o=Math.max(n.from,t-me),l=Math.min(s,r+me);let a=e.state.sliceDoc(o,l);if(o!=n.from){for(let e=0;e<me;e++)if(!ge.test(a[e+1])&&ge.test(a[e])){a=a.slice(e);break}}if(l!=s){for(let e=a.length-1;e>a.length-me;e--)if(!ge.test(a[e-1])&&ge.test(a[e])){a=a.slice(0,e);break}}return i.EditorView.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${n.number}.`)}const xe=i.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}});const ye=[H,n.Prec.lowest(ee),xe]}}]);
//# sourceMappingURL=2800.14c52357e80a857341c2.js.map?v=14c52357e80a857341c2