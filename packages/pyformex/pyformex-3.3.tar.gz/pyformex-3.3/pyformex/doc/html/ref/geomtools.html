

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>26. geomtools — Basic geometrical operations. &#8212; pyFormex 3.3 documentation</title>

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="27. inertia — Compute inertia related quantities of geometrical models." href="inertia.html" />
    <link rel="prev" title="25. geomfile — Export/import of files in pyFormex’s native PGF format" href="geomfile.html" />
<link rel="icon" type="image/png" href="../_static/pyformex_fav.png" />

  </head><body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="../_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="../_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inertia.html" title="27. inertia — Compute inertia related quantities of geometrical models."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geomfile.html" title="25. geomfile — Export/import of files in pyFormex’s native PGF format"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">26. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">geomtools</span></code> — Basic geometrical operations.</a></li--> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_SIDEBAR_LOGO -->
<!-- PYFORMEX_WEBSITE_SIDEBAR_TOP -->

  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">26. <code class="xref py py-mod docutils literal notranslate"><span class="pre">geomtools</span></code> — Basic geometrical operations.</a><ul>
<li><a class="reference internal" href="#classes-defined-in-module-geomtools">26.1. Classes defined in module geomtools</a></li>
<li><a class="reference internal" href="#functions-defined-in-module-geomtools">26.2. Functions defined in module geomtools</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="geomfile.html"
                        title="previous chapter"><span class="section-number">25. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">geomfile</span></code> — Export/import of files in pyFormex’s native PGF format</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inertia.html"
                        title="next chapter"><span class="section-number">27. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">inertia</span></code> — Compute inertia related quantities of geometrical models.</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-geomtools">
<span id="geomtools-basic-geometrical-operations"></span><span id="sec-ref-geomtools"></span><h1><span class="section-number">26. </span><a class="reference internal" href="#module-geomtools" title="geomtools: Basic geometrical operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">geomtools</span></code></a> — Basic geometrical operations.<a class="headerlink" href="#module-geomtools" title="Permalink to this headline">¶</a></h1>
<p>This module defines some basic operations on simple geometrical entities
such as points, lines, planes, vectors, segments, triangles, circles.</p>
<p>The operations include intersection, projection, distance computing.</p>
<p>Many of the functions in this module are exported as methods on the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Coords</span></code> and the <code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code> derived classes.</p>
<p>Renamed functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intersectionPointsLWL</span>    <span class="o">-&gt;</span> <span class="n">intersectLineWithLine</span>
<span class="n">intersectionTimesLWL</span>     <span class="o">-&gt;</span> <span class="n">intersectLineWithLine</span>
<span class="n">intersectionPointsLWP</span>    <span class="o">-&gt;</span> <span class="n">intersectLineWithPlane</span>
<span class="n">intersectionTimesLWP</span>     <span class="o">-&gt;</span> <span class="n">intersectLineWithPlane</span>
<span class="n">intersectionTimesSWP</span>     <span class="o">-&gt;</span> <span class="n">intersectSegmentWithPlane</span>
<span class="n">intersectionSWP</span>          <span class="o">-&gt;</span> <span class="n">intersectSegmentWithPlane</span>
<span class="n">intersectionPointsSWP</span>    <span class="o">-&gt;</span> <span class="n">intersectSegmentWithPlane</span>

<span class="n">intersectionTimesPOP</span>     <span class="o">-&gt;</span> <span class="n">projectPointOnPlane</span>
<span class="n">intersectionPointsPOP</span>    <span class="o">-&gt;</span> <span class="n">projectPointOnPlane</span>
<span class="n">intersectionTimesPOL</span>     <span class="o">-&gt;</span> <span class="n">projectPointOnLine</span>
<span class="n">intersectionPointsPOL</span>    <span class="o">-&gt;</span> <span class="n">projectPointOnLine</span>

<span class="n">distancesPFL</span>             <span class="o">-&gt;</span> <span class="n">distanceFromLine</span>
<span class="n">distancesPFS</span>             <span class="o">-&gt;</span> <span class="n">distanceFromLine</span>
</pre></div>
</div>
<p>Planned renaming of functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lineIntersection</span>         <span class="o">-&gt;</span> <span class="n">to</span> <span class="n">be</span> <span class="n">removed</span> <span class="p">(</span><span class="ow">or</span> <span class="n">intersect2DLineWithLine</span><span class="p">)</span>
<span class="n">projectionVOV</span>            <span class="o">-&gt;</span> <span class="n">projectVectorOnVector</span>
<span class="n">projectionVOP</span>            <span class="o">-&gt;</span> <span class="n">projectVectorOnPlane</span>

<span class="n">pointsAtLines</span>            <span class="o">-&gt;</span> <span class="n">pointOnLine</span>
<span class="n">pointsAtSegments</span>         <span class="o">-&gt;</span> <span class="n">pointOnSegment</span>
<span class="n">intersectionTimesLWT</span>     <span class="o">-&gt;</span> <span class="n">intersectLineWithTriangle</span>
<span class="n">intersectionPointsLWT</span>    <span class="o">-&gt;</span> <span class="n">intersectLineWithTriangle</span>
<span class="n">intersectionTimesSWT</span>     <span class="o">-&gt;</span> <span class="n">intersectSegmentWithTriangle</span>
<span class="n">intersectionPointsSWT</span>    <span class="o">-&gt;</span> <span class="n">intersectSegmentWithTriangle</span>
<span class="n">intersectionPointsPWP</span>    <span class="o">-&gt;</span> <span class="n">intersectThreePlanes</span>
<span class="n">intersectionLinesPWP</span>     <span class="o">-&gt;</span> <span class="n">intersectTwoPlanes</span> <span class="p">(</span><span class="ow">or</span> <span class="n">intersectPlaneWithPlane</span><span class="p">)</span>
<span class="n">intersectionSphereSphere</span> <span class="o">-&gt;</span> <span class="n">intersectTwoSpheres</span> <span class="p">(</span><span class="ow">or</span> <span class="n">intersectSphereWithSphere</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="classes-defined-in-module-geomtools">
<h2><span class="section-number">26.1. </span>Classes defined in module geomtools<a class="headerlink" href="#classes-defined-in-module-geomtools" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="geomtools.Lines">
<em class="property">class </em><code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">Lines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#Lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.Lines" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of lines, half-lines(rays) or segments.</p>
<p>This class is intended as a common interface for a collection of
lines, half-lines or segments. Many functions in the geomtools
module operate on lines (or rays, or segments). Sometimes these
are specified by two points, while in other case they need to be
specified by one point and a vector.
Also the user might store his line data in one of these two ways,
and it is annoying and not effective to have to convert between
these two multiple times.</p>
<p>Then this class comes as a help. It is a lightweight class that
can store lines, rays or segments. The class itself does not
discriminate between these: the user is responsible for the
interpretation. This is further complicated by the fact that the
data structure of a vector is the same as that of a point.</p>
<p>In what follows, a line can mean any of:</p>
<ul class="simple">
<li><p>a full twosided infinite line,</p></li>
<li><p>a ray starting at some point and infinite in one direction,</p></li>
<li><p>a finite straight segment between two points.</p></li>
</ul>
<p>A Lines instance can be initialized by any of the following data:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> object with shape (nlines, 2, 3),
containing the coordinates of two points on each of the
<code class="docutils literal notranslate"><span class="pre">nlines</span></code> lines. This is the natural way to specify segments,
but it can be used for infinite lines and rays as well.</p></li>
<li><p>a tuple of two <a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> objects, each with shape
(nlines, 2, 3). The first contains a point on each of the lines,
the second is a vector along the line. The vectors do not need
to be unit length vectors. They typically will not be if this
method is used to specify segments.</p></li>
<li><p>another Lines instance. In this case a shallow copy of the Lines
is created, sharing its data with the input Lines.
This is a convenience allowing the user to pass raw data as well
as data already converted to a Lines instance in places where
line data are expected.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> | tuple | Lines) – <p>A <a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> argument should have a shape (nlines,2,3)
and defines <code class="docutils literal notranslate"><span class="pre">nlines</span></code> lines by the coordinates of two points
on each of the lines.</p>
<p>A tuple should contain two (nlines,3) shaped <a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a>
structures. The first holds a point on the lines, the second
a vector along the lines.</p>
<p>If a Lines instance is specified as data, a shallow copy sharing
the same data is created.</p>
</p>
</dd>
</dl>
<p>A Lines instance has the following attributes (onbly the first two are
actually stored):</p>
<dl class="py attribute">
<dt id="geomtools.Lines.p">
<code class="sig-name descname">p</code><a class="headerlink" href="#geomtools.Lines.p" title="Permalink to this definition">¶</a></dt>
<dd><p>The first point of the Lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array (nlines,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="geomtools.Lines.n">
<code class="sig-name descname">n</code><a class="headerlink" href="#geomtools.Lines.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector from the first to the second point.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array (nlines,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="geomtools.Lines.coords">
<code class="sig-name descname">coords</code><a class="headerlink" href="#geomtools.Lines.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coords</span></code></a> containing both points on the lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords">Coords</a> (nlines, 2, 3)</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Create Lines from two points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">([[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
<span class="go">[[2.  0.  0.]</span>
<span class="go"> [0.  1.  0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="go">[[0.  3.  0.]</span>
<span class="go"> [1.  0.  0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="o">.</span><span class="n">coords</span>
<span class="go">Coords([[[2.,  0.,  0.],</span>
<span class="go">         [2.,  3.,  0.]],</span>

<span class="go">        [[0.,  1.,  0.],</span>
<span class="go">         [1.,  1.,  0.]]])</span>
</pre></div>
</div>
<p>Create the same Lines from one point and a vector.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">(([[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">M</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">id</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Create a shallow copy.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">M</span><span class="o">.</span><span class="n">p</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">id</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt id="geomtools.Lines.toFormex">
<code class="sig-name descname">toFormex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#Lines.toFormex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.Lines.toFormex" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Lines to a 2-plex Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Formex (nlines, 2, 3)</em> – A plex-2 Formex representing the Lines.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When drawn, the Lines will always be represented as straight line
segments, even if they represent infinitely long lines.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">([[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">toFormex</span><span class="p">()</span><span class="o">.</span><span class="n">asFormex</span><span class="p">())</span>
<span class="go">{[2.0,0.0,0.0; 2.0,3.0,0.0], [0.0,1.0,0.0; 1.0,1.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions-defined-in-module-geomtools">
<h2><span class="section-number">26.2. </span>Functions defined in module geomtools<a class="headerlink" href="#functions-defined-in-module-geomtools" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="geomtools.pointsAtLines">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">pointsAtLines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#pointsAtLines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.pointsAtLines" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the points of lines (q,m) at parameter values t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>float array</em><em> (</em><em>..</em><em>, </em><em>3</em><em>)</em>) – Array with (starting) points of a collection of lines.</p></li>
<li><p><strong>m</strong> (<em>float array</em><em> (</em><em>..</em><em>, </em><em>3</em><em>)</em>) – Array with vectors along the lines, broadcast compatible with q.
The vectors do not need to have unit length.</p></li>
<li><p><strong>t</strong> (<em>float array</em>) – Array with parameter values, broadcast compatible with q[…]
and m[…].
Parametric value 0 is at point q, parametric value 1 is at q + m.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Coords</em> – A Coords array with the points at parameter values t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="geomtools.pointsAtSegments">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">pointsAtSegments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#pointsAtSegments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.pointsAtSegments" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the points of line segments S at parameter values t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<em>float array</em><em> (</em><em>..</em><em>, </em><em>2</em><em>, </em><em>3</em><em>)</em>) – A collection of line segments defined by two points.</p></li>
<li><p><strong>t</strong> (<em>float array</em>) – Array with parameter values, broadcast compatible with S[…].
Parametric value 0 is at point 0, parametric value 1 is at point 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Coords</em> – A Coords array with the points at parameter values t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectLineWithLine">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectLineWithLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q1</span></em>, <em class="sig-param"><span class="n">m1</span></em>, <em class="sig-param"><span class="n">q2</span></em>, <em class="sig-param"><span class="n">m2</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectLineWithLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectLineWithLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the common perpendicular of lines (q1,m1) and lines (q2,m2).</p>
<p>Return the intersection points of lines (q1,m1) and lines (q2,m2)
with the perpendiculars between them. For intersecting lines, the
corresponding points will coincide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q1</strong> (<em>float array</em><em> (</em><em>nq1</em><em>, </em><em>3</em><em>)</em>) – Points on the first set of lines.</p></li>
<li><p><strong>m1</strong> (<em>float array</em><em> (</em><em>nq1</em><em>, </em><em>3</em><em>)</em>) – Direction vectors of the first set of lines.</p></li>
<li><p><strong>q2</strong> (<em>float array</em><em> (</em><em>nq2</em><em>, </em><em>3</em><em>)</em>) – Points on the second set of lines.</p></li>
<li><p><strong>m2</strong> (<em>float array</em><em> (</em><em>nq2</em><em>, </em><em>3</em><em>)</em>) – Direction vectors of the second set of lines.</p></li>
<li><p><strong>mode</strong> (<em>'all' | 'pair'</em>) – If ‘all’, the intersection of all lines (q1,m1) with all lines
(q2,m2) is computed; nq1 and nq2 can be different.
If ‘pair’, nq1 and nq2 should be equal (or 1) and the
intersection of pairs of lines is computed (using broadcasting
for length 1 data).</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, return the parameter values of the intersection
points instead of the coordinates (see Notes).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ar1</strong> (<em>float array</em>) – The intersection points of the common perpendiculars with the first
set of lines. See Notes.</p></li>
<li><p><strong>ar2</strong> (<em>float array</em>) – The intersection points of the common perpendiculars with the second
set of lines. See Notes.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default (<code class="docutils literal notranslate"><span class="pre">times=False</span></code>) the returned arrays are the coordinates of
the points, with shape (nq1,nq2,3) for mode ‘all’ and (nq1,3) for
mode ‘pair’.
With <code class="docutils literal notranslate"><span class="pre">times=True</span></code> the return values are the parameter values of the
intersection points, and the size opf the arrays is (nq1,nq2) for
mode ‘all’ and (nq1,) for mode ‘pair’.</p>
<p>The coordinates of a point with parameter value t on a line (q,m)
are given by <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">+</span> <span class="pre">t</span> <span class="pre">*</span> <span class="pre">m</span></code>.</p>
<p>The intersection of two parallel lines results in NAN-values. These are
not removed from the result. The user has to do it himself if needed.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">[[[ 2.  0.  0.]</span>
<span class="go">  [ 0.  0.  0.]]</span>

<span class="go"> [[ 2.  2.  1.]</span>
<span class="go">  [ 0.  0.  1.]]</span>

<span class="go"> [[nan nan nan]</span>
<span class="go">  [ 0.  0.  3.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">[[[ 2.  0.  0.]</span>
<span class="go">  [ 0.  0.  0.]]</span>

<span class="go"> [[ 2.  2.  0.]</span>
<span class="go">  [ 0.  0.  1.]]</span>

<span class="go"> [[nan nan nan]</span>
<span class="go">  [ 0.  0.  3.]]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">[[2. 0. 0.]</span>
<span class="go"> [0. 0. 1.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">[[2. 0. 0.]</span>
<span class="go"> [0. 0. 1.]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="go">[[ 2. -0.]</span>
<span class="go"> [ 2. -0.]</span>
<span class="go"> [nan -0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">[[-0. -0.]</span>
<span class="go"> [ 2.  1.]</span>
<span class="go"> [nan  3.]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="n">intersectLineWithLine</span><span class="p">(</span><span class="n">q</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="go">[ 2. -0.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="go">[-0.  1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectLineWithPlane">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectLineWithPlane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectLineWithPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectLineWithPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the intersection of lines (q,m) and planes (p,n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>float array</em><em> (</em><em>nq</em><em>, </em><em>3</em><em>)</em>) – Points on the nq lines. A first dimension 1 will be broadcasted
to size of <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></li>
<li><p><strong>m</strong> (<em>float array</em><em> (</em><em>nq</em><em>, </em><em>3</em><em>)</em>) – Direction vectors of nq lines. A first dimension 1 will be
broadcasted to size of <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p></li>
<li><p><strong>p</strong> (<em>float array</em><em> (</em><em>np</em><em>, </em><em>3</em><em>)</em>) – Points on the np planes. A first dimension 1 will be broadcasted
to size of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
<li><p><strong>n</strong> (<em>float array</em><em> (</em><em>np</em><em>, </em><em>3</em><em>)</em>) – Direction vectors of the np planes (i.e. perpendicular on the planes).
A first dimension 1 will be broadcasted to size of <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
<li><p><strong>mode</strong> (<em>'all' | 'pair'</em>) – If ‘all’, the intersection of all lines (q,m) with all planes
(p,n) is computed; nq and np can be different.
If ‘pair’, nq and np should be equal (or 1) and the
pairwise intersection lines and planes is computed.</p></li>
<li><p><strong>times</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, return the parameter values of the intersection
points instead of the coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>ar</strong> (<em>float array</em>) – If times is False (default) returns the intersection points of the
lines and the planes. If mode==’all’ (default), the shape is
(nq,np,3), while for mode==’all’ the shape is (nq,3) (with nq==np).</p>
<p>If times is True, returns parameter values t, such that the
intersection points are given by q+t*m. The shape of the array is
(nq,np) for mode==’all’ and (nq,) for mode=’pair’.</p>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The result will contain an INF value for lines that are
parallel to the plane.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">intersectLineWithPlane</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">[[ 2.  3.]</span>
<span class="go"> [ 1.  2.]</span>
<span class="go"> [inf  0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">intersectLineWithPlane</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[[ 2.  0.  0.]</span>
<span class="go">  [ 3.  0.  0.]]</span>

<span class="go"> [[ 0.  2.  0.]</span>
<span class="go">  [ 0.  3.  0.]]</span>

<span class="go"> [[nan nan inf]</span>
<span class="go">  [ 0.  0.  3.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">intersectLineWithPlane</span><span class="p">(</span><span class="n">q</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[2. 0. 0.]</span>
<span class="go"> [0. 3. 0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectSegmentWithPlane">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectSegmentWithPlane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">returns</span><span class="o">=</span><span class="default_value">'x'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectSegmentWithPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectSegmentWithPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the intersection of line segments S with planes (p,n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>float array</em><em> (</em><em>ns</em><em>, </em><em>2</em><em>, </em><em>3</em><em>)</em>) – ns line segments each defined by two points.</p></li>
<li><p><strong>p</strong> (<em>float array</em><em> (</em><em>np</em><em>, </em><em>3</em><em>)</em>) – Points on the np planes. A first dimension 1 will be broadcasted
to size of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
<li><p><strong>n</strong> (<em>float array</em><em> (</em><em>np</em><em>, </em><em>3</em><em>)</em>) – Direction vectors of the np planes (i.e. perpendicular on the planes).
A first dimension 1 will be broadcasted to size of <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
<li><p><strong>mode</strong> (<em>'all' | 'pair'</em>) – If ‘all’, the intersection of all segments S with all planes
(p,n) is computed; ns and np can be different.
If ‘pair’, ns and np should be equal (or 1) and the
pairwise intersection lines and planes is computed.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – A tolerance in the determination whether a point is inside a
segment or not.</p></li>
<li><p><strong>returns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – <p>A string defining what is to be returned. The string can contain
the three characters ‘t’, ‘x’ and ‘i’, which will return the
following data:</p>
<ul>
<li><p>’t’: the parametric values of the intersection points along the
segments</p></li>
<li><p>’x’: the coordinates of the intersection points</p></li>
<li><p>’i’: the indices of segments and planes corresponding with the
intersection points and parameter values</p></li>
</ul>
<p>If the value contains an ‘i’, then only the actual intersection
points are returned. If no ‘i’ is included, intersection values
‘t’ and ‘x’ are returned for all combinations of segments and planes
(depending on the mode). The results will then include INF
values where a plane does not cut a segment.</p>
<p>A value <code class="docutils literal notranslate"><span class="pre">returns='t'</span></code> is equivalent with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intersectLineWithPlane</span><span class="p">(</span><span class="n">s</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t</strong> (<em>float array</em>) – The parameter values such that the intersection points are given
by <code class="docutils literal notranslate"><span class="pre">(1-t)*s[:,0]</span> <span class="pre">+</span> <span class="pre">t*s[:,1]</span></code>. The shape of the array is (ns,np)
for mode==’all’ and (ns,) for mode=’pair’. Only returned if
<code class="docutils literal notranslate"><span class="pre">returns</span></code> contains a ‘t’.</p></li>
<li><p><strong>x</strong> (<em>float array (nx,3)</em>) – The actual intersection points of the segments. Segments that are
completely at one side of the plane do not intersect.
Only returned if <code class="docutils literal notranslate"><span class="pre">returns</span></code> contains an ‘x’.</p></li>
<li><p><strong>ind</strong> (<em>int array</em>) – Index array identifying the line segments and planes that gave rise
to the intersection points x. For mode=’all’ the shape is (nx,2):
the first column contains the line segment indices, the second column
holds the plane indices. For mode=’pair’ the shape is (nx,) and the
indices are the same for line and plane.
Only returned if <code class="docutils literal notranslate"><span class="pre">returns</span></code> contains an ‘i’.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Three line segments and three planes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
</pre></div>
</div>
<p>Compute the intersection points of the three lines with the first
two planes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intersectSegmentWithPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">returns</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">Coords([[0.3, 0. , 0. ],</span>
<span class="go">        [1. , 0.5, 0. ],</span>
<span class="go">        [0.3, 0.3, 0. ],</span>
<span class="go">        [0.5, 0.5, 0. ]])</span>
</pre></div>
</div>
<p>Compute the intersection parameter values</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intersectSegmentWithPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">returns</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">array([[ 0.3,  inf],</span>
<span class="go">       [-inf,  0.5],</span>
<span class="go">       [ 0.7,  0.5]])</span>
</pre></div>
</div>
<p>Compute the intersection points and the indices:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">intersectSegmentWithPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">returns</span><span class="o">=</span><span class="s1">&#39;xi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[0.3  0.   0. ]</span>
<span class="go"> [1.   0.5  0. ]</span>
<span class="go"> [0.3  0.3  0. ]</span>
<span class="go"> [0.5  0.5  0. ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="go">[[0 0]</span>
<span class="go"> [1 1]</span>
<span class="go"> [2 0]</span>
<span class="go"> [2 1]]</span>
</pre></div>
</div>
<p>Compute the pairwise intersection for three lines and planes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">intersectSegmentWithPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">,</span> <span class="n">returns</span><span class="o">=</span><span class="s1">&#39;xi&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[0.3  0.   0. ]</span>
<span class="go"> [1.   0.5  0. ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
<p>Computer the pairwise intersection with a single plane (uses broadcasting):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">intersectSegmentWithPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">returns</span><span class="o">=</span><span class="s1">&#39;xt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[ 0.3  0.   0. ]</span>
<span class="go"> [ nan -inf  nan]</span>
<span class="go"> [ 0.3  0.3  0. ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">[ 0.3 -inf  0.7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectLineWithTriangle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectLineWithTriangle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">p1</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'line'</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectLineWithTriangle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectLineWithTriangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the intersection points with a set of lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (ntri,3,3)) – The coordinates of the three vertices of ntri triangles.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nlines,3)) – A first point for each of the lines to intersect.</p></li>
<li><p><strong>p1</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nlines,3)) – The second point defining the lines to intersect.</p></li>
<li><p><strong>method</strong> (<em>'line' | 'segment' | ' ray'</em>) – Define whether the points <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">p1</span></code> define an infinitely
long line, a finite segment p-p1 or a half infinite ray (p-&gt;p1).</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Tolerance to be used in deciding whether an intersection point on
a border edge is inside the surface or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X</strong> (<em>Coords (nipts, 3)</em>) – A fused set of intersection points</p></li>
<li><p><strong>ind</strong> (<em>int array (nipts, 3)</em>) – An array identifying the related intersection points, lines and
triangle.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>A line laying in the plane of a triangle does not generate
intersections.</p>
<p>This method is faster than the similar function
<a class="reference internal" href="#geomtools.intersectionPointsLWT" title="geomtools.intersectionPointsLWT"><code class="xref py py-func docutils literal notranslate"><span class="pre">intersectionPointsLWT()</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.formex</span> <span class="kn">import</span> <span class="n">Formex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span>
<span class="gp">... </span>            <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span>
<span class="gp">... </span>            <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]],</span>
<span class="gp">... </span>            <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>            <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">intersectLineWithTriangle</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">[[0.   0.   0. ]</span>
<span class="go"> [0.5  0.5  0. ]</span>
<span class="go"> [0.2  0.7  0. ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="go">[[0 0 0]</span>
<span class="go"> [0 0 1]</span>
<span class="go"> [1 1 0]</span>
<span class="go"> [1 1 1]</span>
<span class="go"> [2 3 1]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">intersectLineWithTriangle</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,:],</span>
<span class="gp">... </span>         <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">[[0.   0.   0. ]</span>
<span class="go"> [0.2  0.7  0. ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="go">[[0 0 0]</span>
<span class="go"> [0 0 1]</span>
<span class="go"> [1 3 1]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">intersectLineWithTriangle</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">L</span><span class="p">[:,</span><span class="mi">1</span><span class="p">,:],</span>
<span class="gp">... </span>         <span class="n">method</span><span class="o">=</span><span class="s1">&#39;segment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">[[0.  0.  0.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="go">[[0 0 0]</span>
<span class="go"> [0 0 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionTimesLWT">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionTimesLWT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionTimesLWT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionTimesLWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of lines (q,m) with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>q</cite>,`m`: (nq,3) shaped arrays of points and vectors (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single line
or a set of lines.</p></li>
<li><p><cite>F</cite>: (nF,3,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single triangle or a set of triangles.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line (q,m) with
all triangles F or <cite>pair</cite> for pairwise intersections.</p></li>
</ul>
<dl class="simple">
<dt>Returns a (nq,nF) shaped (<cite>mode=all</cite>) array of parameter values t,</dt><dd><p>such that the intersection points are given q+tm.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionPointsLWT">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionPointsLWT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">return_all</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionPointsLWT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionPointsLWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of lines (q,m) with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>q</cite>,`m`: (nq,3) shaped arrays of points and vectors, defining a single
line or a set of lines.</p></li>
<li><p><cite>F</cite>: (nF,3,3) shaped array, defining a single triangle or a set of
triangles.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection points of each line (q,m) with
all triangles F or <cite>pair</cite> for pairwise intersections.</p></li>
<li><p><cite>return_all</cite>: if True, all intersection points are returned. Default is
to return only the points that lie inside the triangles.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>If <cite>return_all==True</cite>, a (nq,nF,3) shaped (<cite>mode=all</cite>) array of
intersection points, else, a tuple of intersection points with shape (n,3)
and line and plane indices with shape (n), where n &lt;= nq*nF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionTimesSWT">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionTimesSWT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionTimesSWT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionTimesSWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of lines segments S with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>S</cite>: (nS,2,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single line segment or a set of line segments.</p></li>
<li><p><cite>F</cite>: (nF,3,3) shaped array (<cite>mode=all</cite>) or broadcast compatible array
(<cite>mode=pair</cite>), defining a single triangle or a set of triangles.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each line segment S with
all triangles F or <cite>pair</cite> for pairwise intersections.</p></li>
</ul>
<p>Returns a (nS,nF) shaped (<cite>mode=all</cite>) array of parameter values t,
such that the intersection points are given by
<cite>(1-t)*S[…,0,:] + t*S[…,1,:]</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionPointsSWT">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionPointsSWT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">return_all</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionPointsSWT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionPointsSWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of lines segments S with triangles F.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>S</cite>: (nS,2,3) shaped array, defining a single line segment or a set of
line segments.</p></li>
<li><p><cite>F</cite>: (nF,3,3) shaped array, defining a single triangle or a set of
triangles.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection points of each line segment S
with all triangles F or <cite>pair</cite> for pairwise intersections.</p></li>
<li><p><cite>return_all</cite>: if True, all intersection points are returned. Default is
to return only the points that lie on the segments and inside the
triangles.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>If <cite>return_all==True</cite>, a (nS,nF,3) shaped (<cite>mode=all</cite>) array of
intersection points, else, a tuple of intersection points with shape (n,3)
and line and plane indices with shape (n), where n &lt;= nS*nF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionPointsPWP">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionPointsPWP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p1</span></em>, <em class="sig-param"><span class="n">n1</span></em>, <em class="sig-param"><span class="n">p2</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">p3</span></em>, <em class="sig-param"><span class="n">n3</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionPointsPWP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionPointsPWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection points of planes (p1,n1), (p2,n2) and (p3,n3).</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>pi</cite>,`ni` (i=1…3): (npi,3) shaped arrays of points and normals
(<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each plane (p1,n1) with
all planes (p2,n2) and (p3,n3) or <cite>pair</cite> for pairwise intersections.</p></li>
</ul>
<p>Returns a (np1,np2,np3,3) shaped (<cite>mode=all</cite>) array of intersection points.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionLinesPWP">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionLinesPWP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p1</span></em>, <em class="sig-param"><span class="n">n1</span></em>, <em class="sig-param"><span class="n">p2</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionLinesPWP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionLinesPWP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection lines of planes (p1,n1) and (p2,n2).</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>pi</cite>,`ni` (i=1…2): (npi,3) shaped arrays of points and normals (<cite>mode=all</cite>)
or broadcast compatible arrays (<cite>mode=pair</cite>), defining a single plane
or a set of planes.</p></li>
<li><p><cite>mode</cite>: <cite>all</cite> to calculate the intersection of each plane (p1,n1) with
all planes (p2,n2) or <cite>pair</cite> for pairwise intersections.</p></li>
</ul>
<p>Returns a tuple of (np1,np2,3) shaped (<cite>mode=all</cite>) arrays of intersection
points q and vectors m, such that the intersection lines are given by
<code class="docutils literal notranslate"><span class="pre">q+t*m</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.intersectionSphereSphere">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">intersectionSphereSphere</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">d</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#intersectionSphereSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.intersectionSphereSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Intersection of two spheres (or two circles in the x,y plane).</p>
<p>Computes the intersection of two spheres with radii R, resp. r, having
their centres at distance d &lt;= R+r. The intersection is a circle with
its center on the segment connecting the two sphere centers at a distance
x from the first sphere, and having a radius y. The return value is a
tuple x,y.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectPointOnPlane">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectPointOnPlane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectPointOnPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectPointOnPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on planes (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>X</cite>: a (nx,3) shaped array of points.</p></li>
<li><p><cite>p</cite>, <cite>n</cite>: (np,3) shaped arrays of points and normals defining <cite>np</cite> planes.</p></li>
<li><p><cite>mode</cite>: ‘all’ or ‘pair:</p>
<ul>
<li><p>if ‘all’, the projection of all points on all planes is computed;
<cite>nx</cite> and <cite>np</cite> can be different.</p></li>
<li><p>if ‘pair’: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the projection
of pairs of point and plane are computed (using broadcasting for
length 1 data).</p></li>
</ul>
</li>
</ul>
<p>Returns a float array of size (nx,np,3) for mode ‘all’, or size (nx,3)
for mode ‘pair’.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnPlane</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[[2. 1. 0.]</span>
<span class="go">  [0. 1. 0.]]</span>

<span class="go"> [[2. 0. 0.]</span>
<span class="go">  [3. 1. 0.]]</span>

<span class="go"> [[2. 3. 0.]</span>
<span class="go">  [4. 1. 0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnPlane</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[[2. 1. 0.]</span>
<span class="go"> [3. 1. 0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectPointOnPlaneTimes">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectPointOnPlaneTimes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectPointOnPlaneTimes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectPointOnPlaneTimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on planes (p,n).</p>
<p>This is like <a class="reference internal" href="#geomtools.projectPointOnPlane" title="geomtools.projectPointOnPlane"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectPointOnPlane()</span></code></a> but instead of returning
the projected points, returns the parametric values t along the
lines (X,n), such that the projection points can be computed from
X+t*n.</p>
<p>Parameters: see <a class="reference internal" href="#geomtools.projectPointOnPlane" title="geomtools.projectPointOnPlane"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectPointOnPlane()</span></code></a>.</p>
<p>Returns a float array of size (nx,np) for mode ‘all’, or size (nx,)
for mode ‘pair’.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnPlaneTimes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[ 2.  0.]</span>
<span class="go"> [-1.  1.]</span>
<span class="go"> [-2. -2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnPlaneTimes</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[2. 1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectPointOnLine">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectPointOnLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectPointOnLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectPointOnLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on lines (p,n).</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>X</cite>: a (nx,3) shaped array of points.</p></li>
<li><p><cite>p</cite>, <cite>n</cite>: (np,3) shaped arrays of points and vectors defining <cite>np</cite> lines.</p></li>
<li><p><cite>mode</cite>: ‘all’ or ‘pair:</p>
<ul>
<li><p>if ‘all’, the projection of all points on all lines is computed;
<cite>nx</cite> and <cite>np</cite> can be different.</p></li>
<li><p>if ‘pair’: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the projection
of pairs of point and line are computed (using broadcasting for
length 1 data).</p></li>
</ul>
</li>
</ul>
<p>Returns a float array of size (nx,np,3) for mode ‘all’, or size (nx,3)
for mode ‘pair’.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[[2. 1. 0.]</span>
<span class="go">  [0. 1. 0.]]</span>

<span class="go"> [[2. 0. 0.]</span>
<span class="go">  [3. 1. 0.]]</span>

<span class="go"> [[2. 3. 0.]</span>
<span class="go">  [4. 1. 0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[[2. 1. 0.]</span>
<span class="go"> [3. 1. 0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectPointOnLineTimes">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectPointOnLineTimes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectPointOnLineTimes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectPointOnLineTimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of points X on lines (p,n).</p>
<p>This is like <a class="reference internal" href="#geomtools.projectPointOnLine" title="geomtools.projectPointOnLine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectPointOnLine()</span></code></a> but instead of returning
the projected points, returns the parametric values t along the
lines (X,n), such that the projection points can be computed from
p+t*n.</p>
<p>Parameters: see <a class="reference internal" href="#geomtools.projectPointOnLine" title="geomtools.projectPointOnLine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectPointOnLine()</span></code></a>.</p>
<p>Returns a float array of size (nx,np) for mode ‘all’, or size (nx,)
for mode ‘pair’.</p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnLineTimes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="go">[[1. 0.]</span>
<span class="go"> [0. 3.]</span>
<span class="go"> [3. 4.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">projectPointOnLineTimes</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[1. 3.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.distanceFromLine">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">distanceFromLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">lines</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#distanceFromLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.distanceFromLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance of points X from lines (p,n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nx,3)) – A collection of points.</p></li>
<li><p><strong>lines</strong> (<a class="reference internal" href="../glossary.html#term-line_like"><span class="xref std std-term">line_like</span></a>) – <p>One of the following definitions of the line(s):</p>
<ul>
<li><p>a tuple (p,n), where both p and n are (np,3) shaped arrays of
respectively points and vectors defining <cite>np</cite> lines;</p></li>
<li><p>an (np,2,3) shaped array containing two points of each line.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<em>'all'</em><em> or </em><em>'pair:</em>) – If ‘all’, the distance of all points to all lines is computed;
<cite>nx</cite> and <cite>np</cite> can be different.
If ‘pair’: <cite>nx</cite> and <cite>np</cite> should be equal (or 1) and the distance
of pairs of point and line are computed (using broadcasting for
length 1 data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float array</em> – A float array of size (nx,np) for mode ‘all’, or size (nx)
for mode ‘pair’, with the distances between the points and
the lines.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">(([[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="go">[[2. 0.]</span>
<span class="go"> [1. 1.]</span>
<span class="go"> [2. 2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">L</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[2. 1.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">Lines</span><span class="p">(([[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="go">[[2. 0.]</span>
<span class="go"> [1. 1.]</span>
<span class="go"> [2. 2.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">distanceFromLine</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">L</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pair&#39;</span><span class="p">))</span>
<span class="go">[2. 1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.pointNearLine">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">pointNearLine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">atol</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#pointNearLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.pointNearLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the points from X that are near to lines (p,n).</p>
<p>Finds the points from X that are closer than atol to any of the lines (p,n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (npts,3)) – An array of points.</p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nlines,3)) – An array of points which together with n define the lines.</p></li>
<li><p><strong>n</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nlines,3)) – An array of direction vectors which together with p define the lines.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>float array</em><em> (</em><em>npts</em><em>,</em><em>)</em>) – A global or pointwise tolerance to be used in determining close points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of int arrays</em> – An index array for each of the lines, holding the indices of the points
that are close to that line.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pointNearLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
<span class="go">[array([1]), array([0, 1])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pointNearLine</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[array([1]), array([0, 1])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.faceDistance">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">faceDistance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Fp</span></em>, <em class="sig-param"><span class="n">return_points</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#faceDistance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.faceDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest perpendicular distance to a set of triangles.</p>
<p>X is a (nX,3) shaped array of points.
Fp is a (nF,3,3) shaped array of triangles.</p>
<p>Note that some points may not have a normal with footpoint inside any
of the facets.</p>
<p>The return value is a tuple OKpid,OKdist,OKpoints where:</p>
<ul class="simple">
<li><p>OKpid is an array with the point numbers having a normal distance;</p></li>
<li><p>OKdist is an array with the shortest distances for these points;</p></li>
<li><p>OKpoints is an array with the closest footpoints for these points
and is only returned if return_points = True.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.edgeDistance">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">edgeDistance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Ep</span></em>, <em class="sig-param"><span class="n">return_points</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#edgeDistance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.edgeDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest perpendicular distance of points X to a set of edges.</p>
<p>X is a (nX,3) shaped array of points.
Ep is a (nE,2,3) shaped array of edge vertices.</p>
<p>Note that some points may not have a normal with footpoint inside any
of the edges.</p>
<p>The return value is a tuple OKpid,OKdist,OKpoints where:</p>
<ul class="simple">
<li><p>OKpid is an array with the point numbers having a normal distance;</p></li>
<li><p>OKdist is an array with the shortest distances for these points;</p></li>
<li><p>OKpoints is an array with the closest footpoints for these points
and is only returned if return_points = True.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.vertexDistance">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">vertexDistance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Vp</span></em>, <em class="sig-param"><span class="n">return_points</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#vertexDistance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.vertexDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the closest distance of points X to a set of vertices.</p>
<p>X is a (nX,3) shaped array of points.
Vp is a (nV,3) shaped array of vertices.</p>
<p>The return value is a tuple OKdist,OKpoints where:</p>
<ul class="simple">
<li><p>OKdist is an array with the shortest distances for the points;</p></li>
<li><p>OKpoints is an array with the closest vertices for the points
and is only returned if return_points = True.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.areaNormals">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">areaNormals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#areaNormals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.areaNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the area and normal vectors of a collection of triangles.</p>
<p>x is an (ntri,3,3) array with the coordinates of the vertices of ntri
triangles.</p>
<p>Returns a tuple (areas,normals) with the areas and the normals of the
triangles. The area is always positive. The normal vectors are normalized.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.degenerate">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">degenerate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">area</span></em>, <em class="sig-param"><span class="n">normals</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#degenerate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.degenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the degenerate faces according to area and normals.</p>
<p>area,normals are equal sized arrays with the areas and normals of a
list of faces, such as the output of the <a class="reference internal" href="#geomtools.areaNormals" title="geomtools.areaNormals"><code class="xref py py-func docutils literal notranslate"><span class="pre">areaNormals()</span></code></a> function.</p>
<p>A face is degenerate if its area is less or equal than zero or the
normal has a nan (not-a-number) value.</p>
<p>Returns a list of the degenerate element numbers as a sorted array.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.hexVolume">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">hexVolume</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#hexVolume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.hexVolume" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the volume of hexahedrons.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>x</cite>: float array (nelems,8,3)</p></li>
</ul>
<p>Returns a float array (nelems) withe the approximate volume of the
hexahedrons formed by each 8-tuple of vertices. The volume is obained
by dividing the hexahedron in 24 tetrahedrons and using the formulas
from <a class="reference external" href="http://www.osti.gov/scitech/servlets/purl/632793">http://www.osti.gov/scitech/servlets/purl/632793</a></p>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.elements</span> <span class="kn">import</span> <span class="n">Hex8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="n">Hex8</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">hexVolume</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="go">[1.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.levelVolumes">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">levelVolumes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#levelVolumes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.levelVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the level volumes of a collection of elements.</p>
<p>x is an (nelems,nplex,3) array with the coordinates of the nplex vertices
of nelems elements, with nplex equal to 2, 3 or 4.</p>
<p>If nplex == 2, returns the lengths of the straight line segments.
If nplex == 3, returns the areas of the triangle elements.
If nplex == 4, returns the signed volumes of the tetrahedron elements.
Positive values result if vertex 3 is at the positive side of the plane
defined by the vertices (0,1,2). Negative volumes are reported for
tetrahedra having reversed vertex order.</p>
<p>For any other value of nplex, raises an error.
If successful, returns an (nelems,) shaped float array.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.inertialDirections">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">inertialDirections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#inertialDirections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.inertialDirections" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the directions and dimension of a Coords based of inertia.</p>
<ul class="simple">
<li><p><cite>x</cite>: a Coords-like array</p></li>
</ul>
<p>Returns a tuple of the principal direction vectors and the sizes along
these directions, ordered from the smallest to the largest direction.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.smallestDirection">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">smallestDirection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'inertia'</span></em>, <em class="sig-param"><span class="n">return_size</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#smallestDirection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.smallestDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direction of the smallest dimension of a Coords.</p>
<ul class="simple">
<li><p><cite>x</cite>: a Coords-like array</p></li>
<li><p><cite>method</cite>: one of ‘inertia’ or ‘random’</p></li>
<li><p>return_size: if True and <cite>method</cite> is ‘inertia’, a tuple of a direction
vector and the size  along that direction and the cross directions;
else, only return the direction vector.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.largestDirection">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">largestDirection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">return_size</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#largestDirection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.largestDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direction of the largest dimension of a Coords.</p>
<ul class="simple">
<li><p><cite>x</cite>: a Coords-like array</p></li>
<li><p>return_size: if True and <cite>method</cite> is ‘inertia’, a tuple of a direction
vector and the size  along that direction and the cross directions;
else, only return the direction vector.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.distance">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance of all points of X to those of Y.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>X</cite>: (nX,3) shaped array of points.</p></li>
<li><p><cite>Y</cite>: (nY,3) shaped array of points.</p></li>
</ul>
<p>Returns an (nX,nT) shaped array with the distances between all points of
X and Y.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.closest">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">closest</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_dist</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#closest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.closest" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the point of Y closest to each of the points of X.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>X</cite>: (nX,3) shaped array of points</p></li>
<li><p><cite>Y</cite>: (nY,3) shaped array of points. If None, Y is taken equal to X,
allowing to search for the closest point in a single set. In the latter
case, the point itself is excluded from the search (as otherwise
that would obviously be the closest one).</p></li>
<li><p><cite>return_dist</cite>: bool. If True, also returns the distances of the closest
points.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p><cite>ind</cite>: (nX,) int array with the index of the closest point in Y to the
points of X</p></li>
<li><p><cite>dist</cite>: (nX,) float array with the distance of the closest point. This
is equal to length(X-Y[ind]). It is only returned if return_dist is True.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="geomtools.closestPair">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">closestPair</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">Y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#closestPair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.closestPair" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest pair of points from X and Y.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>X</cite>: (nX,3) shaped array of points</p></li>
<li><p><cite>Y</cite>: (nY,3) shaped array of points</p></li>
</ul>
<p>Returns a tuple (i,j,d) where i,j are the indices in X,Y identifying
the closest points, and d is the distance between them.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectedArea">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectedArea</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dir</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectedArea"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectedArea" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute projected area inside a polygon.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><cite>x</cite>: (npoints,3) Coords with the ordered vertices of a
(possibly nonplanar) polygonal contour.</p></li>
<li><p><cite>dir</cite>: either a global axis number (0, 1 or 2) or a direction vector
consisting of 3 floats, specifying the projection direction.</p></li>
</ul>
<p>Returns a single float value with the area inside the polygon projected
in the specified direction.</p>
<p>Note that if the polygon is planar and the specified direction is that
of the normal on its plane, the returned area is that of the planar
figure inside the polygon. If the polygon is nonplanar however, the area
inside the polygon is not defined. The projected area in a specified
direction is, since the projected polygon is a planar one.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.polygonVectorPairs">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">polygonVectorPairs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#polygonVectorPairs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.polygonVectorPairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute vector pairs of the edges at each vertex of the polygons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nel,nplex,3)) – Array with the coordinates of the vertices of nel polygons, each having
nplex vertices.The polygons may be nonplanar.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vec1</strong> (<em>float array (nel, nplex, 3)</em>) – The vectors from each vertex to the previous vertex in the polygon.</p></li>
<li><p><strong>vec2</strong> (<em>float array (nel, nplex, 3)</em>) – The vectors from each vertex to the next vertex in the polygon.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.formex</span> <span class="kn">import</span> <span class="n">Formex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:164&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span> <span class="o">=</span> <span class="n">polygonVectorPairs</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="go">[[[ 1.  0.  0.]</span>
<span class="go">  [-1.  1.  0.]</span>
<span class="go">  [ 0. -1.  0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">[[[-1.  1.  0.]</span>
<span class="go">  [ 0. -1.  0.]</span>
<span class="go">  [ 1.  0.  0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span> <span class="o">=</span> <span class="n">polygonVectorPairs</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="go">[[[-1.  0.  0.]</span>
<span class="go">  [ 1.  0.  0.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">[[[ 1.  0.  0.]</span>
<span class="go">  [-1.  0.  0.]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.polygonNormals">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">polygonNormals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">return_angles</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#polygonNormals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.polygonNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute normals in all points of polygons in x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nel,nplex,3)) – Array with the coordinates of the vertices of nel polygons, each having
nplex vertices.The polygons may be nonplanar.</p></li>
<li><p><strong>return_angles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If True, also returns the angle at all vetices of the polygons.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>normals</strong> (<em>float array (nel,nplex,3)</em>) – The unit normals on the two edges ending at each vertex.</p></li>
<li><p><strong>angles</strong> (<em>float array (nel, nplex)</em>) – Only returned if return_angles=True: the angles made by the
two polygon edges at each vertex.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.polygonAvgNormals" title="geomtools.polygonAvgNormals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">polygonAvgNormals</span></code></a></dt><dd><p>compute averaged normals at the nodes</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.formex</span> <span class="kn">import</span> <span class="n">Formex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:164&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">polygonNormals</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">return_angles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">[[[ 0. -0.  1.]</span>
<span class="go">  [ 0.  0.  1.]</span>
<span class="go">  [-0.  0.  1.]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[[45. 45. 90.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.polygonAvgNormals">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">polygonAvgNormals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">elems</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">'angle'</span></em>, <em class="sig-param"><span class="n">atnodes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">treshold</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#polygonAvgNormals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.polygonAvgNormals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute averaged normals at the nodes of a polygon Mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (ncoords, 3)) – Array with the coordinates of the nodes</p></li>
<li><p><strong>elems</strong> (int <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nelems, nplex, 3)) – Definitions of the polygons in terms of the nodes. All polygons
should have the same plexitude.</p></li>
<li><p><strong>weights</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> | ‘angle’ | None) – Weights to apply to the polygon normals at a node during averaging.
The default ‘angle’ will weigh the contribution of the polygons
by the angle their edges make at the node. Custom values should be
an array with shape (nelems, nplex). Specifying None will result
in giving the same weight to all normals.</p></li>
<li><p><strong>atnodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If True (default), unique averaged normals at the nodes are returned.
If False, the averaged normals are returned for each node of each
polygon. This is mainly intended for rendering purposes.</p></li>
<li><p><strong>treshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – Only used with <code class="docutils literal notranslate"><span class="pre">atnodes=False</span></code>. If provided, element vertex normals
making an angle with the averaged normal having a cosinus smaller than
treshold, will be returned as the original normal. This allows for
rendering feature edges.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>normals</strong> (<em>float array</em>) – (ncoords, 3)
The unit normals at the nodes, obtained by (weighted) averaging
the normals on the polygons attached to that node. The default
<code class="docutils literal notranslate"><span class="pre">atnodes=True</span></code> returns an array with shape (ncoords, 3). With
<code class="docutils literal notranslate"><span class="pre">atnodes=False</span></code>, an array with shape (nelems, nplex, 3) is
returned.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This example is the surface of a unit cube. The square faces are divided
into triangles by a single diagonal. Notice that the average normals
come out nicely symmetric, despite the triangle layout not being
symmetric: only node 0 and 6 have diagonals in all three planes.
This is thanks to the use of weights equal to the angle between the
facet edges.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.simple</span> <span class="kn">import</span> <span class="n">Cube</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">()</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;tri3-u&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">polygonAvgNormals</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">elems</span><span class="p">))</span>
<span class="go">[[-0.5774 -0.5774 -0.5774]</span>
<span class="go"> [ 0.5774 -0.5774 -0.5774]</span>
<span class="go"> [ 0.5774  0.5774 -0.5774]</span>
<span class="go"> [-0.5774  0.5774 -0.5774]</span>
<span class="go"> [-0.5774 -0.5774  0.5774]</span>
<span class="go"> [ 0.5774 -0.5774  0.5774]</span>
<span class="go"> [ 0.5774  0.5774  0.5774]</span>
<span class="go"> [-0.5774  0.5774  0.5774]]</span>
</pre></div>
</div>
<p>If we do not use any weights and simply average the normals on all
facets at the node, the results are not so symmetric:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">polygonAvgNormals</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">elems</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
<span class="go">[[-0.5774 -0.5774 -0.5774]</span>
<span class="go"> [ 0.8165 -0.4082 -0.4082]</span>
<span class="go"> [ 0.4082  0.4082 -0.8165]</span>
<span class="go"> [-0.4082  0.8165 -0.4082]</span>
<span class="go"> [-0.4082 -0.4082  0.8165]</span>
<span class="go"> [ 0.4082 -0.8165  0.4082]</span>
<span class="go"> [ 0.5774  0.5774  0.5774]</span>
<span class="go"> [-0.8165  0.4082  0.4082]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.split_polygon">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">split_polygon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">faces</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#split_polygon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.split_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Split polygons into two simpler ones.</p>
<p>All input polygons should have the same plexitude. They are split
along the shortest diagonal giving a maximal plexitude difference
of 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords"><em>Coords</em></a>) – The vertices of the polygons.</p></li>
<li><p><strong>faces</strong> (<a class="reference internal" href="connectivity.html#connectivity.Connectivity" title="connectivity.Connectivity"><em>Connectivity</em></a>) – Connectivity of the faces.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of Connectivity</em> – Two Connectivity table with the two halves of the input
polygons. If the input plexitude (nplex) is even, both
have the same plexitude (nplex+2)/2; if nplex is uneven,
the first will have a plexitude that is one higher than
the second: (nplex+3)/2 and (nplex+1)/2.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.splitPolygon" title="geomtools.splitPolygon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">splitPolygon</span></code></a></dt><dd><p>splits sets of polygons with different plexitude</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.splitPolygon">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">splitPolygon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">faces</span></em>, <em class="sig-param"><span class="n">mplex</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#splitPolygon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.splitPolygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Split sets of polygons into simpler ones with a maximum plexitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords"><em>Coords</em></a>) – The vertices of the polygons.</p></li>
<li><p><strong>faces</strong> (<em>dict | Connectivity</em>) – <p>A dictionary where the keys are the plexitudes of the polygons
and the values are Connectivity tables defining all the polygons
of that plexitude.</p>
<p>A single Connectivity table may be specified instead of a dict.</p>
</p></li>
<li><p><strong>mplex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The maximal plexitude of the output polygons. This should be
at least 3 and smaller than the largest key in faces, or there
is nothing to be split. A value of 4 will produce quads and
triangles. A value 3 will produce only triangles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>dict</em> – The result is a dictionary like the input, but where all polygons
with plexitude larger than mplex have been split into smaller ones.
For example, with mplex=4, all 5-plex polygons are split into a
quad and a triangle and 6-plex polygons into two quads.
With mplex=3, 5-plex polygons would be split into three triangles
and 6-plex polygons into four triangles.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.split_polygon" title="geomtools.split_polygon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_polygon</span></code></a></dt><dd><p>split single plexitude polygons in two</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.triangleInCircle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">triangleInCircle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#triangleInCircle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.triangleInCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the incircles of the triangles x.</p>
<p>The incircle of a triangle is the largest circle that can be inscribed
in the triangle.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
incircles.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyformex.formex</span> <span class="kn">import</span> <span class="n">Formex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="n">Coords</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]))</span><span class="o">.</span><span class="n">rosette</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">120.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">asFormex</span><span class="p">())</span>
<span class="go">{[1.0,0.0,0.0], [-0.5,0.8660254,0.0], [-0.5,-0.8660254,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">normal</span> <span class="o">=</span> <span class="n">triangleInCircle</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
<span class="go">[0.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
<span class="go">[[0. 0. 0.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.triangleCircumCircle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">triangleCircumCircle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">bounding</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#triangleCircumCircle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.triangleCircumCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the circumcircles of the triangles x.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
circles going through the vertices of each triangle.</p>
<p>If bounding=True, this returns the triangle bounding circle.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.triangleBoundingCircle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">triangleBoundingCircle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#triangleBoundingCircle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.triangleBoundingCircle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the bounding circles of the triangles x.</p>
<p>The bounding circle is the smallest circle in the plane of the triangle
such that all vertices of the triangle are on or inside the circle.
If the triangle is acute, this is equivalent to the triangle’s
circumcircle. It the triangle is obtuse, the longest edge is the
diameter of the bounding circle.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns a tuple r,C,n with the radii, Center and unit normals of the
bounding circles.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.triangleObtuse">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">triangleObtuse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#triangleObtuse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.triangleObtuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for obtuse triangles.</p>
<p>x is a Coords array with shape (ntri,3,3) representing ntri triangles.</p>
<p>Returns an (ntri) array of True/False values indicating whether the
triangles are obtuse.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.lineIntersection">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">lineIntersection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P0</span></em>, <em class="sig-param"><span class="n">N0</span></em>, <em class="sig-param"><span class="n">P1</span></em>, <em class="sig-param"><span class="n">N1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#lineIntersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.lineIntersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the intersection of 2 (sets of) lines.</p>
<p>This relies on the lines being pairwise coplanar.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.displaceLines">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">displaceLines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">C</span></em>, <em class="sig-param"><span class="n">d</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#displaceLines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.displaceLines" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all lines (A,N) over a distance a in the direction of point C.</p>
<p>A,N are arrays with points and directions defining the lines.
C is a point.
d is a scalar or a list of scalars.
All line elements of F are translated in the plane (line,C)
over a distance d in the direction of the point C.
Returns a new set of lines (A,N).</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.segmentOrientation">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">segmentOrientation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vertices</span></em>, <em class="sig-param"><span class="n">vertices2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">point</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#segmentOrientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.segmentOrientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the orientation of a set of line segments.</p>
<p>vertices and vertices2 are matching sets of points.
point is a single point.
All arguments are Coords objects.</p>
<p>Line segments run between corresponding points of vertices and vertices2.
If vertices2 is None, it is obtained by rolling the vertices one position
foreward, thus corresponding to a closed polygon through the vertices).
If point is None, it is taken as the center of vertices.</p>
<p>The orientation algorithm checks whether the line segments turn
positively around the point.</p>
<p>Returns an array with +1/-1 for positive/negative oriented segments.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.rotationAngle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">rotationAngle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">m</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">angle_spec</span><span class="o">=</span><span class="default_value">0.017453292519943295</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#rotationAngle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.rotationAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return rotation angles and vectors for rotations of A to B.</p>
<p>A and B are (n,3) shaped arrays where each row represents a vector.
This function computes the rotation from each vector of A to the
corresponding vector of B.
If m is None, the return value is a tuple of an (n,) shaped array with
rotation angles (by default in degrees) and an (n,3) shaped array with
unit vectors along the rotation axis.
If m is a (n,3) shaped array with vectors along the rotation axis, the
return value is a (n,) shaped array with rotation angles. The returned
angle is then the angle between the planes formed by the axis and the
vectors.
Specify angle_spec=RAD to get the angles in radians.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.anyPerpendicularVector">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">anyPerpendicularVector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#anyPerpendicularVector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.anyPerpendicularVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return arbitrary vectors perpendicular to vectors of A.</p>
<p>A is a (n,3) shaped array of vectors.
The return value is a (n,3) shaped array of perpendicular vectors.</p>
<p>The returned vector is always a vector in the x,y plane. If the original
is the z-axis, the result is the x-axis.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.perpendicularVector">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">perpendicularVector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">B</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#perpendicularVector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.perpendicularVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vectors perpendicular on both A and B.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectionVOV">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectionVOV</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">B</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectionVOV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectionVOV" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of vector of A on vector of B.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.projectionVOP">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">projectionVOP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#projectionVOP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.projectionVOP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the projection of vector of A on a plane with normal n.</p>
</dd></dl>

<dl class="py function">
<dt id="geomtools.baryCoords">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">baryCoords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">P</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#baryCoords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.baryCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the barycentric coordinates of points wrt. simplexes.</p>
<p>An n-simplex is a geometrical structure defined by n+1 vertices and
bordered by the convex hull of those vertices. In practice it is
either:</p>
<ul class="simple">
<li><p>1-simplex: line segment (nplex=2)</p></li>
<li><p>2-simplex: triangle (nplex=3)</p></li>
<li><p>3-simplex: tetrahedron (nplex=4)</p></li>
</ul>
<p>The barycentric coordinates of a 3d point with respect to a simplex
of a lower order are the barycentric coordinates of the projection
of that point on the simplex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, nplex, 3)) – A set of nel n-simplexes (n=nplex-1).</p></li>
<li><p><strong>P</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, npts, 3) or (1, npts, 3)) – A set of npts points (for each of the simplexes in S) for which
the barycentric coordinates are to be computed. If the shape is
(1,npts,3), the same points are used with each of the simplexes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float array (nel, npts, nplex)</em> – The barycentric coordinates of the points with respect to the
simplexes.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.insideSimplex" title="geomtools.insideSimplex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insideSimplex</span></code></a></dt><dd><p>test if a (projection) point falls within a simplex</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;.1.6.4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baryCoords</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[[1. ,  0. ],</span>
<span class="go">        [0.8,  0.2],</span>
<span class="go">        [0.5,  0.5],</span>
<span class="go">        [0.5,  0.5]],</span>

<span class="go">       [[0.5,  0.5],</span>
<span class="go">        [0.5,  0.5],</span>
<span class="go">        [0.5,  0.5],</span>
<span class="go">        [0.4,  0.6]],</span>

<span class="go">       [[0. ,  1. ],</span>
<span class="go">        [0.2,  0.8],</span>
<span class="go">        [0.5,  0.5],</span>
<span class="go">        [0.7,  0.3]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S1</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;016&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baryCoords</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[[ 1. ,  0. ,  0. ],</span>
<span class="go">        [ 0.6,  0.2,  0.2],</span>
<span class="go">        [ 0. ,  0.5,  0.5],</span>
<span class="go">        [-0.2,  0.5,  0.7]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.insideSimplex">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">insideSimplex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#insideSimplex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.insideSimplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Check which points P are inside the simplexes S.</p>
<p>An n-simplex is a geometrical structure defined by n+1 vertices and
bordered by the convex hull of those vertices. In practice it is
either:</p>
<ul class="simple">
<li><p>1-simplex: line segment (nplex=2)</p></li>
<li><p>2-simplex: triangle (nplex=3)</p></li>
<li><p>3-simplex: tetrahedron (nplex=4)</p></li>
</ul>
<p>A 3d point is ‘inside’ a simplex of a lower order if its projection
on that simplex falls within the simplex. This is satisfied iff
all the barycentric coordinates of the point with respect to the
simplex are in the range [0.0, 1.0].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, nplex, 3)) – A set of nel n-simplexes (n=nplex-1).</p></li>
<li><p><strong>P</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, npts, 3) or (1, npts, 3)) – A set of npts points that have to be tested against the nel
simplexes. If the shape is (1,npts,3), the same points are
tested against each of the simplexes. With a shape (nel, npts, 3)
each simplex has its own set of points to be tested.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – If provided, points which are falling outside the simplex within
this tolerance (in parametric space), are also reported as inside.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>bool array (nel, npts)</em> – The array holds True where the (projection of the) points fall
inside the simplex, to the accuracy atol.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.baryCoords" title="geomtools.baryCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">baryCoords</span></code></a></dt><dd><p>compute the barycentric coordiantes of the points</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;.1.6.4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideSimplex</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[ True,  True,  True,  True],</span>
<span class="go">       [ True,  True,  True,  True],</span>
<span class="go">       [ True,  True,  True, False]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;132.14&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideSimplex</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[ True,  True, False, False],</span>
<span class="go">       [False,  True,  True, False]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.insideTriangle">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">insideTriangle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span></em>, <em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#geomtools.insideTriangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Check which points P are inside the simplexes S.</p>
<p>An n-simplex is a geometrical structure defined by n+1 vertices and
bordered by the convex hull of those vertices. In practice it is
either:</p>
<ul class="simple">
<li><p>1-simplex: line segment (nplex=2)</p></li>
<li><p>2-simplex: triangle (nplex=3)</p></li>
<li><p>3-simplex: tetrahedron (nplex=4)</p></li>
</ul>
<p>A 3d point is ‘inside’ a simplex of a lower order if its projection
on that simplex falls within the simplex. This is satisfied iff
all the barycentric coordinates of the point with respect to the
simplex are in the range [0.0, 1.0].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, nplex, 3)) – A set of nel n-simplexes (n=nplex-1).</p></li>
<li><p><strong>P</strong> (<a class="reference internal" href="../glossary.html#term-coords_like"><span class="xref std std-term">coords_like</span></a> (nel, npts, 3) or (1, npts, 3)) – A set of npts points that have to be tested against the nel
simplexes. If the shape is (1,npts,3), the same points are
tested against each of the simplexes. With a shape (nel, npts, 3)
each simplex has its own set of points to be tested.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – If provided, points which are falling outside the simplex within
this tolerance (in parametric space), are also reported as inside.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>bool array (nel, npts)</em> – The array holds True where the (projection of the) points fall
inside the simplex, to the accuracy atol.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.baryCoords" title="geomtools.baryCoords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">baryCoords</span></code></a></dt><dd><p>compute the barycentric coordiantes of the points</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;.1.6.4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideSimplex</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[ True,  True,  True,  True],</span>
<span class="go">       [ True,  True,  True,  True],</span>
<span class="go">       [ True,  True,  True, False]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="s1">&#39;132.14&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideSimplex</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">array([[ True,  True, False, False],</span>
<span class="go">       [False,  True,  True, False]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.insideSegment">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">insideSegment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Q</span></em>, <em class="sig-param"><span class="n">Q1</span></em>, <em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#insideSegment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.insideSegment" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if projections of points are inside line segments.</p>
<p>Checks which projections of points P on the line segments Q-Q1
are within the line segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nseg, 3)) – First point of <code class="docutils literal notranslate"><span class="pre">nseg</span></code> line segments.</p></li>
<li><p><strong>Q1</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nseg, 3)) – Second point of <code class="docutils literal notranslate"><span class="pre">nseg</span></code> line segments.</p></li>
<li><p><strong>P</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nseg, 3)) – The points to test against the segments. The testing is done
by pair: one point for each segment. The test pertains to the
projection of the point on the line containing the segment.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – If provided, points which are falling outside the segment but within
this tolerance are also reported as inside.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>bool array (nseg)</em> – The array holds True where the (projection of the) point falls
inside the corresponding segemnt, within the accuracy <code class="docutils literal notranslate"><span class="pre">atol</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>On large data sets this is (slightly) more efficient than the
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">Q</span><span class="p">,</span> <span class="n">Q1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">geomtools</span><span class="o">.</span><span class="n">insideSimplex</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.insideSimplex" title="geomtools.insideSimplex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insideSimplex</span></code></a></dt><dd><p>a general test of (projection of) points inside simplexes</p>
</dd>
<dt><a class="reference internal" href="#geomtools.insideRay" title="geomtools.insideRay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insideRay</span></code></a></dt><dd><p>a similar test for points on a half-line (ray)</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nseg</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nseg</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">uniformParamValues</span><span class="p">(</span><span class="n">nseg</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">Q1</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nseg</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideSegment</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">Q1</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.e-5</span><span class="p">)</span>
<span class="go">array([False,  True,  True,  True,  True,  True,  True,  True,  True,</span>
<span class="go">        True,  True,  True, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">insideRay</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">Q1</span><span class="o">-</span><span class="n">Q</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1.e-5</span><span class="p">)</span>
<span class="go">array([False,  True,  True,  True,  True,  True,  True,  True,  True,</span>
<span class="go">        True,  True,  True,  True])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="geomtools.insideRay">
<code class="sig-prename descclassname">geomtools.</code><code class="sig-name descname">insideRay</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Q</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geomtools.html#insideRay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#geomtools.insideRay" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if projections of points are inside rays (half-lines).</p>
<p>Checks which projections of points P on the line (Q,v)
are within the positive half-lines (rays).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Q</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nlines, 3)) – Starting point of <code class="docutils literal notranslate"><span class="pre">nlines</span></code> rays (half-lines).</p></li>
<li><p><strong>v</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nlines, 3)) – Direction vectors of <code class="docutils literal notranslate"><span class="pre">nlines</span></code> rays (half-lines).</p></li>
<li><p><strong>P</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nlines, 3)) – The points to test against the rays. The testing is done
by pair: one point for each segment. The test pertains to the
projection of the point on the line containing the ray.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – If provided, points which are falling outside the ray but within
this tolerance are also reported as inside.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>bool array (nseg)</em> – The array holds True where the (projection of the) point falls
inside the corresponding ray, within the accuracy <code class="docutils literal notranslate"><span class="pre">atol</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>On large data sets this is (slightly) more efficient than the
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">Q</span><span class="p">,</span> <span class="n">Q</span><span class="o">+</span><span class="n">v</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">geomtools</span><span class="o">.</span><span class="n">baryCoords</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">B</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">atol</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#geomtools.insideSimplex" title="geomtools.insideSimplex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insideSimplex</span></code></a></dt><dd><p>a general test of (projection of) points inside simplexes</p>
</dd>
<dt><a class="reference internal" href="#geomtools.insideRay" title="geomtools.insideRay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insideRay</span></code></a></dt><dd><p>a similar test for points on a half-line (ray)</p>
</dd>
</dl>
</div>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inertia.html" title="27. inertia — Compute inertia related quantities of geometrical models."
             >next</a> |</li>
        <li class="right" >
          <a href="geomfile.html" title="25. geomfile — Export/import of files in pyFormex’s native PGF format"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" >pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">26. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">geomtools</span></code> — Basic geometrical operations.</a></li--> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2023, Benedict Verhegghe.
    </span>
      Last updated on Mar 27, 2023.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.3.
    </span>
    </div>
  </body>
</html>