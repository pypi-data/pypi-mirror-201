

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>111. lib.misc_c — Miscellaneous accelerated low level functions. &#8212; pyFormex 3.3 documentation</title>

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="112. lib.misc_e — Python equivalents of the functions in lib.misc_c" href="lib.misc_e.html" />
    <link rel="prev" title="110. opengl.texture — Texture rendering." href="opengl.texture.html" />
<link rel="icon" type="image/png" href="../_static/pyformex_fav.png" />

  </head><body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="../_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="../_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lib.misc_e.html" title="112. lib.misc_e — Python equivalents of the functions in lib.misc_c"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="opengl.texture.html" title="110. opengl.texture — Texture rendering."
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">111. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_c</span></code> — Miscellaneous accelerated low level functions.</a></li--> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_SIDEBAR_LOGO -->
<!-- PYFORMEX_WEBSITE_SIDEBAR_TOP -->

  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">111. <code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_c</span></code> — Miscellaneous accelerated low level functions.</a><ul>
<li><a class="reference internal" href="#functions-defined-in-module-lib-misc-c">111.1. Functions defined in module lib.misc_c</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="opengl.texture.html"
                        title="previous chapter"><span class="section-number">110. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">opengl.texture</span></code> — Texture rendering.</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lib.misc_e.html"
                        title="next chapter"><span class="section-number">112. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_e</span></code> — Python equivalents of the functions in <code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_c</span></code></a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-lib.misc_c">
<span id="lib-misc-c-miscellaneous-accelerated-low-level-functions"></span><span id="sec-ref-lib-misc-c"></span><h1><span class="section-number">111. </span><a class="reference internal" href="#module-lib.misc_c" title="lib.misc_c: Miscellaneous accelerated low level functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_c</span></code></a> — Miscellaneous accelerated low level functions.<a class="headerlink" href="#module-lib.misc_c" title="Permalink to this headline">¶</a></h1>
<p>This module contains miscellaneous compiled C-versions of some
time-critical low level functions in pyFormex.
These functions are not intended for the end user. They are called
internally by other pyFormex functions to speed up their operation.</p>
<div class="section" id="functions-defined-in-module-lib-misc-c">
<h2><span class="section-number">111.1. </span>Functions defined in module lib.misc_c<a class="headerlink" href="#functions-defined-in-module-lib-misc-c" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="lib.misc_c.coordsfuse">
<code class="sig-prename descclassname">lib.misc_c.</code><code class="sig-name descname">coordsfuse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">flag</span></em>, <em class="sig-param"><span class="n">sel</span></em>, <em class="sig-param"><span class="n">tol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.misc_c.coordsfuse" title="Permalink to this definition">¶</a></dt>
<dd><p>Fuse points whose coordinates are (almost) the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float32 array</em><em> (</em><em>npts</em><em>, </em><em>3</em><em>)</em>) – The coordinates of npts points.</p></li>
<li><p><strong>val</strong> (<em>int32 array</em><em> (</em><em>npts</em><em>)</em>) – An integer code for each point, such that points with the same code
are in the same neighborhood. Any point will only be compared with
the other points in its neighborhood. The points in x and the values in
val should be sorted according to increasing value.</p></li>
<li><p><strong>flag</strong> (<em>int32 array</em><em> (</em><em>npts</em><em>)</em>) – A value 1 if the point is not fused and 0 if it is already fused.</p></li>
<li><p><strong>sel</strong> (<em>int32 array</em><em> (</em><em>npts</em><em>)</em>) – The index of the point that this point is fused with (the point
itself if it is not fused).</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The absolute tolerance to define equality between coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>None</em> – After return the flag and sel arrays are changed. The flag array flags
with a 1 the points that remain in the fused set. For the merged points,
the sel array contains the index of the point they are merged with.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="coords.html#coords.Coords.fuse" title="coords.Coords.fuse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coords.Coords.fuse()</span></code></a></dt><dd><p>the user oriented method to fuse points</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="lib.misc_c.isoline">
<code class="sig-prename descclassname">lib.misc_c.</code><code class="sig-name descname">isoline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">level</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.misc_c.isoline" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an isocontour through data at given level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>float32 array</em><em> (</em><em>nx</em><em>,</em><em>ny</em><em>)</em>) – The data values at points with coordinates equal to their indices.
This defines a 2D area (0..nx-1, 0..ny-1)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Data value at which the isocontour is to be constructed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float32 array (nseg, 2, 2)</em> – The line segments of the isocontour. Each segment consist of two
points with two coordinates. The result is empty if level is outside
the data range.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plugins.isosurface.html#plugins.isosurface.isoline" title="plugins.isosurface.isoline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plugins.isosurface.isoline()</span></code></a></dt><dd><p>the user oriented function to use this</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function uses a marching square algorithm.</p>
</dd></dl>

<dl class="py function">
<dt id="lib.misc_c.isosurface">
<code class="sig-prename descclassname">lib.misc_c.</code><code class="sig-name descname">isosurface</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">level</span></em>, <em class="sig-param"><span class="n">tet</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.misc_c.isosurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an isosurface through data at given level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>float32 array</em><em> (</em><em>nx</em><em>,</em><em>ny</em><em>,</em><em>nz</em><em>)</em>) – The data values at points with coordinates equal to their indices.
This defines a 3D volume (0..nx-1, 0..ny-1, 0..nz-1)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The data value at which the isosurface is to be constructed</p></li>
<li><p><strong>tet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – If zero, a marching cubes algorithm is used. If nonzero,
a marching tetrahedrons algorithm is used. The latter is slower and
produces a lot more triangles, but results in a smoother surface.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float32 array (ntri, 3, 3)</em> – The triangles defining the isosurface. Each triangle consists of
3 points with 3 coordinates.
The result is empty if level is outside the data range.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plugins.isosurface.html#plugins.isosurface.isosurface" title="plugins.isosurface.isosurface"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plugins.isosurface.isosurface()</span></code></a></dt><dd><p>the user oriented function to use this</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The algorithms are based on those from
<a class="reference external" href="http://paulbourke.net/geometry/polygonise/">http://paulbourke.net/geometry/polygonise/</a></p>
</dd></dl>

<dl class="py function">
<dt id="lib.misc_c.nodalsum">
<code class="sig-prename descclassname">lib.misc_c.</code><code class="sig-name descname">nodalsum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">elems</span></em>, <em class="sig-param"><span class="n">nnod</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lib.misc_c.nodalsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nodal sum of values defined on elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>float32 array</em><em> (</em><em>nelems</em><em>, </em><em>nplex</em><em>, </em><em>nval</em><em>)</em>) – The data sets: nval values at nplex nodes of nelems elements.</p></li>
<li><p><strong>elems</strong> (<em>int32 array</em><em> (</em><em>nelems</em><em>, </em><em>nplex</em><em>)</em>) – The node indices of the elements.</p></li>
<li><p><strong>nnod</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The number of nodes. It should be higher than the highest node
number used in elems (maxnod). If negative, it will be set to maxnod+1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sum</strong> (<em>float32 array (nnod, nval)</em>) – The sum of all the values at same node</p></li>
<li><p><strong>cnt</strong> (<em>int32 array (nnod)</em>) – The number of values that were summed at each node</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="arraytools.html#arraytools.nodalSum" title="arraytools.nodalSum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">arraytools.nodalSum()</span></code></a></dt><dd><p>the user oriented function to use this</p>
</dd>
</dl>
</div>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lib.misc_e.html" title="112. lib.misc_e — Python equivalents of the functions in lib.misc_c"
             >next</a> |</li>
        <li class="right" >
          <a href="opengl.texture.html" title="110. opengl.texture — Texture rendering."
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" >pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">111. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">lib.misc_c</span></code> — Miscellaneous accelerated low level functions.</a></li--> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2023, Benedict Verhegghe.
    </span>
      Last updated on Mar 27, 2023.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.3.
    </span>
    </div>
  </body>
</html>