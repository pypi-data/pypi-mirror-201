

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>2. formex — Formex algebra in Python &#8212; pyFormex 3.3 documentation</title>

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pyformex.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. mesh — Finite element meshes in pyFormex." href="mesh.html" />
    <link rel="prev" title="1. coords — A structured collection of 3D coordinates." href="coords.html" />
<link rel="icon" type="image/png" href="../_static/pyformex_fav.png" />

  </head><body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="../_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="../_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mesh.html" title="3. mesh — Finite element meshes in pyFormex."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="coords.html" title="1. coords — A structured collection of 3D coordinates."
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" accesskey="U">pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">formex</span></code> — Formex algebra in Python</a></li--> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_SIDEBAR_LOGO -->
<!-- PYFORMEX_WEBSITE_SIDEBAR_TOP -->

  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2. <code class="xref py py-mod docutils literal notranslate"><span class="pre">formex</span></code> — Formex algebra in Python</a><ul>
<li><a class="reference internal" href="#classes-defined-in-module-formex">2.1. Classes defined in module formex</a></li>
<li><a class="reference internal" href="#functions-defined-in-module-formex">2.2. Functions defined in module formex</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="coords.html"
                        title="previous chapter"><span class="section-number">1. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">coords</span></code> — A structured collection of 3D coordinates.</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mesh.html"
                        title="next chapter"><span class="section-number">3. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">mesh</span></code> — Finite element meshes in pyFormex.</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-formex">
<span id="formex-formex-algebra-in-python"></span><span id="sec-ref-formex"></span><h1><span class="section-number">2. </span><a class="reference internal" href="#module-formex" title="formex: Formex algebra in Python"><code class="xref py py-mod docutils literal notranslate"><span class="pre">formex</span></code></a> — Formex algebra in Python<a class="headerlink" href="#module-formex" title="Permalink to this headline">¶</a></h1>
<p>This module defines the <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a> class, which is one of the two
major classes for representing geometry in pyFormex (the other one being
<a class="reference internal" href="mesh.html#mesh.Mesh" title="mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>). The Formex class represents geometry as a simple
3-dim :class`~coords.Coords` array.
This allows an implementation of most functionality
of Formex algebra with a consistent and easy to use syntax.</p>
<div class="section" id="classes-defined-in-module-formex">
<h2><span class="section-number">2.1. </span>Classes defined in module formex<a class="headerlink" href="#classes-defined-in-module-formex" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="formex.Formex">
<em class="property">class </em><code class="sig-prename descclassname">formex.</code><code class="sig-name descname">Formex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prop</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eltype</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex" title="Permalink to this definition">¶</a></dt>
<dd><p>A structured collection of points in 3D space.</p>
<p>A Formex is a collection of points in a 3D cartesian space.
The collection is structured into a set of elements all having the
same number of points (e.g. a collection triangles all having three
points).</p>
<p>As the Formex class is derived from <a class="reference internal" href="geometry.html#geometry.Geometry" title="geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>,
a Formex object has a <a class="reference internal" href="coords.html#module-coords" title="coords: A structured collection of 3D coordinates."><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code></a> attribute which is a
<a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coords</span></code></a> object. In a Formex this is always an
array with 3 axes (numbered 0,1,2).
Each scalar element of this array represents a coordinate.
A row along the last axis (2) is a set of 3 coordinates and represents
a point (aka. node, vertex).</p>
<p>For simplicity’s sake, the current implementation only deals with points
in a 3-dimensional space. This means that the length of axis 2 always
equals 3.
The user can create Formices (plural of Formex) in a 2-D space, but
internally these will be stored with 3 coordinates, by adding a third
value 0. All operations work with 3-D coordinate sets. However, it is
easy to extract only a limited set of coordinates from the results,
permitting to return to a 2-D environment</p>
<p>A plane of the array along the axes 2 and 1 is a set of points:
we call this an element.
This can be thought of as a geometrical shape (2 points form a line segment,
3 points make a triangle, …) or as an element in Finite Element terms.
But it really is up to the user as to how this set of points is to be
interpreted. He can set an element type on the Formex to make this clear
(see below).</p>
<p>The whole Formex then represents a collection of such elements.
The Formex concept and layout is made more clear in
<a class="reference internal" href="../tutorial.html#sec-formex"><span class="std std-ref">Formex data model</span></a> in the <a class="reference internal" href="../tutorial.html"><span class="doc">pyFormex tutorial</span></a>.</p>
<p>Additionally, a Formex may have a property set, which is an 1-D array of
integers. The length of the array is equal to the length of axis 0 of the
Formex data (i.e. the number of elements in the Formex). Thus, a single
integer value may be attributed to each element. It is up to the user to
define the use of this integer (e.g. it could be an index in a table of
element property records).
If a property set is defined, it will be copied together with the Formex
data whenever copies of the Formex (or parts thereof) are made.
Properties can be specified at creation time, and they can be set,
modified or deleted at any time. Of course, the properties that are
copied in an operation are those that exist at the time of performing
the operation.</p>
<p>Finally, a Formex object can have an element type, because plexitude
alone does not uniquely define what the geometric entities are, and how
they should be rendered. By default, pyFormex will render plex-1 as
points, plex-2 as line segments, plex-3 as triangles and any higher
plexitude as polygons. But the user could e.g. set
<code class="docutils literal notranslate"><span class="pre">eltype</span> <span class="pre">=</span> <span class="pre">'tet4'</span></code> on a plex-4 Formex, and then that would be rendered
as tetraeders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (Formex, Coords, <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> or string) – Data to initialize the coordinates attribute <code class="docutils literal notranslate"><span class="pre">coords</span></code> in the Formex.
See more details below.</p></li>
<li><p><strong>prop</strong> (int <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a>, optional) – 1-dim int array with non-negative element property numbers.
If provided, <code class="xref py py-meth docutils literal notranslate"><span class="pre">setProp()</span></code> will be called to assign the
specified properties.</p></li>
<li><p><strong>eltype</strong> (str | <a class="reference internal" href="elements.html#elements.ElementType" title="elements.ElementType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementType</span></code></a>, optional) – The element type of the geometric entities (elements).
If provided, it should be an <a class="reference internal" href="elements.html#elements.ElementType" title="elements.ElementType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementType</span></code></a>
instance or the name of such an instance.
If not provided, the pyFormex default is used when needed and is
based on the plexitude: 1 = point, 2 = line segment,
3 = triangle, 4 or more is a polygon.</p></li>
</ul>
</dd>
</dl>
<p>The Formex coordinate data can be initialized by another <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a>,
by a <code class="xref py py-class docutils literal notranslate"><span class="pre">Coords</span></code>, by a 1D, 2D or 3D <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a>, or by a string
that will be passed to <a class="reference internal" href="coords.html#coords.fpattern" title="coords.fpattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">coords.fpattern()</span></code></a> to generate the
coordinates.
If 2D coordinates are given, a 3-rd coordinate 0.0 is added.
Internally, Formices always work with 3D coordinates.
Thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
</pre></div>
</div>
<p>creates a Formex with two elements, each having 2 points in the global
z-plane. The innermost level of brackets group the coordinates of a
point, the next level groups the points in an element, and the outermost
brackets group all the elements of the Formex.
Because the coordinates are stored in an array with 3 axes,
all the elements in a Formex must contain the same number of points.
This number is called the plexitude of the Formex.</p>
<p>A Formex may be initialized with a string instead of the numerical
coordinate data. The string is passed to <a class="reference internal" href="coords.html#coords.fpattern" title="coords.fpattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">coords.fpattern()</span></code></a> to
generate the coordinates.
The following are two equivalent definitions of (the circumference of)
a triangle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;2:010207&#39;</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:127&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Because the <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a> class is derived from
<a class="reference internal" href="geometry.html#geometry.Geometry" title="geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a>, it has the following attributes:</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code>,</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">prop</span></code>,</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">attrib</span></code>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.fields" title="geometry.Geometry.fields"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code></a>.</p></li>
</ul>
<p>Furthermore it has the following properties and methods that are applied
on the <code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code> attribute.</p>
<ul class="simple">
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.xyz" title="geometry.Geometry.xyz"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xyz</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.x" title="geometry.Geometry.x"><code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.y" title="geometry.Geometry.y"><code class="xref py py-attr docutils literal notranslate"><span class="pre">y</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.z" title="geometry.Geometry.z"><code class="xref py py-attr docutils literal notranslate"><span class="pre">z</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.xy" title="geometry.Geometry.xy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xy</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.yz" title="geometry.Geometry.yz"><code class="xref py py-attr docutils literal notranslate"><span class="pre">yz</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.xz" title="geometry.Geometry.xz"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xz</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.points" title="geometry.Geometry.points"><code class="xref py py-meth docutils literal notranslate"><span class="pre">points()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.bbox" title="geometry.Geometry.bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bbox()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.center" title="geometry.Geometry.center"><code class="xref py py-meth docutils literal notranslate"><span class="pre">center()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.bboxPoint" title="geometry.Geometry.bboxPoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bboxPoint()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.centroid" title="geometry.Geometry.centroid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">centroid()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.sizes" title="geometry.Geometry.sizes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sizes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.dsize" title="geometry.Geometry.dsize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dsize()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.bsphere" title="geometry.Geometry.bsphere"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bsphere()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.bboxes" title="geometry.Geometry.bboxes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bboxes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.inertia" title="geometry.Geometry.inertia"><code class="xref py py-meth docutils literal notranslate"><span class="pre">inertia()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.principalCS" title="geometry.Geometry.principalCS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">principalCS()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.principalSizes" title="geometry.Geometry.principalSizes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">principalSizes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.distanceFromPlane" title="geometry.Geometry.distanceFromPlane"><code class="xref py py-meth docutils literal notranslate"><span class="pre">distanceFromPlane()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.distanceFromLine" title="geometry.Geometry.distanceFromLine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">distanceFromLine()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.distanceFromPoint" title="geometry.Geometry.distanceFromPoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">distanceFromPoint()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.directionalSize" title="geometry.Geometry.directionalSize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">directionalSize()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.directionalWidth" title="geometry.Geometry.directionalWidth"><code class="xref py py-meth docutils literal notranslate"><span class="pre">directionalWidth()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.directionalExtremes" title="geometry.Geometry.directionalExtremes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">directionalExtremes()</span></code></a>.</p></li>
</ul>
<p>Also, the following Coords transformation methods can be
directly applied to a <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a> object.
The return value is a new Formex identical to the original,
except for the coordinates,
which are transformed by the specified method.
Refer to the corresponding <a class="reference internal" href="coords.html#coords.Coords" title="coords.Coords"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coords</span></code></a> method
for the usage of these methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.scale" title="geometry.Geometry.scale"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scale()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.adjust" title="geometry.Geometry.adjust"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjust()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.translate" title="geometry.Geometry.translate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">translate()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.centered" title="geometry.Geometry.centered"><code class="xref py py-meth docutils literal notranslate"><span class="pre">centered()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.align" title="geometry.Geometry.align"><code class="xref py py-meth docutils literal notranslate"><span class="pre">align()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.rotate" title="geometry.Geometry.rotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rotate()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.shear" title="geometry.Geometry.shear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shear()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.reflect" title="geometry.Geometry.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reflect()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.affine" title="geometry.Geometry.affine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">affine()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.toCS" title="geometry.Geometry.toCS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">toCS()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.fromCS" title="geometry.Geometry.fromCS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fromCS()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.transformCS" title="geometry.Geometry.transformCS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transformCS()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.position" title="geometry.Geometry.position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">position()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.cylindrical" title="geometry.Geometry.cylindrical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cylindrical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.hyperCylindrical" title="geometry.Geometry.hyperCylindrical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hyperCylindrical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.toCylindrical" title="geometry.Geometry.toCylindrical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">toCylindrical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.spherical" title="geometry.Geometry.spherical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spherical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.superSpherical" title="geometry.Geometry.superSpherical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">superSpherical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.toSpherical" title="geometry.Geometry.toSpherical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">toSpherical()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.bump" title="geometry.Geometry.bump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bump()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.flare" title="geometry.Geometry.flare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flare()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.map" title="geometry.Geometry.map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.map1" title="geometry.Geometry.map1"><code class="xref py py-meth docutils literal notranslate"><span class="pre">map1()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.mapd" title="geometry.Geometry.mapd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mapd()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.copyAxes" title="geometry.Geometry.copyAxes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copyAxes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.swapAxes" title="geometry.Geometry.swapAxes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">swapAxes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.rollAxes" title="geometry.Geometry.rollAxes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollAxes()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.projectOnPlane" title="geometry.Geometry.projectOnPlane"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectOnPlane()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.projectOnSphere" title="geometry.Geometry.projectOnSphere"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectOnSphere()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.projectOnCylinder" title="geometry.Geometry.projectOnCylinder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projectOnCylinder()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.isopar" title="geometry.Geometry.isopar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isopar()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.addNoise" title="geometry.Geometry.addNoise"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addNoise()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.rot" title="geometry.Geometry.rot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rot()</span></code></a>,</p></li>
<li><p><a class="reference internal" href="geometry.html#geometry.Geometry.trl" title="geometry.Geometry.trl"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trl()</span></code></a>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="o">.</span><span class="fm">__str__</span> <span class="o">=</span> <span class="n">Formex</span><span class="o">.</span><span class="n">asFormex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]))</span>
<span class="go">{[0.0,1.0,0.0], [2.0,3.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;1:0123&#39;</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [1.0,1.0,0.0], [0.0,1.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;4:0123&#39;</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0; 1.0,1.0,0.0; 0.0,1.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;2:0123&#39;</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0], [1.0,1.0,0.0; 0.0,1.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0], [1.0,0.0,0.0; 1.0,1.0,0.0],     [1.0,1.0,0.0; 0.0,1.0,0.0], [0.0,1.0,0.0; 0.0,0.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="go">shape    = (4, 2, 3)</span>
<span class="go">bbox[lo] = [0.  0.  0.]</span>
<span class="go">bbox[hi] = [1.  1.  0.]</span>
<span class="go">center   = [0.5  0.5  0. ]</span>
<span class="go">maxprop  = -1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">nelems</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">x</span>
<span class="go">array([[0.,  1.],</span>
<span class="go">       [1.,  1.],</span>
<span class="go">       [1.,  0.],</span>
<span class="go">       [0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="go">Coords([0.5,  0.5,  0. ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">bboxPoint</span><span class="p">(</span><span class="s1">&#39;+++&#39;</span><span class="p">)</span>
<span class="go">Coords([1.,  1.,  0.])</span>
</pre></div>
</div>
<p>The Formex class defines the following attributes above the ones
inherited from Geometry:</p>
<dl class="py attribute">
<dt id="formex.Formex.eltype">
<code class="sig-name descname">eltype</code><a class="headerlink" href="#formex.Formex.eltype" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>None or <a class="reference internal" href="elements.html#elements.ElementType" title="elements.ElementType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementType</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#formex.Formex.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shape of the Formex.</p>
<p>The shape of a Formex is the shape of its coords array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>tuple of ints</em> – A tuple (nelems, nplex, ndim).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;1:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 1, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.nelems">
<code class="sig-name descname">nelems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.nelems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.nelems" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of elements of the <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a>.</p>
<p>The number of elements is the length of the first axis of the
<code class="docutils literal notranslate"><span class="pre">coords</span></code> array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em> – The number of elements in the Formex</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nelems</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.nplex">
<code class="sig-name descname">nplex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.nplex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.nplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the plexitude of the <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a>.</p>
<p>The plexitude is the number of points per element. This is
the length of the second axis of the coords array.</p>
<p>Examples:</p>
<ol class="arabic simple">
<li><p>unconnected points,</p></li>
<li><p>straight line elements,</p></li>
<li><p>triangles or quadratic line elements,</p></li>
<li><p>tetraeders or quadrilaterals or cubic line elements.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em> – The plexitude of the elements in the Formex</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nplex</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.npoints">
<code class="sig-name descname">npoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.npoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.npoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of points in the Formex.</p>
<p>This is the product of the number of elements in the Formex
with the plexitude of the elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em> – The total number of points in the Formex</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">ncoords</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">npoints</span></code></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">npoints</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.ncoords">
<code class="sig-name descname">ncoords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#formex.Formex.ncoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of points in the Formex.</p>
<p>This is the product of the number of elements in the Formex
with the plexitude of the elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em> – The total number of points in the Formex</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">ncoords</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">npoints</span></code></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">npoints</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.elType">
<code class="sig-name descname">elType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.elType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.elType" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the element type of the Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="elements.html#elements.ElementType" title="elements.ElementType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementType</span></code></a> or None – If an element type was defined for the Formex, returns
the corresponding ElementType; else returns None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.elName" title="formex.Formex.elName"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elName</span></code></a></dt><dd><p>Return the name of the ElementType</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elType</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">,</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;line2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elType</span><span class="p">()</span>
<span class="go">Line2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.elName">
<code class="sig-name descname">elName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.elName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.elName" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the element name of the Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>str or None</em> – If an element type was defined for the Formex, returns
the name of the ElementType ; else returns None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.elType" title="formex.Formex.elType"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elType</span></code></a></dt><dd><p>Return the ElementType</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elName</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1234&#39;</span><span class="p">,</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;line2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">elName</span><span class="p">()</span>
<span class="go">&#39;line2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.level">
<code class="sig-name descname">level</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level (dimensionality) of the Formex.</p>
<p>The level or dimensionality of a geometrical object is the minimum
number of parametric directions required to describe the object.
Thus we have the following values:</p>
<p>0: points
1: lines
2: surfaces
3: volumes</p>
<p>If the Formex has an ‘eltype’ set, the value is determined from
the Element database. Else, the value is equal to the plexitude minus
one for plexitudes up to 3, and equal to 2 for any higher plexitude
(since the default is to interprete a higher plexitude as a polygon).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>int</em> – An int 0..3 giving the number of parametric dimensions of the
geometric entities in the Formex.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;1:123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:123&#39;</span><span class="p">,</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;line3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.view">
<code class="sig-name descname">view</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Formex coordinates as a numpy array (ndarray).</p>
<p>Returns a view to the Coords array as an ndarray. The use of
this method is deprecated: use the <code class="xref py py-attr docutils literal notranslate"><span class="pre">xyz</span></code> property
instead.</p>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.element">
<code class="sig-name descname">element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.element"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return element i of the Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index of the element to return.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Coords object</em> – A Coords with shape (self.nplex(), 3)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Coords([[0.,  0.,  0.],</span>
<span class="go">    [1.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Formex([[[0.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.point">
<code class="sig-name descname">point</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return point j of element i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index of the element from which to return a point.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index in element i of the point to be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Coords object</em> – A Coords with shape (3,), being point j of element i.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Coords([1.,  0.,  0.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.coord">
<code class="sig-name descname">coord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinate k of point j of element i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index of the element from which to return a point.</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index in element i of the point for which to return a coordinate.</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – The index in point (i,j) of the coordinate to be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – The value of coordinate k of point j of element i.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.centroids">
<code class="sig-name descname">centroids</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.centroids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroids of all elements of the Formex.</p>
<p>The centroid of an element is the point whose coordinates
are the average values of all points of the element.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Coords</em> – A Coords object with shape (<a class="reference internal" href="#formex.Formex.nelems" title="formex.Formex.nelems"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nelems()</span></code></a>, 3), holding the
centroids of all the elements in the Formex.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">centroids</span><span class="p">()</span>
<span class="go">Coords([[0.5,  0. ,  0. ],</span>
<span class="go">        [1. ,  0.5,  0. ],</span>
<span class="go">        [0.5,  1. ,  0. ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.toMesh">
<code class="sig-name descname">toMesh</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.toMesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.toMesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Formex to a Mesh.</p>
<p>Converts a geometry in Formex model to the equivalent Mesh model.
In the Mesh model, all points with nearly identical coordinates
are fused into a single point (using <a class="reference internal" href="coords.html#coords.Coords.fuse" title="coords.Coords.fuse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fuse()</span></code></a>),
and elements are defined by a connectivity table with integers
pointing to the corresponding vertex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kargs</strong> – Keyword parameters to be passed to <a class="reference internal" href="coords.html#coords.Coords.fuse" title="coords.Coords.fuse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fuse()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Mesh</em> – A Mesh representing the same geometrical model as the input
Formex. Property numbers <code class="xref py py-attr docutils literal notranslate"><span class="pre">prop</span></code> and element type
<a class="reference internal" href="#formex.Formex.eltype" title="formex.Formex.eltype"><code class="xref py py-attr docutils literal notranslate"><span class="pre">eltype</span></code></a> are also set to the same values as in the Formex.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span>
<span class="go">Formex([[[0.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]],</span>

<span class="go">        [[1.,  0.,  0.],</span>
<span class="go">         [1.,  1.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">toMesh</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Mesh: nnodes: 3, nelems: 2, nplex: 2, level: 1, eltype: line2</span>
<span class="go">  BBox: [0.  0.  0.], [1.  1.  0.]</span>
<span class="go">  Size: [1.  1.  0.]</span>
<span class="go">  Length: 2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.toSurface">
<code class="sig-name descname">toSurface</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.toSurface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.toSurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Formex to a Surface.</p>
<p>Tries to convert the Formex to a TriSurface.
First the Formex is converted to a Mesh, and then the resulting Mesh
is converted to a TriSurface.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>TriSurface</em> – A TriSurface if the conversion is successful, else an error is raised.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The conversion will only work if the Formex represents a surface and
its elements are triangles or quadrilaterals.
If the plexitude of the Formex is 3, the element type is ‘tri3’ or
None, the returned TriSurface is equivalent with the Formex.
If the Formex contains higher order triangles or quadrilaterals,
the new geometry will be an approximation of the input.
Any other input geometry will fail to convert.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span>
<span class="go">Formex([[[0.,  0.,  0.],</span>
<span class="go">     [1.,  0.,  0.],</span>
<span class="go">     [1.,  1.,  0.]],</span>

<span class="go">    [[1.,  1.,  0.],</span>
<span class="go">     [0.,  1.,  0.],</span>
<span class="go">     [0.,  0.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">toSurface</span><span class="p">())</span>
<span class="go">TriSurface: nnodes: 4, nelems: 2, nplex: 3, level: 2, eltype: tri3</span>
<span class="go">  BBox: [0.  0.  0.], [1.  1.  0.]</span>
<span class="go">  Size: [1.  1.  0.]</span>
<span class="go">  Length: 4.0  Area: 1.0  Volume: 0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.toCurve">
<code class="sig-name descname">toCurve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">closed</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.toCurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.toCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Formex to a Curve.</p>
<p>The following Formices can be converted to a Curve:
- plex 1 : to PolyLine, connecting the points
- plex 2 : to PolyLine
- plex 3 : to BezierSpline of degree 2
- plex 4 : to BezierSpline of degree 3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Create a closed curve</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>BezierSpline | PolyLine</em> – A BezierSpline or PolyLine created from the points in the Formex.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>It is expected that the elements of the Formex form a continuous
line, i.e. each element of the Formex starts with the same
point as the previous element ends.</p>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information about a Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>A multiline string with some basic information about the Formex</em></p></li>
<li><p><em>its shape, bounding box, center and maxprop.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="go">shape    = (2, 3, 3)</span>
<span class="go">bbox[lo] = [0.  0.  0.]</span>
<span class="go">bbox[hi] = [1.  1.  0.]</span>
<span class="go">center   = [0.5  0.5  0. ]</span>
<span class="go">maxprop  = -1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.report">
<code class="sig-name descname">report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a report on the Formex shape and size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If False (default), the report only contains the number of points,
the number of elements, the plexitude, the dimensionality, and the
element type (None in most cases).
If True, it also contains the coordinates array.</p></li>
<li><p><strong>**kargs</strong> – Numpy print options to be used in the formatting of the coords
array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>str</em> – A multiline string with the report.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.point2str">
<em class="property">classmethod </em><code class="sig-name descname">point2str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">point</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.point2str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.point2str" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation of a point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>elem</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The coordinates of athe point to return as a string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>str</em> – A string with the representation of a single point.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="o">.</span><span class="n">point2str</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">])</span>
<span class="go">&#39;1.0,2.0,3.0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.element2str">
<em class="property">classmethod </em><code class="sig-name descname">element2str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elem</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.element2str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.element2str" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation of an element</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>elem</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (nplex,3)) – The element to return as a string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>str</em> – A string with the representation of a single element.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="o">.</span><span class="n">element2str</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">],[</span><span class="mf">4.</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">6.</span><span class="p">]])</span>
<span class="go">&#39;[1.0,2.0,3.0; 4.0,5.0,6.0]&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.asFormex">
<code class="sig-name descname">asFormex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.asFormex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.asFormex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation of all the coordinates in a Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>str</em> – A single string with all the coordinates of the Formex.
Coordinates are separated by commas, points are separated
by semicolons and grouped between brackets, elements are
separated by commas and grouped between braces.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">asFormex</span><span class="p">()</span>
<span class="go">&#39;{[1.0,0.0,0.0; 0.0,1.0,0.0], [0.0,1.0,0.0; 1.0,2.0,0.0]}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.asFormexWithProp">
<code class="sig-name descname">asFormexWithProp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.asFormexWithProp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.asFormexWithProp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation as Formex with properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>str</em> – The string representation as done by <a class="reference internal" href="#formex.Formex.asFormex" title="formex.Formex.asFormex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asFormex()</span></code></a>,
followed by the words “with prop” and a list of the properties.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span><span class="o">.</span><span class="n">setProp</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">asFormexWithProp</span><span class="p">()</span>
<span class="go">&#39;{[1.0,0.0,0.0; 0.0,1.0,0.0], [0.0,1.0,0.0; 1.0,2.0,0.0]} with prop [1 2]&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.asCoords">
<code class="sig-name descname">asCoords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.asCoords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.asCoords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation as a Coords.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>str</em> – A multiline string with the coordinates of the Formex as
formatted by the meth:<cite>coords.Coords.__repr__</cite> method.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">asCoords</span><span class="p">())</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">        [0.,  1.,  0.]],</span>

<span class="go">       [[0.,  1.,  0.],</span>
<span class="go">        [1.,  2.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.asarray">
<code class="sig-name descname">asarray</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.asarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.asarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation as a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>str</em> – A multiline string with the coordinates of the Formex as
formatted by the meth:<cite>coords.Coords.__str__</cite> method.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">asarray</span><span class="p">())</span>
<span class="go"> [[[1.  0.  0.]</span>
<span class="go">  [0.  1.  0.]]</span>

<span class="go"> [[0.  1.  0.]</span>
<span class="go">  [1.  2.  0.]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.concatenate">
<em class="property">classmethod </em><code class="sig-name descname">concatenate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Flist</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.concatenate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate a list of Formices.</p>
<p>All the Formices in the list should have the same plexitude,
If any of the Formices has property numbers, the resulting Formex will
inherit the properties. In that case, any Formices without properties
will be assigned property 0.
If all Formices are without properties, so will be the result.
The eltype of the resulting Formex will be that of the first Formex in
the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Flist</strong> (<em>list of Formex objects</em>) – A list of Formices all having the same plexitude.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – The concatenation of all the Formices in the list. The number of
elements in the Formex is the sum of the number of elements in
all the Formices.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a class method, not an instance method. It is commonly
invoked as <code class="docutils literal notranslate"><span class="pre">Formex.concatenate</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.__add__" title="formex.Formex.__add__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__add__</span></code></a></dt><dd><p>implements concatenation as simple addition (F+G)</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span><span class="o">.</span><span class="n">setProp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">])</span><span class="o">.</span><span class="n">setProp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">Formex</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">asFormexWithProp</span><span class="p">())</span>
<span class="go">{[1.0,1.0,1.0], [2.0,2.0,2.0], [3.0,3.0,3.0]} with prop [1 0 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.__add__">
<code class="sig-name descname">__add__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">F</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.__add__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate two formices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>F</strong> (<a class="reference internal" href="#formex.Formex" title="formex.Formex"><em>Formex</em></a>) – A Formex with the same plexitude as self.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – The concatenation of the Formices self and F.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method implements the addition operation and allows to write
simple expressions as F+G to concatenate the Formices F and G. When
concatenating many Formices, <a class="reference internal" href="#formex.Formex.concatenate" title="formex.Formex.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a> is more efficient
however, because all the Formices in the list are concatenated in
one operation.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.concatenate" title="formex.Formex.concatenate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">concatenate</span></code></a></dt><dd><p>concatenate a list of Formices</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span><span class="o">.</span><span class="n">setProp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">3.</span><span class="p">])</span><span class="o">.</span><span class="n">setProp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">F</span><span class="o">+</span><span class="n">G</span><span class="o">+</span><span class="n">H</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">asFormexWithProp</span><span class="p">())</span>
<span class="go">{[1.0,1.0,1.0], [2.0,2.0,2.0], [3.0,3.0,3.0]} with prop [1 0 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a Formex in Formices containing n elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of elements per Formex</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of Formices</em> – A list of Formices all containing n elements, except for the last,
which may contain less.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[Formex([[[0.,  0.,  0.],</span>
<span class="go">        [1.,  0.,  0.]],</span>

<span class="go">       [[1.,  0.,  0.],</span>
<span class="go">        [2.,  0.,  0.]]]), Formex([[[2.,  0.,  0.],</span>
<span class="go">        [3.,  0.,  0.]]])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.selectNodes">
<code class="sig-name descname">selectNodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.selectNodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.selectNodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a Formex holding only some points of the parent.</p>
<p>This creates subentities of all elements in the Formex.
The returned Formex inherits the properties of the parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>list of ints</em>) – Indices of the points to retain in the new Formex.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For example, if F is a plex-3 Formex representing triangles, the
sides of the triangles are given by
F.selectNodes([0,1]) + F.selectNodes([1,2]) + F.selectNodes([2,0])</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/select.html#module-select" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select</span></code></a></dt><dd><p>Select elements from a Formex</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">selectNodes</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0], [1.0,1.0,0.0; 0.0,1.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.asPoints">
<code class="sig-name descname">asPoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.asPoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.asPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the Formex to a simple set of points.</p>
<p>This removes the element structure of the Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Formex</em> – A Formex with plexitude 1 and number of elements (points) equal
to <code class="docutils literal notranslate"><span class="pre">self.nelems()</span> <span class="pre">*</span> <span class="pre">self.nplex()</span></code>. The Formex shares the
coordinate data with the parent. If the parent has properties,
they are multiplexed so that each point has the property of its
parent element. The eltype of the returned Formex is None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">points</span></code></dt><dd><p>returns the list of points as a Coords object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">asPoints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">asFormexWithProp</span><span class="p">())</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [1.0,1.0,0.0], [1.0,1.0,0.0],         [0.0,1.0,0.0], [0.0,0.0,0.0]} with prop [1 1 1 2 2 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">permutations</span><span class="o">=</span><span class="default_value">'roll'</span></em>, <em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove elements that also occur in another Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F</strong> (<a class="reference internal" href="#formex.Formex" title="formex.Formex"><em>Formex</em></a>) – Another Formex with the same plexitude as self.</p></li>
<li><p><strong>permutations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, elements consisting of the</p></li>
<li><p><strong>is also the subtraction of the current Formex with F.</strong> (<em>This</em>) – </p></li>
<li><p><strong>are only removed if they have the same nodes in the same</strong> (<em>Elements</em>) – </p></li>
<li><p><strong>order.</strong> – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:111&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="go">{[1.0,0.0,0.0; 2.0,0.0,0.0], [2.0,0.0,0.0; 3.0,0.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.removeDuplicate">
<code class="sig-name descname">removeDuplicate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">permutations</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.removeDuplicate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.removeDuplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Formex which holds only the unique elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>permutations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – <p>Defines which permutations of the element points are allowed
while still considering the elements equal. Possible values are:</p>
<ul>
<li><p>’none’: no permutations are allowed: elements must have
matching points at all locations. This is the default;</p></li>
<li><p>’roll’: rolling is allowed. Elements that can be transformed into
each other by rolling their points are considered equal;</p></li>
<li><p>’all’: any permutation of the same points will be considered an
equal element.</p></li>
</ul>
</p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – Relative tolerance used when considering two points being equal.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – Absolute tolerance used when considering two points being equal.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">rtol</span></code> and <code class="docutils literal notranslate"><span class="pre">atol</span></code> are passed to <a class="reference internal" href="coords.html#coords.Coords.fuse" title="coords.Coords.fuse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coords.Coords.fuse()</span></code></a> to find
equal points. <code class="docutils literal notranslate"><span class="pre">permutation</span></code> is passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">arraytools.unique()</span></code>
to remove the duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:111&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">removeDuplicate</span><span class="p">())</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0], [1.0,0.0,0.0; 2.0,0.0,0.0],         [2.0,0.0,0.0; 3.0,0.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.test">
<code class="sig-name descname">test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nodes</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag elements having coordinates between min and max.</p>
<p>This is comparable with <a class="reference internal" href="coords.html#coords.Coords.test" title="coords.Coords.test"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coords.Coords.test()</span></code></a> but operates
at the Formex element level. It tests the position of one or more
points of the elements of the <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a> with respect to
one or two parallel planes. This is very useful in clipping
a Formex in a specified direction. In most cases the clipping
direction is one of the global coordinate axes, but a general
direction may be used as well.</p>
<p>Testing along global axis directions is highly efficient. It tests
whether the corresponding coordinate is above or equal to the <cite>min</cite>
value and/or below or equal to the <cite>max</cite> value. Testing in a general
direction tests whether the distance to the <cite>min</cite> plane is positive
or zero and/or the distance to the <cite>max</cite> plane is negative or zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>list of ints</em><em> or </em><em>string</em>) – <p>Specifies which points of the elements are taken into account
in the tests. It should be one of the following:</p>
<ul>
<li><p>a single point index (smaller than self.nplex()),</p></li>
<li><p>a list of point numbers ( all smaller than &lt; self.nplex()),</p></li>
<li><p>one of the special strings: ‘all’, ‘any’, ‘none’.</p></li>
</ul>
<p>The default (‘all’) will flag the elements that have all their
nodes between the planes x=min and x=max, i.e. the elements that
fall completely between these planes.</p>
</p></li>
<li><p><strong>dir</strong> (a single int or a float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The direction in which to measure distances. If an int, it is
one of the global axes (0,1,2). Else it is a vector with 3
components. The default direction is the global x-axis.</p></li>
<li><p><strong>min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>point-like</em><em>, </em><em>optional</em>) – Position of the minimal clipping plane.
If <cite>dir</cite> is an int, this is a single float giving the coordinate
along the specified global axis. If <cite>dir</cite> is a vector, this must
be a point and the minimal clipping plane is defined by this point
and the normal vector <cite>dir</cite>. If not provided, there is no clipping
at the minimal side.</p></li>
<li><p><strong>max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> or </em><em>point-like.</em>) – Position of the maximal clipping plane.
If <cite>dir</cite> is an int, this is a single float giving the coordinate
along the specified global axis. If <cite>dir</cite> is a vector, this must
be a point and the maximal clipping plane is defined by this point
and the normal vector <cite>dir</cite>. If not provided, there is no clipping
at the maximal side.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Tolerance value added to the tests to account for accuracy
and rounding errors.
A <cite>min</cite> test will be ok if the point’s distance from the
<cite>min</cite> clipping plane is <cite>&gt; -atol</cite> and/or the distance from the
<cite>max</cite> clipping plane is <cite>&lt; atol</cite>. Thus a positive atol widens the
clipping planes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>1-dim bool array</em> – Array with length <code class="docutils literal notranslate"><span class="pre">self.nelems()</span></code> flagging the elements that
pass the test(s). The return value can directly be used as an
index in <code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code> or <cite>cselect</cite> to obtain a <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a>
with the elements satisfying the test or not. Or you can use
<code class="docutils literal notranslate"><span class="pre">np.where(result)[0]</span></code> to get the indices of the elements passing
the test.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – At least one of min or max have to be specified: If neither <cite>min</cite> nor <cite>max</cite> are provided.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/select.html#module-select" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select</span></code></a></dt><dd><p>return only the selected elements</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cselect</span></code></dt><dd><p>return all but the selected elements</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1122&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">asFormex</span><span class="p">())</span>
<span class="go">{[0.0,0.0,0.0; 1.0,0.0,0.0], [1.0,0.0,0.0; 2.0,0.0,0.0],         [2.0,0.0,0.0; 2.0,1.0,0.0], [2.0,1.0,0.0; 2.0,2.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">array([ True, False, False, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">array([ True,  True, False, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="nb">min</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
<span class="go">array([ True, False, False,  True])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="nb">min</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span><span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="go">array([ True,  True,  True,  True])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.shrink">
<code class="sig-name descname">shrink</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">factor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.shrink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.shrink" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale all elements with respect to their own center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Scaling factor for the elements. A value &lt; 1.0 will shrink the
elements, while a facter &gt; 1.0 will enlarge them.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex where each element has been scaled with the specified
factor in local axes with origin at the element’s center.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This operation is called ‘shrink’ because it is commonly used
with a factor smaller that 1 (often around 0.9) to draw an exploded
view where touching elements are disconnected.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shrink</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
<span class="go">Formex([[[0.1,  0. ,  0. ],</span>
<span class="go">         [0.9,  0. ,  0. ]],</span>

<span class="go">        [[1. ,  0.1,  0. ],</span>
<span class="go">         [1. ,  0.9,  0. ]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.circulize1">
<code class="sig-name descname">circulize1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.circulize1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.circulize1" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the first octant of the 0-1 plane into 1/6 of a circle.</p>
<p>Points on the 0-axis keep their position. Lines parallel to the 1-axis
are transformed into circular arcs. The bisector of the first quadrant
is transformed in a straight line at an angle Pi/6.
This function is especially suited to create circular domains where
all bars have nearly same length. See the Diamatic example.</p>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.reverse">
<code class="sig-name descname">reverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.reverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Formex where all elements have been reversed.</p>
<p>Reversing an element means reversing the order of its points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>Formex</em> – A Formex with same shape, where the points of all elements
are in reverse order.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is equivalent to <code class="docutils literal notranslate"><span class="pre">self.selectNodes(np.arange(self.nplex()-1,-1,-1))</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">         [0.,  0.,  0.]],</span>

<span class="go">        [[2.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.mirror">
<code class="sig-name descname">mirror</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">pos</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">keep_orig</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.mirror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.mirror" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a reflection in one of the coordinate directions.</p>
<p>This method is like <a class="reference internal" href="geometry.html#geometry.Geometry.reflect" title="geometry.Geometry.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reflect()</span></code></a>,
but by default adds the reflected part to the original.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> (</em><em>0</em><em>,</em><em>1</em><em>,</em><em>2</em><em>)</em>) – Global axis direction of the reflection (default 0 or x-axis).</p></li>
<li><p><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Offset of the mirror plane from origin (default 0.0)</p></li>
<li><p><strong>keep_orig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If True (default) the original plus the mirrored geometry is
returned. Setting it to False will only return the mirror, and
thus behaves just like <a class="reference internal" href="geometry.html#geometry.Geometry.reflect" title="geometry.Geometry.reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reflect()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with the original and the mirrored elements, or
only the mirrored elements if <code class="docutils literal notranslate"><span class="pre">keep_orig</span></code> is False.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
<span class="go">Formex([[[ 0.,  0.,  0.],</span>
<span class="go">         [ 1.,  0.,  0.]],</span>

<span class="go">        [[ 1.,  0.,  0.],</span>
<span class="go">         [ 2.,  0.,  0.]],</span>

<span class="go">        [[ 0.,  0.,  0.],</span>
<span class="go">         [-1.,  0.,  0.]],</span>

<span class="go">        [[-1.,  0.,  0.],</span>
<span class="go">         [-2.,  0.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">mirror</span><span class="p">(</span><span class="n">keep_orig</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Formex([[[ 0.,  0.,  0.],</span>
<span class="go">     [-1.,  0.,  0.]],</span>

<span class="go">    [[-1.,  0.,  0.],</span>
<span class="go">     [-2.,  0.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.translatem">
<code class="sig-name descname">translatem</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.translatem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.translatem" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiple subsequent translations in axis directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>one</em><em> or </em><em>more tuples</em><em> (</em><em>axis</em><em>, </em><em>step</em><em>)</em><em></em>) – Each argument is a tuple (axis, step) which will do
a translation over a length <code class="docutils literal notranslate"><span class="pre">step</span></code> in the direction
of the global axis <code class="docutils literal notranslate"><span class="pre">axis</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – The input Formex translated over the combined translation
vector of the arguments.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is especially convenient to translate over computed
steps.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">translate</span></code></dt><dd><p>translate a Formex</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">translatem</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="mi">2</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]),(</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span>             <span class="n">F</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.replicate">
<code class="sig-name descname">replicate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.replicate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.replicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Create copies at regular distances along a straight line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of copies to create</p></li>
<li><p><strong>dir</strong> (int (0,1,2) or float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The translation vector. If an int, it specifies a global axis
and the translation is in the direction of that axis.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – If <code class="docutils literal notranslate"><span class="pre">dir</span></code> is an int, this is the length of the translation.
Else, it is a multiplying factor applied to the translation
vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with the concatenation of n copies of the original. Each
copy is equal to the previous one translated over a distance
<code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">*</span> <span class="pre">length(dir)</span></code> in the direction <code class="docutils literal notranslate"><span class="pre">dir</span></code>. The first of
the copies is equal to the original.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.rep" title="formex.Formex.rep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rep</span></code></a></dt><dd><p>short alias for replicate</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.repm" title="formex.Formex.repm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repm</span></code></a></dt><dd><p>replicate in multiple directions</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.replic2" title="formex.Formex.replic2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replic2</span></code></a></dt><dd><p>replicate in two directions with bias and taper</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replicate</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go"> Formex([[[0.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]],</span>

<span class="go">        [[0.,  1.,  0.],</span>
<span class="go">         [1.,  1.,  0.]],</span>

<span class="go">        [[0.,  2.,  0.],</span>
<span class="go">         [1.,  2.,  0.]],</span>

<span class="go">        [[0.,  3.,  0.],</span>
<span class="go">         [1.,  3.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.rep">
<code class="sig-name descname">rep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#formex.Formex.rep" title="Permalink to this definition">¶</a></dt>
<dd><p>Create copies at regular distances along a straight line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of copies to create</p></li>
<li><p><strong>dir</strong> (int (0,1,2) or float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The translation vector. If an int, it specifies a global axis
and the translation is in the direction of that axis.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – If <code class="docutils literal notranslate"><span class="pre">dir</span></code> is an int, this is the length of the translation.
Else, it is a multiplying factor applied to the translation
vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with the concatenation of n copies of the original. Each
copy is equal to the previous one translated over a distance
<code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">*</span> <span class="pre">length(dir)</span></code> in the direction <code class="docutils literal notranslate"><span class="pre">dir</span></code>. The first of
the copies is equal to the original.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.rep" title="formex.Formex.rep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rep</span></code></a></dt><dd><p>short alias for replicate</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.repm" title="formex.Formex.repm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repm</span></code></a></dt><dd><p>replicate in multiple directions</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.replic2" title="formex.Formex.replic2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replic2</span></code></a></dt><dd><p>replicate in two directions with bias and taper</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replicate</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go"> Formex([[[0.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]],</span>

<span class="go">        [[0.,  1.,  0.],</span>
<span class="go">         [1.,  1.,  0.]],</span>

<span class="go">        [[0.,  2.,  0.],</span>
<span class="go">         [1.,  2.,  0.]],</span>

<span class="go">        [[0.,  3.,  0.],</span>
<span class="go">         [1.,  3.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.repm">
<code class="sig-name descname">repm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">(0, 1, 2)</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">(1.0, 1.0, 1.0)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.repm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.repm" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeatedly replication in different directions</p>
<p>This repeatedly applies <a class="reference internal" href="#formex.Formex.replicate" title="formex.Formex.replicate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replicate()</span></code></a> a number of times.
The parameters are lists of values like those for replicate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>list of int</em>) – Number of copies to create in the subsequent replications.</p></li>
<li><p><strong>dir</strong> (list of int (0,1,2) or list of float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – Subsequent translation vectors. See <a class="reference internal" href="#formex.Formex.replicate" title="formex.Formex.replicate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replicate()</span></code></a>.</p></li>
<li><p><strong>step</strong> (<em>list of floats</em>) – The step for the subsequent replications.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with the concatenation of prod(n) copies of the original,
translated as specified by the dir and step parameters.
The first of the copies is equal to the original.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the parameter lists <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">dir</span></code>, <code class="docutils literal notranslate"><span class="pre">step</span></code> have different
lengths, the operation is executed only for the shortest of the
three.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.replicate" title="formex.Formex.replicate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replicate</span></code></a></dt><dd><p>replicate in a single direction</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.replic2" title="formex.Formex.replic2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replic2</span></code></a></dt><dd><p>replicate in two directions with bias and taper</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">repm</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Formex([[[0.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]],</span>

<span class="go">        [[0.,  1.,  0.],</span>
<span class="go">         [1.,  1.,  0.]],</span>

<span class="go">        [[0.,  0.,  1.],</span>
<span class="go">         [1.,  0.,  1.]],</span>

<span class="go">        [[0.,  1.,  1.],</span>
<span class="go">         [1.,  1.,  1.]]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">([</span><span class="n">origin</span><span class="p">()])</span><span class="o">.</span><span class="n">repm</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [0.0,1.0,0.0], [1.0,1.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.replic">
<code class="sig-name descname">replic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.replic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.replic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Formex with n replications in direction dir with step.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This works exactly like <a class="reference internal" href="#formex.Formex.replicate" title="formex.Formex.replicate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replicate()</span></code></a> but has another order
of the parameters. It is kept for historical reasons, but should
not be used in new code.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.replic2">
<code class="sig-name descname">replic2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n1</span></em>, <em class="sig-param"><span class="n">n2</span></em>, <em class="sig-param"><span class="n">t1</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">t2</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">d1</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">d2</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">taper</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.replic2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.replic2" title="Permalink to this definition">¶</a></dt>
<dd><p>Replicate in two directions with bias and taper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of replications in first direction</p></li>
<li><p><strong>n2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of replications in second direction</p></li>
<li><p><strong>t1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Step length in the first direction</p></li>
<li><p><strong>t2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Step length in the second direction</p></li>
<li><p><strong>d1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Global axis of the first direction</p></li>
<li><p><strong>d2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Global axis of the second direction</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Extra translation in direction d1 for each step in direction d2</p></li>
<li><p><strong>taper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Extra number of copies generated in direction d1 for each step
in direction d2</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If no bias nor taper is needed, the use of <a class="reference internal" href="#formex.Formex.repm" title="formex.Formex.repm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">repm()</span></code></a> is
recommended.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.replicate" title="formex.Formex.replicate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replicate</span></code></a></dt><dd><p>replicate in a single direction</p>
</dd>
<dt><a class="reference internal" href="#formex.Formex.repm" title="formex.Formex.repm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repm</span></code></a></dt><dd><p>replicate in multiple directions</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">([</span><span class="n">origin</span><span class="p">()])</span><span class="o">.</span><span class="n">replic2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [0.0,1.0,0.0], [1.0,1.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">([</span><span class="n">origin</span><span class="p">()])</span><span class="o">.</span><span class="n">replic2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">bias</span><span class="o">=</span><span class="mf">0.2</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [0.2,1.0,0.0], [1.2,1.0,0.0]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Formex</span><span class="p">([</span><span class="n">origin</span><span class="p">()])</span><span class="o">.</span><span class="n">replic2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">taper</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">{[0.0,0.0,0.0], [1.0,0.0,0.0], [0.0,1.0,0.0]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.replicm">
<code class="sig-name descname">replicm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">(1.0, 1.0, 1.0)</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">(0, 1, 2)</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.replicm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.replicm" title="Permalink to this definition">¶</a></dt>
<dd><p>Replicate in multiple global axis directions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This works exactly like <a class="reference internal" href="#formex.Formex.repm" title="formex.Formex.repm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">repm()</span></code></a> but has another order
of the parameters. It is kept for historical reasons, but should
not be used in new code.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.rosette">
<code class="sig-name descname">rosette</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">angle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">around</span><span class="o">=</span><span class="default_value">(0.0, 0.0, 0.0)</span></em>, <em class="sig-param"><span class="n">angle_spec</span><span class="o">=</span><span class="default_value">0.017453292519943295</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.rosette"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.rosette" title="Permalink to this definition">¶</a></dt>
<dd><p>Create rotational replications of a Formex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of copies to create</p></li>
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Angle in between successive copies. If not provided, it is set to
360 / n.</p></li>
<li><p><strong>axis</strong> (int (0,1,2) or float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The rotation axis. An int speficies one of the global axes.
Else, it is the direction vector of the axis.</p></li>
<li><p><strong>around</strong> (float <a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,), optional) – If provided, it species a point on the rotation axis. If not,
the rotation axis goes through the origin of the global axes.</p></li>
<li><p><strong>angle_spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>DEG</em><em> or </em><em>RAD</em><em>, </em><em>optional</em>) – The default (DEG) interpretes the angle in degrees. Use RAD to
specify the angle in radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with n rotational replications with given angular step.
The original Formex is the first of the n replicas.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rosette</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mf">90.</span><span class="p">)</span>
<span class="go">Formex([[[ 0.,  0.,  0.],</span>
<span class="go">         [ 1.,  0.,  0.]],</span>

<span class="go">        [[ 0.,  0.,  0.],</span>
<span class="go">         [ 0.,  1.,  0.]],</span>

<span class="go">        [[ 0.,  0.,  0.],</span>
<span class="go">         [-1.,  0.,  0.]],</span>

<span class="go">        [[ 0.,  0.,  0.],</span>
<span class="go">         [-0., -1.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rosette</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">90.</span><span class="p">,</span><span class="n">around</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">))</span>
<span class="go">Formex([[[ 0.,  0.,  0.],</span>
<span class="go">         [ 1.,  0.,  0.]],</span>

<span class="go">        [[ 1.,  1.,  0.],</span>
<span class="go">         [ 1.,  2.,  0.]],</span>

<span class="go">        [[ 0.,  2.,  0.],</span>
<span class="go">         [-1.,  2.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.extrude">
<code class="sig-name descname">extrude</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.extrude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.extrude" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrude a Formex along a straight line.</p>
<p>The Formex is extruded over a given length in the given direction.
This operates by converting the Formex to a <a class="reference internal" href="mesh.html#mesh.Mesh" title="mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>,
extruding the Mesh with the given parameters, and converting the
result back to a Formex.</p>
<p>Parameters: see <a class="reference internal" href="mesh.html#mesh.Mesh.extrude" title="mesh.Mesh.extrude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extrude()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Formex</em> – The Formex obtained by extruding the input Formex over the
given <cite>length</cite> in direction <cite>dir</cite>, subdividing this length according</p></li>
<li><p>to the seeds specified by <cite>dir</cite>. The plexitude of the result will be</p></li>
<li><p><em>double that of the input.</em></p></li>
<li><p>This method works by converting the Formex to a <a class="reference internal" href="mesh.html#mesh.Mesh" title="mesh.Mesh"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code></a>,</p></li>
<li><p>using the <code class="xref py py-func docutils literal notranslate"><span class="pre">Mesh.extrude()</span></code> and then converting the result</p></li>
<li><p><em>back to a Formex.</em></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.connect" title="formex.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect</span></code></a></dt><dd><p>create a higher plexitude Formex by connecting Formices</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="n">origin</span><span class="p">())</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Formex([[[0.  ,  0.  ,  0.  ],</span>
<span class="go">         [0.75,  0.  ,  0.  ]],</span>

<span class="go">        [[0.75,  0.  ,  0.  ],</span>
<span class="go">         [1.5 ,  0.  ,  0.  ]],</span>

<span class="go">        [[1.5 ,  0.  ,  0.  ],</span>
<span class="go">         [2.25,  0.  ,  0.  ]],</span>

<span class="go">        [[2.25,  0.  ,  0.  ],</span>
<span class="go">         [3.  ,  0.  ,  0.  ]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.interpolate">
<code class="sig-name descname">interpolate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">div</span></em>, <em class="sig-param"><span class="n">swap</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Create linear interpolations between two Formices.</p>
<p>A linear interpolation of two equally shaped Formices F and G at
parameter value t is an equally shaped Formex H where each coordinate
is obtained from:  Hijk = Fijk + t * (Gijk-Fijk).
Thus, a <code class="docutils literal notranslate"><span class="pre">F.interpolate(G,[0.,0.5,1.0])</span></code> will contain all elements
of F and G and all elements with mean coordinates between those of
F and G.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<a class="reference internal" href="#formex.Formex" title="formex.Formex"><em>Formex</em></a>) – A Formex with same shape as <cite>self</cite>.</p></li>
<li><p><strong>div</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> or </em><em>list of floats</em>) – <p>The list of parameter values for which to compute the
interpolation. Usually, they are in the range 0.0 (self)
to 1.0 (X). Values outside the range can be used however
and result in linear extrapolations.</p>
<p>If an int is provided, a list with <code class="docutils literal notranslate"><span class="pre">(div+1)</span></code> parameter
values is used, obtained by dividing the interval [0..1] into
<cite>div</cite> equal segments. Then, specifying <code class="docutils literal notranslate"><span class="pre">div=n</span></code> is equivalent
to specifying <code class="docutils literal notranslate"><span class="pre">div=np.arange(n+1)/float(n))</span></code>.</p>
</p></li>
<li><p><strong>swap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em>, </em><em>optional</em>) – If swap=True, the returned Formex will have the elements of
the interpolation Formices interleaved. The default is to
return a simple concatenation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex with the concatenation of all generated interpolations,
if swap is False (default). With swap=True, the elements of the
interpolations are interleaved: first all the first elements
from all the interpolations, then all the second elements, etc.
The elements inherit the property numbers from self, if any.
The Formex has the same eltype as self, if it is set.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="coords.html#coords.Coords.interpolate" title="coords.Coords.interpolate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coords.Coords.interpolate</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>See also example Interpolate.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">div</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Formex([[[0. ,  0. ,  0. ],</span>
<span class="go">         [1. ,  0. ,  0. ]],</span>

<span class="go">        [[0.5,  0.5,  0. ],</span>
<span class="go">         [2. ,  1. ,  0. ]],</span>

<span class="go">        [[1. ,  1. ,  0. ],</span>
<span class="go">         [3. ,  2. ,  0. ]],</span>

<span class="go">        [[1.5,  1.5,  0. ],</span>
<span class="go">         [4. ,  3. ,  0. ]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],[[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">([[[</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],[[</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">div</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Formex([[[0. ,  0. ,  0. ]],</span>

<span class="go">        [[1. ,  0. ,  0. ]],</span>

<span class="go">        [[0.5,  0.5,  0. ]],</span>

<span class="go">        [[2. ,  1. ,  0. ]],</span>

<span class="go">        [[1. ,  1. ,  0. ]],</span>

<span class="go">        [[3. ,  2. ,  0. ]],</span>

<span class="go">        [[1.5,  1.5,  0. ]],</span>

<span class="go">        [[4. ,  3. ,  0. ]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">div</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">swap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Formex([[[0. ,  0. ,  0. ]],</span>

<span class="go">        [[0.5,  0.5,  0. ]],</span>

<span class="go">        [[1. ,  1. ,  0. ]],</span>

<span class="go">        [[1.5,  1.5,  0. ]],</span>

<span class="go">        [[1. ,  0. ,  0. ]],</span>

<span class="go">        [[2. ,  1. ,  0. ]],</span>

<span class="go">        [[3. ,  2. ,  0. ]],</span>

<span class="go">        [[4. ,  3. ,  0. ]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.subdivide">
<code class="sig-name descname">subdivide</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">div</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.subdivide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.subdivide" title="Permalink to this definition">¶</a></dt>
<dd><p>Subdivide a plex-2 Formex at the parameter values in div.</p>
<p>Replaces each element of the plex-2 Formex (line segments) by
a sequence of elementsobtained by subdividing the Formex
at the specified parameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>div</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> or </em><em>list of floats</em>) – <p>The list of parameter values at which to subdivide the elements.
Usually, they are in the range 0.0 to 1.0.</p>
<p>If an int is provided, a list with <code class="docutils literal notranslate"><span class="pre">(div+1)</span></code> parameter
values is used, obtained by dividing the interval [0..1] into
<cite>div</cite> equal segments. Thus, specifying <code class="docutils literal notranslate"><span class="pre">div=n</span></code> is equivalent
to specifying <code class="docutils literal notranslate"><span class="pre">div=np.arange(n+1)/float(n))</span></code>.</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Formex([[[0.  ,  0.  ,  0.  ],</span>
<span class="go">         [0.25,  0.  ,  0.  ]],</span>

<span class="go">        [[0.25,  0.  ,  0.  ],</span>
<span class="go">         [0.5 ,  0.  ,  0.  ]],</span>

<span class="go">        [[0.5 ,  0.  ,  0.  ],</span>
<span class="go">         [0.75,  0.  ,  0.  ]],</span>

<span class="go">        [[0.75,  0.  ,  0.  ],</span>
<span class="go">         [1.  ,  0.  ,  0.  ]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">1.1</span><span class="p">])</span>
<span class="go">Formex([[[-0.1,  0. ,  0. ],</span>
<span class="go">         [ 0.3,  0. ,  0. ]],</span>

<span class="go">        [[ 0.3,  0. ,  0. ],</span>
<span class="go">         [ 0.7,  0. ,  0. ]],</span>

<span class="go">        [[ 0.7,  0. ,  0. ],</span>
<span class="go">         [ 1.1,  0. ,  0. ]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.intersectionWithPlane">
<code class="sig-name descname">intersectionWithPlane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.intersectionWithPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.intersectionWithPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the intersection of a Formex with a plane.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is currently only available for plexitude 2 (lines) and
3 (triangles).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – A point in the plane</p></li>
<li><p><strong>n</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The normal vector on the plane.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – A tolerance value: points whose distance from the plane is less
than <code class="docutils literal notranslate"><span class="pre">atol</span></code> are considered to be lying in the plane.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex of plexitude self.nplex()-1 holding the intersection
with the plane (p,n). For a plex-2 Formex (lines), the returned
Formex has plexitude 1 (points). For a plex-3 Formex
(triangles) the returned Formex has plexitude 2 (lines).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.cutWithPlane" title="formex.Formex.cutWithPlane"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cutWithPlane</span></code></a></dt><dd><p>return parts of Formex after cutting with a plane</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:1212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">intersectionWithPlane</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
<span class="go">Formex([[[0.5,  0. ,  0. ]],</span>

<span class="go">       [[1. ,  0.5,  0. ]],</span>

<span class="go">       [[1.5,  1. ,  0. ]],</span>

<span class="go">       [[2. ,  1.5,  0. ]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">intersectionWithPlane</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
<span class="go">Formex([[[0.5,  0. ,  0. ],</span>
<span class="go">        [0.5,  0.5,  0. ]],</span>

<span class="go">       [[0.5,  0.5,  0. ],</span>
<span class="go">        [0.5,  1. ,  0. ]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.cutWithPlane">
<code class="sig-name descname">cutWithPlane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">side</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">newprops</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.cutWithPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.cutWithPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut a Formex with the plane (p,n).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is currently only available for plexitude 2 (lines) and
3 (triangles).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – A point in the cutting plane.</p></li>
<li><p><strong>n</strong> (<a class="reference internal" href="../glossary.html#term-array_like"><span class="xref std std-term">array_like</span></a> (3,)) – The normal vector to the cutting plane.</p></li>
<li><p><strong>side</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>one of ''</em><em>, </em><em>'+'</em><em> or </em><em>'-'</em>) – Specifies which side of the plane should be returned.
If an empty string (default), both sides are returned.
If ‘+’ or ‘-‘, only the part at the positive, resp. negative
side of the plane (as defined by its normal) is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Fpos</strong> (<em>Formex</em>) – Formex with the part of the Formex at the positive side of the plane.
This part is not returned if side==’-‘.</p></li>
<li><p><strong>Fneg</strong> (<em>Formex</em>) – Formex with the part of the Formex at the negative side of the plane.
This part is not returned if side==’+’.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Elements of the input Formex that are lying completely on one side
of the plane will return unaltered. Elements that are cut by the
plane are split up into multiple parts.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#formex.Formex.intersectionWithPlane" title="formex.Formex.intersectionWithPlane"><code class="xref py py-obj docutils literal notranslate"><span class="pre">intersectionWithPlane</span></code></a></dt><dd><p>return intersection of Formex and plane</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.lengths">
<code class="sig-name descname">lengths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the length of all elements of a 2-plex Formex.</p>
<p>The length of an element is the distance between its two points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>float array (self.nelem(),)</em> – An array with the length of each element.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the Formex is not of plexitude 2.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:127&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths</span><span class="p">()</span>
<span class="go">array([1.    , 1.    , 1.4142])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.areas">
<code class="sig-name descname">areas</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.areas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.areas" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the areas of all elements of a 3-plex Formex.</p>
<p>The area of an element is the area of the triangle formed by its
three points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>float array (self.nelem(),)</em> – An array with the area of each element.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the Formex is not of plexitude 3.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;3:.12.34&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">areas</span><span class="p">()</span>
<span class="go">array([0.5,  0.5])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.volumes">
<code class="sig-name descname">volumes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.volumes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.volumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the volume of all elements of a 4-plex Formex.</p>
<p>The volume of an element is the volume of the tetraeder formed
by its 4 points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>float array (self.nelem(),)</em> – An array with the volume of each element.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the Formex is not of plexitude 4.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;4:164I&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">volumes</span><span class="p">()</span>
<span class="go">array([0.1667])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.fromstring">
<em class="property">classmethod </em><code class="sig-name descname">fromstring</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">' '</span></em>, <em class="sig-param"><span class="n">nplex</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">ndim</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">count</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.fromstring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.fromstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#formex.Formex" title="formex.Formex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Formex</span></code></a> reading coordinates from a string.</p>
<p>This uses the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Coords.fromstring()</span></code> method to read coordinates
from a string and restructures them into a Formex of the specified
plexitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – A string containing a single sequence of float numbers separated
by whitespace and a possible separator string.</p></li>
<li><p><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – The separator used between the coordinates. If not a space,
all extra whitespace is ignored.</p></li>
<li><p><strong>nplex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – Plexitude of the elements to be read.</p></li>
<li><p><strong>ndim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – Number of coordinates per point. Should be 1, 2 or 3 (default).
If 1, resp. 2, the coordinate string only holds x, resp. x,y
values.</p></li>
<li><p><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – Total number of coordinates to read. This should be a multiple
of <cite>ndim</cite>. The default is to read all the coordinates in the
string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex object of the given plexitude, with the coordinates
read from the string.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If count was provided and the string does not contain that exact
    number of coordinates.
    If the number of points read is not a multiple of nplex.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Formex</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;4 0 0 3 1 2 6 5 7&#39;</span><span class="p">,</span><span class="n">nplex</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Formex([[[4.,  0.,  0.],</span>
<span class="go">        [3.,  1.,  2.],</span>
<span class="go">        [6.,  5.,  7.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.fromfile">
<em class="property">classmethod </em><code class="sig-name descname">fromfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fil</span></em>, <em class="sig-param"><span class="n">nplex</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.fromfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.fromfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the coordinates of a Formex from a file</p>
<p>This uses <code class="xref py py-meth docutils literal notranslate"><span class="pre">Coords.fromfile()</span></code> to read coordinates from a file
and create a Formex of the specified plexitude.
Coordinates X, Y and Z for subsequent points
are read from the file. The total number of coordinates on the file
should be a multiple of 3.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fil</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><em>file</em>) – If str, it is a file name. An open file object can also be passed</p></li>
<li><p><strong>nplex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – Plexitude of the elements to be read.</p></li>
<li><p><strong>**kargs</strong> – Arguments to be passed to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.fromfile.html#numpy.fromfile" title="(in NumPy v1.24)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.fromfile()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>Formex</em> – A Formex object of the given plexitude, with the coordinates
read from the specified file.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a> – If the number of coordinates read is not a multiple of 3 * nplex.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Coords.fromfile</span></code></dt><dd><p>read a Coords object from file</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.fromfile.html#numpy.fromfile" title="(in NumPy v1.24)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.fromfile</span></code></a></dt><dd><p>read an array to file</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="formex.Formex.pzf_dict">
<code class="sig-name descname">pzf_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#Formex.pzf_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.Formex.pzf_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct common part of all Geometry pzf dicts</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions-defined-in-module-formex">
<h2><span class="section-number">2.2. </span>Functions defined in module formex<a class="headerlink" href="#functions-defined-in-module-formex" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="formex.connect">
<code class="sig-prename descclassname">formex.</code><code class="sig-name descname">connect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Flist</span></em>, <em class="sig-param"><span class="n">nodid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">eltype</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/formex.html#connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#formex.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Formex which connects the Formices in list.</p>
<p>Creates a Formex of any plexitude by combining corresponding
points from a number of Formices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Flist</strong> (<em>list of Formices</em>) – The Formices to connect. The number of Formices in the list will
be the plexitude of the newly created Formex. One point of an element
in each Formex is taken to create a new element in the output Formex.</p></li>
<li><p><strong>nodid</strong> (<em>list of int</em><em>, </em><em>optional</em>) – List of point indices to be used from each of the input Formices.
If provided, the list should have the same length as <code class="docutils literal notranslate"><span class="pre">Flist</span></code>.
The default is to use the first point of each element.</p></li>
<li><p><strong>bias</strong> (<em>list of int</em><em>, </em><em>optional</em>) – List of element bias values for each of the input Formices. Element
iteration in the Formices will start at this number.
If provided,, the list should have the same length as <code class="docutils literal notranslate"><span class="pre">Flist</span></code>.
The default is to start at element 0.</p></li>
<li><p><strong>loop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If False (default), element generation will stop when the first
input Formex runs out of elements. If True, element iteration in the
shorted Formices will wrap around until all elements in all
Formices have been used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>Formex</em> – A Formex with plexitude equal to <code class="docutils literal notranslate"><span class="pre">len(Flist)</span></code>.
Each element of the Formex consists of a point from the corresponding
element of each of the Formices in list. By default
this is the first point of that element, but a <code class="docutils literal notranslate"><span class="pre">nodid</span></code> list may
specify another point index.
Corresponding elements in the Formices are by default those with the
same element index; the <code class="docutils literal notranslate"><span class="pre">bias</span></code> argument may specify another value
to start the element indexing for each of the input Formices.</p>
<p>If loop is False (default), the number of elements is the minimum
over all Formices of the number of elements minus the corresponding
bias. If loop is True, the number of elements is the maximum of the
number of elements of all input Formices.</p>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See also example Connect.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;1:1111&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Formex</span><span class="p">(</span><span class="s1">&#39;l:222&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">])</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">         [0.,  0.,  0.]],</span>

<span class="go">        [[2.,  0.,  0.],</span>
<span class="go">         [0.,  1.,  0.]],</span>

<span class="go">        [[3.,  0.,  0.],</span>
<span class="go">         [0.,  2.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">],</span><span class="n">nodid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">         [0.,  1.,  0.]],</span>

<span class="go">        [[2.,  0.,  0.],</span>
<span class="go">         [0.,  2.,  0.]],</span>

<span class="go">        [[3.,  0.,  0.],</span>
<span class="go">         [0.,  3.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">F</span><span class="p">],</span><span class="n">bias</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">         [2.,  0.,  0.]],</span>

<span class="go">        [[2.,  0.,  0.],</span>
<span class="go">         [3.,  0.,  0.]],</span>

<span class="go">        [[3.,  0.,  0.],</span>
<span class="go">         [4.,  0.,  0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connect</span><span class="p">([</span><span class="n">F</span><span class="p">,</span><span class="n">F</span><span class="p">],</span><span class="n">bias</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">loop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Formex([[[1.,  0.,  0.],</span>
<span class="go">         [2.,  0.,  0.]],</span>

<span class="go">        [[2.,  0.,  0.],</span>
<span class="go">         [3.,  0.,  0.]],</span>

<span class="go">        [[3.,  0.,  0.],</span>
<span class="go">         [4.,  0.,  0.]],</span>

<span class="go">        [[4.,  0.,  0.],</span>
<span class="go">         [1.,  0.,  0.]]])</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mesh.html" title="3. mesh — Finite element meshes in pyFormex."
             >next</a> |</li>
        <li class="right" >
          <a href="coords.html" title="1. coords — A structured collection of 3D coordinates."
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../refman.html" >pyFormex reference manual</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href=""><span class="section-number">2. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">formex</span></code> — Formex algebra in Python</a></li--> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2023, Benedict Verhegghe.
    </span>
      Last updated on Mar 27, 2023.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.3.
    </span>
    </div>
  </body>
</html>