

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>plugins.properties &#8212; pyFormex 3.3 documentation</title>

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pyformex.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="icon" type="image/png" href="../../_static/pyformex_fav.png" />

  </head><body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="../../_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="../../_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href="">plugins.properties</a></li--> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_SIDEBAR_LOGO -->
<!-- PYFORMEX_WEBSITE_SIDEBAR_TOP -->

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for plugins.properties</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">##  SPDX-FileCopyrightText: Â© 2007-2023 Benedict Verhegghe &lt;bverheg@gmail.com&gt;</span>
<span class="c1">##  SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="c1">##</span>
<span class="c1">##  This file is part of pyFormex 3.3  (Sun Mar 26 20:16:15 CEST 2023)</span>
<span class="c1">##  pyFormex is a tool for generating, manipulating and transforming 3D</span>
<span class="c1">##  geometrical models by sequences of mathematical operations.</span>
<span class="c1">##  Home page: https://pyformex.org</span>
<span class="c1">##  Project page: https://savannah.nongnu.org/projects/pyformex/</span>
<span class="c1">##  Development: https://gitlab.com/bverheg/pyformex</span>
<span class="c1">##  Distributed under the GNU General Public License version 3 or later.</span>
<span class="c1">##</span>
<span class="c1">##  This program is free software: you can redistribute it and/or modify</span>
<span class="c1">##  it under the terms of the GNU General Public License as published by</span>
<span class="c1">##  the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">##  (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1">##  This program is distributed in the hope that it will be useful,</span>
<span class="c1">##  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">##  GNU General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1">##  You should have received a copy of the GNU General Public License</span>
<span class="c1">##  along with this program.  If not, see http://www.gnu.org/licenses/.</span>
<span class="c1">##</span>
<span class="sd">&quot;&quot;&quot;General framework for attributing properties to geometrical elements.</span>

<span class="sd">Properties can really be just about any Python object.</span>
<span class="sd">Properties can be attributed to a set of geometrical elements.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">pyformex</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="kn">from</span> <span class="nn">pyformex</span> <span class="kn">import</span> <span class="n">arraytools</span> <span class="k">as</span> <span class="n">at</span>
<span class="kn">from</span> <span class="nn">pyformex</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">pyformex.database</span> <span class="kn">import</span> <span class="n">Record</span><span class="p">,</span> <span class="n">Database</span>
<span class="kn">from</span> <span class="nn">pyformex.mydict</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">CDict</span>


<span class="c1"># global materials and section Databases</span>
<span class="n">_matDB</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">_secDB</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1">#################################################################</span>
<span class="c1"># Container classes used inside PropertyDB</span>

<div class="viewcode-block" id="MaterialDB"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.MaterialDB">[docs]</a><span class="k">class</span> <span class="nc">MaterialDB</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class for storing material properties.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: dict | str, optional</span>
<span class="sd">        If a dict, it contains the Database. If a string, it is the filename</span>
<span class="sd">        containing the Database. If an empty string, the configured materials</span>
<span class="sd">        database file is loaded. If not provided, an empty Database is created.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; matDB = MaterialDB(&#39;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(matDB)</span>
<span class="sd">    {</span>
<span class="sd">        &quot;steel&quot;: {</span>
<span class="sd">            &quot;name&quot;: &quot;steel&quot;,</span>
<span class="sd">            &quot;young_modulus&quot;: 207000.0,</span>
<span class="sd">            &quot;poisson_ratio&quot;: 0.3,</span>
<span class="sd">            &quot;density&quot;: 7.85e-09</span>
<span class="sd">        },</span>
<span class="sd">    ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the database.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;prop/matdb&#39;</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span> <span class="c1">#, record=Dict)</span></div>


<div class="viewcode-block" id="SectionDB"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.SectionDB">[docs]</a><span class="k">class</span> <span class="nc">SectionDB</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class for storing section properties</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: dict | str, optional</span>
<span class="sd">        If a dict, it contains the Database. If a string, it is the filename</span>
<span class="sd">        containing the Database. If an empty string, the configured materials</span>
<span class="sd">        database file is loaded. If not provided, an empty Database is created.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; secDB = SectionDB(&#39;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(secDB)</span>
<span class="sd">    {</span>
<span class="sd">        &quot;kokerre&quot;: {</span>
<span class="sd">            &quot;name&quot;: &quot;kokerre&quot;,</span>
<span class="sd">            &quot;cross_section&quot;: 500,</span>
<span class="sd">            &quot;moment_inertia_11&quot;: 1256,</span>
<span class="sd">            &quot;moment_inertia_12&quot;: 695,</span>
<span class="sd">            &quot;moment_inertia_22&quot;: 365499,</span>
<span class="sd">            &quot;torsional_rigidity&quot;: 635256</span>
<span class="sd">        },</span>
<span class="sd">    ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the database.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;prop/secdb&#39;</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">CDict</span><span class="p">)</span></div>


<span class="c1">#################################################################</span>
<span class="c1"># Object classes used inside PropertyDB</span>

<div class="viewcode-block" id="ElemSection"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.ElemSection">[docs]</a><span class="k">class</span> <span class="nc">ElemSection</span><span class="p">(</span><span class="n">CDict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Properties related to the section of an element.</span>

<span class="sd">    An element section property can hold the following sub-properties:</span>

<span class="sd">    section</span>
<span class="sd">      the geometric properties of the section. This can be a dict</span>
<span class="sd">      or a string. If it is a string, its value is looked up in the global</span>
<span class="sd">      section database. The section dict should at least have a key</span>
<span class="sd">      &#39;sectiontype&#39;, defining the type of section.</span>

<span class="sd">      Currently the following sectiontype values are known by module</span>
<span class="sd">      :mod:`fe_abq` for export to Abaqus/Calculix:</span>

<span class="sd">        - &#39;solid&#39;   : a solid 2D or 3D section,</span>
<span class="sd">        - &#39;circ&#39;    : a plain circular section,</span>
<span class="sd">        - &#39;rect&#39;    : a plain rectangular section,</span>
<span class="sd">        - &#39;pipe&#39;    : a hollow circular section,</span>
<span class="sd">        - &#39;box&#39;     : a hollow rectangular section,</span>
<span class="sd">        - &#39;I&#39;       : an I-beam,</span>
<span class="sd">        - &#39;general&#39; : anything else (automatically set if not specified).</span>
<span class="sd">        - &#39;rigid&#39;   : a rigid body</span>

<span class="sd">      .. note: Currently only &#39;solid&#39;, &#39;general&#39; and &#39;rigid&#39; are allowed.</span>

<span class="sd">      The other possible (useful) keys in the section dict depend on the</span>
<span class="sd">      sectiontype. Again for :mod:`fe_abq`:</span>

<span class="sd">        - for sectiontype &#39;solid&#39; : thickness</span>
<span class="sd">        - the sectiontype &#39;general&#39;: cross_section, moment_inertia_11,</span>
<span class="sd">          moment_inertia_12, moment_inertia_22, torsional_constant</span>
<span class="sd">        - for sectiontype &#39;circ&#39;: radius</span>
<span class="sd">        - for sectiontype &#39;rigid&#39;: refnode, density, thickness</span>

<span class="sd">    material</span>
<span class="sd">      the element material. This can be a dict or a string.</span>
<span class="sd">      Currently known keys to fe_abq.py are: young_modulus,</span>
<span class="sd">      shear_modulus, density, poisson_ratio . (see fmtMaterial in fe_abq)</span>
<span class="sd">      It should not be specified for rigid sections.</span>

<span class="sd">    orientation</span>
<span class="sd">      - a Dict, or</span>
<span class="sd">      - a list of 3 direction cosines of the first beam section axis.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new element section property. Empty by default.&quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">_matDB</span><span class="p">,</span> <span class="n">_secDB</span>
        <span class="k">if</span> <span class="n">_matDB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_matDB</span> <span class="o">=</span> <span class="n">MaterialDB</span><span class="p">({})</span>
        <span class="k">if</span> <span class="n">_secDB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_secDB</span> <span class="o">=</span> <span class="n">SectionDB</span><span class="p">({})</span>
        <span class="c1"># Add default &#39;extra&#39; and &#39;options&#39; attributes to avoid</span>
        <span class="c1"># cascading into the material.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extra</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">CDict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">material</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addMaterial</span><span class="p">(</span><span class="n">material</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span>

<div class="viewcode-block" id="ElemSection.addMaterial"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.ElemSection.addMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">addMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">material</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create or replace the material properties of the element.</span>

<span class="sd">        If the argument is a dict, it will be added to the global MaterialDB.</span>
<span class="sd">        If the argument is a string, this string will be used as a key to</span>
<span class="sd">        search in the global MaterialDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">material</span> <span class="ow">in</span> <span class="n">_matDB</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="n">_matDB</span><span class="p">[</span><span class="n">material</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pf</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Material &#39;</span><span class="si">%s</span><span class="s2">&#39;  is not in the database&quot;</span> <span class="o">%</span> <span class="n">material</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">_matDB</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">material</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="n">_matDB</span><span class="p">[</span><span class="n">material</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a string or a dict&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElemSection.addSection"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.ElemSection.addSection">[docs]</a>    <span class="k">def</span> <span class="nf">addSection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create or replace the section properties of the element.</span>

<span class="sd">        If &#39;section&#39; is a dict, it will be added to the global SectionDB.</span>
<span class="sd">        If &#39;section&#39; is a string, this string will be used as a key to</span>
<span class="sd">        search in the global SectionDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">_secDB</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">_secDB</span><span class="p">[</span><span class="n">section</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pf</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Section &#39;</span><span class="si">%s</span><span class="s2">&#39; is not in the database&quot;</span> <span class="o">%</span> <span class="n">section</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># TODO: WE COULD ADD AUTOMATIC CALCULATION OF SECTION PROPERTIES</span>
            <span class="c1"># self.computeSection(section)</span>
            <span class="c1"># print(section)</span>
            <span class="n">_secDB</span><span class="p">[</span><span class="n">section</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">CDict</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">_secDB</span><span class="p">[</span><span class="n">section</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a string or a dict&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElemSection.computeSection"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.ElemSection.computeSection">[docs]</a>    <span class="k">def</span> <span class="nf">computeSection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the section characteristics of specific sections.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;sectiontype&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">section</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">section</span><span class="p">[</span><span class="s1">&#39;sectiontype&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;circ&#39;</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">section</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">4</span>      <span class="c1"># noqa: E741</span>
            <span class="n">section</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cross_section&#39;</span><span class="p">:</span> <span class="n">A</span><span class="p">,</span>
                            <span class="s1">&#39;moment_inertia_11&#39;</span><span class="p">:</span> <span class="n">I</span><span class="p">,</span>
                            <span class="s1">&#39;moment_inertia_22&#39;</span><span class="p">:</span> <span class="n">I</span><span class="p">,</span>
                            <span class="s1">&#39;moment_inertia_12&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                            <span class="s1">&#39;torsional_constant&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>
                            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid sectiontype&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ElemLoad"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.ElemLoad">[docs]</a><span class="k">class</span> <span class="nc">ElemLoad</span><span class="p">(</span><span class="n">CDict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Distributed loading on an element.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new element load. Empty by default.</span>

<span class="sd">        An element load can hold the following sub-properties:</span>

<span class="sd">        - label: the distributed load type label</span>
<span class="sd">        - value: the magnitude of the distibuted load</span>
<span class="sd">        - dir: vector specifying the direction of the load</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;GRAV&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">dir</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">9.81</span>
        <span class="n">Dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s1">&#39;dir&#39;</span><span class="p">:</span> <span class="nb">dir</span><span class="p">})</span></div>


<div class="viewcode-block" id="EdgeLoad"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.EdgeLoad">[docs]</a><span class="k">class</span> <span class="nc">EdgeLoad</span><span class="p">(</span><span class="n">CDict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Distributed loading on an element edge.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new element edge load. Empty by default.</span>

<span class="sd">        An element edgeload can hold the following sub-properties:</span>
<span class="sd">        - edge: the element edge number</span>
<span class="sd">        - label: the distributed load type label (&#39;x&#39;,&#39;y&#39;,&#39;z&#39;).</span>
<span class="sd">        - value: the magnitude of the distibuted load.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;edge&#39;</span><span class="p">:</span> <span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span></div>


<div class="viewcode-block" id="CoordSystem"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.CoordSystem">[docs]</a><span class="k">class</span> <span class="nc">CoordSystem</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;A class for storing coordinate systems.&quot;&quot;&quot;</span>

    <span class="n">valid_csys</span> <span class="o">=</span> <span class="s1">&#39;RSC&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csys</span><span class="p">,</span> <span class="n">cdata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new coordinate system.</span>

<span class="sd">        csys is one of &#39;Rectangular&#39;, &#39;Spherical&#39;, &#39;Cylindrical&#39;. Case is</span>
<span class="sd">          ignored and the first letter suffices.</span>
<span class="sd">        cdata is a list of 6 coordinates specifying the two points that</span>
<span class="sd">          determine the coordinate transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">csys</span> <span class="o">=</span> <span class="n">csys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">csys</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CoordSystem</span><span class="o">.</span><span class="n">valid_csys</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cdata</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cdata</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid initialization data for CoordSystem&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sys</span> <span class="o">=</span> <span class="n">csys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">cdata</span></div>


<div class="viewcode-block" id="Amplitude"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.Amplitude">[docs]</a><span class="k">class</span> <span class="nc">Amplitude</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;A class for storing an amplitude.</span>

<span class="sd">    The amplitude is a list of tuples (time,value).</span>

<span class="sd">    `atime` (amplitude time) can be either STEP TIME (default in Abaqus)</span>
<span class="sd">    or TOTAL TIME</span>

<span class="sd">    `smoothing` (optional) is a float (from 0. to 0.5, suggested value 0.05)</span>
<span class="sd">    representing the fraction of the time interval before and after each time</span>
<span class="sd">    point during which the piecewise linear time variation will be replaced by</span>
<span class="sd">    a smooth quadratic time variation (avoiding infinite accelerations).</span>
<span class="sd">    Smoothing should be used in combination with TABULAR (set 0.05 as default</span>
<span class="sd">    value?)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">definition</span><span class="o">=</span><span class="s1">&#39;TABULAR&#39;</span><span class="p">,</span> <span class="n">atime</span><span class="o">=</span><span class="s1">&#39;STEP TIME&#39;</span><span class="p">,</span>
                 <span class="n">smoothing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new amplitude.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">definition</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TABULAR&#39;</span><span class="p">,</span> <span class="s1">&#39;SMOOTH STEP&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">atime</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;STEP TIME&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTAL TIME&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">checkArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">definition</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atime</span> <span class="o">=</span> <span class="n">atime</span>
                <span class="k">if</span> <span class="n">definition</span> <span class="o">==</span> <span class="s1">&#39;TABULAR&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">smoothing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, SMOOTHING=</span><span class="si">{</span><span class="n">smoothing</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected definition = &#39;TABULAR&#39; or &#39;SMOOTH STEP&#39;&quot;</span><span class="p">)</span></div>


<span class="c1">###################################################</span>
<span class="c1"># Utility routines</span>


<div class="viewcode-block" id="checkIdValue"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.checkIdValue">[docs]</a><span class="k">def</span> <span class="nf">checkIdValue</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check that a variable is a list of (id,value) tuples</span>

<span class="sd">    `id` should be convertible to an int, value to a float.</span>
<span class="sd">    If ok, return the values as a list of (int,float) tuples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">lv</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">lv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">lv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected a list of (int,float) tuples&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="checkArrayOrIdValue"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.checkArrayOrIdValue">[docs]</a><span class="k">def</span> <span class="nf">checkArrayOrIdValue</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check that a variable is a list of values or (id,value) tuples</span>

<span class="sd">    This convenience function checks that the argument is either:</span>

<span class="sd">    - a list of 6 float values (or convertible to it), or</span>
<span class="sd">    - a list of (id,value) tuples where id is convertible to an int,</span>
<span class="sd">      value to a float.</span>

<span class="sd">    If ok, return the values as a list of (int,float) tuples.</span>

<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValue([0,3,4,0,0,0])</span>
<span class="sd">      [(1, 3.0), (2, 4.0)]</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValue([(1,3.0),(2,4.0)])</span>
<span class="sd">      [(1, 3.0), (2, 4.0)]</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValue([(0,1.0),(2,4.0),(3,5.0),(4,4),(5,3.0),(1,4.0)])</span>
<span class="sd">      [(0, 1.0), (2, 4.0), (3, 5.0), (4, 4.0), (5, 3.0), (1, 4.0)]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">checkArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">v</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">w</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">checkIdValue</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></div>


<div class="viewcode-block" id="checkArrayOrIdValueOrEmpty"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.checkArrayOrIdValueOrEmpty">[docs]</a><span class="k">def</span> <span class="nf">checkArrayOrIdValueOrEmpty</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check that a variable is a list of values or (id,value) tuples or empty.</span>

<span class="sd">    This convenience function checks that the argument is either:</span>

<span class="sd">    - a list of 6 float values (or convertible to it), or</span>
<span class="sd">    - a list of (id,value) tuples where id is convertible to an int,</span>
<span class="sd">      value to a float.</span>
<span class="sd">    - something representing an empty list</span>

<span class="sd">    If ok, return the values as a list of (int,float) tuples.</span>

<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValueOrEmpty([0,3,4,0,0,0])</span>
<span class="sd">      [(1, 3.0), (2, 4.0)]</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValueOrEmpty([(1,3.0),(2,4.0)])</span>
<span class="sd">      [(1, 3.0), (2, 4.0)]</span>
<span class="sd">      &gt;&gt;&gt; checkArrayOrIdValueOrEmpty([])</span>
<span class="sd">      []</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">checkArrayOrIdValue</span><span class="p">(</span><span class="n">values</span><span class="p">)</span></div>


<div class="viewcode-block" id="checkString"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.checkString">[docs]</a><span class="k">def</span> <span class="nf">checkString</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">valid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check that a string a has one of the valid values.</span>

<span class="sd">    This is case insensitive, and returns the upper case string if valid.</span>
<span class="sd">    Else, an error is raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Expected one of </span><span class="si">%s</span><span class="s2">, got: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valid</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="k">raise</span> <span class="ne">ValueError</span></div>


<span class="c1">####################################################</span>
<span class="c1"># Create automatic names for node and element sets</span>


<span class="k">def</span> <span class="nf">autoName</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">base</span> <span class="o">+</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span> <span class="o">%</span> <span class="n">args</span>


<span class="c1"># The following are not used by the PropertyDB class,</span>
<span class="c1"># but may be convenient for the user in applications</span>

<span class="n">Nset_prefix</span> <span class="o">=</span> <span class="s1">&#39;Nset&#39;</span>
<span class="n">Eset_prefix</span> <span class="o">=</span> <span class="s1">&#39;Eset&#39;</span>


<span class="k">def</span> <span class="nf">Nset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">autoName</span><span class="p">(</span><span class="n">Nset_prefix</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">Eset</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">autoName</span><span class="p">(</span><span class="n">Eset_prefix</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>


<div class="viewcode-block" id="FindListItem"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.FindListItem">[docs]</a><span class="k">def</span> <span class="nf">FindListItem</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find the item p in the list l.</span>

<span class="sd">    If p is an item in the list (not a copy of it!), this returns</span>
<span class="sd">    its position. Else, -1 is returned.</span>

<span class="sd">    Matches are found with a &#39;is&#39; function, not an &#39;==&#39;.</span>
<span class="sd">    Only the first match will be reported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="ow">is</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="RemoveListItem"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.RemoveListItem">[docs]</a><span class="k">def</span> <span class="nf">RemoveListItem</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove the item p from the list l.</span>

<span class="sd">    If p is an item in the list (not a copy of it!), it is removed from</span>
<span class="sd">    the list.</span>
<span class="sd">    Matches are found with a &#39;is&#39; comparison. This is different from the</span>
<span class="sd">    normal Python list.remove() method, which uses &#39;==&#39;.</span>
<span class="sd">    As a result, we can find complex objects which do not allow &#39;==&#39;,</span>
<span class="sd">    such as ndarrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">FindListItem</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>


<span class="c1">#############################################################</span>
<span class="c1"># Properties Database</span>

<div class="viewcode-block" id="PropertyDB"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB">[docs]</a><span class="k">class</span> <span class="nc">PropertyDB</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;A database class for all properties.</span>

<span class="sd">    This class collects all properties that can be set on a</span>
<span class="sd">    geometrical model.</span>

<span class="sd">    This should allow for storing:</span>

<span class="sd">    - materials</span>
<span class="sd">    - sections</span>
<span class="sd">    - any properties</span>
<span class="sd">    - node properties</span>
<span class="sd">    - elem properties</span>
<span class="sd">    - model properties (current unused: use unnamed properties)</span>

<span class="sd">    Materials and sections use their own database for storing. They can be</span>
<span class="sd">    specified on creating the property database.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    matdb: :class:`MaterialDB`</span>
<span class="sd">        The material database to be used. It can be a MaterialDB object,</span>
<span class="sd">        or data to initialize it: a dict with the database contents, or a</span>
<span class="sd">        filename where the MaterialDB can be read. The default empty string</span>
<span class="sd">        will read the configured material database file. Specifying None</span>
<span class="sd">        creates an empty MaterialDB.</span>
<span class="sd">    secdb: :class:`SectionDB`</span>
<span class="sd">        The section database to be used. It can be a SectionDB object,</span>
<span class="sd">        or data to initialize it: a dict with the database contents, or a</span>
<span class="sd">        filename where the SectionDB can be read. The default empty string</span>
<span class="sd">        will read the configured section database file. Specifying None</span>
<span class="sd">        creates an empty SectionMaterialDB.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bound_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;XSYMM&#39;</span><span class="p">,</span> <span class="s1">&#39;YSYMM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZSYMM&#39;</span><span class="p">,</span> <span class="s1">&#39;ENCASTRE&#39;</span><span class="p">,</span> <span class="s1">&#39;PINNED&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matdb</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">secdb</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new properties database.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prop</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nprop</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eprop</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matDB</span> <span class="o">=</span> <span class="n">matdb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secDB</span> <span class="o">=</span> <span class="n">secdb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matDB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matDB</span>

    <span class="nd">@matDB</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">matDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matdb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the global materials database.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        matdb: :class:`MaterialDB`</span>
<span class="sd">            A MateriaDB object or data to initialize it.</span>
<span class="sd">            If matdb is a :class:`MaterialDB` MaterialDB, it will be used</span>
<span class="sd">            directly in the properties. Else, a new MaterialDB will be</span>
<span class="sd">            created, initialized from matdb. An empty string loads the</span>
<span class="sd">            configured materials database, while {} creates an empty MaterialDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">_matDB</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matdb</span><span class="p">,</span> <span class="n">MaterialDB</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matDB</span> <span class="o">=</span> <span class="n">matdb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matDB</span> <span class="o">=</span> <span class="n">MaterialDB</span><span class="p">(</span><span class="n">matdb</span><span class="p">)</span>
        <span class="n">_matDB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matDB</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">secDB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_secDB</span>

    <span class="nd">@secDB</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">secDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secdb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the global sections database.</span>

<span class="sd">        If sec is a SectionDB, it will directly be used in the properties.</span>
<span class="sd">        Else, a new SectionDB will be created, initialized from sec.</span>
<span class="sd">        The default None will load the configure sections database,</span>
<span class="sd">        while {} will create an empty SectionDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">_secDB</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">secdb</span><span class="p">,</span> <span class="n">SectionDB</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_secDB</span> <span class="o">=</span> <span class="n">secdb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_secDB</span> <span class="o">=</span> <span class="n">SectionDB</span><span class="p">(</span><span class="n">secdb</span><span class="p">)</span>
        <span class="n">_secDB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_secDB</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">autoName</span><span class="p">(</span><span class="n">clas</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">autoName</span><span class="p">((</span><span class="n">kind</span><span class="o">+</span><span class="s1">&#39;set&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="PropertyDB.print"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print the property database&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;General properties&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Node properties&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Element properties&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></div>


<div class="viewcode-block" id="PropertyDB.Prop"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.Prop">[docs]</a>    <span class="k">def</span> <span class="nf">Prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new property, empty by default.</span>

<span class="sd">        A property can hold almost anything, just like any Dict type.</span>
<span class="sd">        It has however four predefined keys that should not be used for</span>
<span class="sd">        anything else than explained hereafter:</span>

<span class="sd">        - nr: a unique id, that never should be set/changed by the user.</span>
<span class="sd">        - tag: an identification tag used to group properties</span>
<span class="sd">        - name: the name to be used for this set. Default is to use an</span>
<span class="sd">          automatically generated name.</span>
<span class="sd">        - set: identifies the geometrical elements for which the defined</span>
<span class="sd">          properties will hold. This can be either:</span>

<span class="sd">          - a single number,</span>
<span class="sd">          - a list of numbers,</span>
<span class="sd">          - the name of an already defined set,</span>
<span class="sd">          - a list of such names.</span>

<span class="sd">        Besides these, any other fields may be defined and will be added</span>
<span class="sd">        without checking.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">CDict</span><span class="p">()</span>
        <span class="c1"># update with kargs first, to make sure tag,set and nr are sane</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">kargs</span><span class="p">))</span>

        <span class="n">prop</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">+</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">nr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;setname&#39;</span> <span class="ow">in</span> <span class="n">kargs</span><span class="p">:</span>
            <span class="c1"># allow for backwards compatibility</span>
            <span class="n">pf</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;warn_properties_setname&quot;</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">kargs</span><span class="p">[</span><span class="s1">&#39;setname&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1">### convenience to allow set=&#39;name&#39; as alias for name=&#39;name&#39;</span>
            <span class="c1">### to reuse already defined set</span>
            <span class="n">name</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">,</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoName</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">nr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Property name should be a string&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="nb">set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="nb">set</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">]</span>
            <span class="n">d</span><span class="o">.</span><span class="n">set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

        <span class="n">prop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="PropertyDB.getProp"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.getProp">[docs]</a>    <span class="k">def</span> <span class="nf">getProp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">[],</span> <span class="n">noattr</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># TODO: This should maybe change to operate on the property keys</span>
        <span class="c1"># and finally return the selected keys or properties?</span>
        <span class="sd">&quot;&quot;&quot;Return all properties of type kind matching tag and having attr.</span>

<span class="sd">        kind is either &#39;&#39;, &#39;n&#39;, &#39;e&#39; or &#39;m&#39;</span>
<span class="sd">        If rec is given, it is a list of record numbers or a single number.</span>
<span class="sd">        If a tag or a list of tags is given, only the properties having a</span>
<span class="sd">        matching tag attribute are returned.</span>

<span class="sd">        attr and noattr are lists of attributes. Only the properties having</span>
<span class="sd">        all the attributes in attr and none of the properties in noattr are</span>
<span class="sd">        returned.</span>
<span class="sd">        Attributes whose value is None are treated as non-existing.</span>

<span class="sd">        If delete==True, the returned properties are removed from the database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">+</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="n">rec</span><span class="p">]</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rec</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">prop</span><span class="p">)]</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">prop</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="p">]</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">]</span>  <span class="c1"># tags are always converted to strings</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prop</span> <span class="k">if</span> <span class="s1">&#39;tag&#39;</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tag</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prop</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">noattr</span><span class="p">:</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prop</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prop</span></div>


    <span class="k">def</span> <span class="nf">_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete the specified properties from the database.</span>

<span class="sd">        plist is a list of property records (not copies of them!),</span>
<span class="sd">        such as returned by getProp.</span>
<span class="sd">        The kind parameter can specify a specific property database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">+</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">plist</span> <span class="o">=</span> <span class="p">[</span><span class="n">plist</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">RemoveListItem</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sanitize</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_sanitize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sanitize the record numbers after deletion&quot;&quot;&quot;</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">+</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
            <span class="n">p</span><span class="o">.</span><span class="n">nr</span> <span class="o">=</span> <span class="n">i</span>


<div class="viewcode-block" id="PropertyDB.delProp"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.delProp">[docs]</a>    <span class="k">def</span> <span class="nf">delProp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Delete properties.</span>

<span class="sd">        This is equivalent to getProp() but the returned properties</span>
<span class="sd">        are removed from the database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span> <span class="n">rec</span><span class="o">=</span><span class="n">rec</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PropertyDB.nodeProp"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.nodeProp">[docs]</a>    <span class="k">def</span> <span class="nf">nodeProp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">displ</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">veloc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">accel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">csys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">ampl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new node property, empty by default.</span>

<span class="sd">        A node property can contain any combination of the following fields:</span>

<span class="sd">        - tag: an identification tag used to group properties (this is e.g.</span>
<span class="sd">          used to flag Step, increment, load case, ...)</span>
<span class="sd">        - set: a single number or a list of numbers identifying the node(s)</span>
<span class="sd">          for which this property will be set, or a set name</span>
<span class="sd">          If None, the property will hold for all nodes.</span>
<span class="sd">        - cload: a concentrated load: a list of 6 float values</span>
<span class="sd">          [FX,FY,FZ,MX,MY,MZ] or a list of (dofid,value) tuples.</span>
<span class="sd">        - displ,veloc,accel: prescribed displacement, velocity or</span>
<span class="sd">          acceleration: a list of 6 float values [UX,UY,UZ,RX,RY,RZ] or</span>
<span class="sd">          a list of tuples (dofid,value)</span>
<span class="sd">        - bound: a boundary condition: a string, a list of 6 codes (0/1), or</span>
<span class="sd">          a list of tuples (dofid, value)</span>
<span class="sd">        - csys: a CoordSystem</span>
<span class="sd">        - ampl: the name of an Amplitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">kargs</span>
            <span class="k">if</span> <span class="n">cload</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;cload&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkArrayOrIdValue</span><span class="p">(</span><span class="n">cload</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">displ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;displ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkArrayOrIdValueOrEmpty</span><span class="p">(</span><span class="n">displ</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">veloc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;veloc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkArrayOrIdValueOrEmpty</span><span class="p">(</span><span class="n">veloc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">accel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;accel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkArrayOrIdValueOrEmpty</span><span class="p">(</span><span class="n">accel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">checkString</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bound_strings</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">at</span><span class="o">.</span><span class="n">checkArray1D</span><span class="p">(</span><span class="n">bound</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">d</span><span class="p">[</span><span class="s1">&#39;bound&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bound</span>  <span class="c1"># unchecked</span>
            <span class="k">if</span> <span class="n">csys</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">csys</span><span class="p">,</span> <span class="n">CoordSystem</span><span class="p">):</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;csys&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csys</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Coordinate System&quot;</span><span class="p">)</span>

            <span class="c1"># Currently unchecked!</span>
            <span class="k">if</span> <span class="n">ampl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;ampl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ampl</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="nb">set</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tag=</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">, set=</span><span class="si">{</span><span class="nb">set</span><span class="si">}</span><span class="s2">, name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, cload=</span><span class="si">{</span><span class="n">cload</span><span class="si">}</span><span class="s2">, &quot;</span>
                  <span class="sa">f</span><span class="s2">&quot;bound=</span><span class="si">{</span><span class="n">bound</span><span class="si">}</span><span class="s2">, displ=</span><span class="si">{</span><span class="n">displ</span><span class="si">}</span><span class="s2">, csys=</span><span class="si">{</span><span class="n">csys</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Node Property&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PropertyDB.elemProp"><a class="viewcode-back" href="../../ref/plugins.properties.html#plugins.properties.PropertyDB.elemProp">[docs]</a>    <span class="k">def</span> <span class="nf">elemProp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">section</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eltype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">ampl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new element property, empty by default.</span>

<span class="sd">        An elem property can contain any combination of the following fields:</span>

<span class="sd">        - tag: an identification tag used to group properties (this is e.g.</span>
<span class="sd">          used to flag Step, increment, load case, ...)</span>
<span class="sd">        - set: a single number or a list of numbers identifying the element(s)</span>
<span class="sd">          for which this property will be set, or a set name</span>
<span class="sd">          If None, the property will hold for all elements.</span>
<span class="sd">        - grp: an elements group number (default None). If specified, the</span>
<span class="sd">          element numbers given in set are local to the specified group.</span>
<span class="sd">          If not, elements are global and should match the global numbering</span>
<span class="sd">          according to the order in which element groups will be specified</span>
<span class="sd">          in the Model.</span>
<span class="sd">        - eltype: the element type (currently in Abaqus terms).</span>
<span class="sd">        - section: an ElemSection specifying the element section properties.</span>
<span class="sd">        - dload: an ElemLoad specifying a distributed load on the element.</span>
<span class="sd">        - ampl: the name of an Amplitude</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">eltype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;eltype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eltype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;section&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">section</span>
            <span class="k">if</span> <span class="n">dload</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dload&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dload</span>
            <span class="k">if</span> <span class="n">eload</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;eload&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eload</span>
            <span class="c1"># Currently unchecked!</span>
            <span class="k">if</span> <span class="n">ampl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;ampl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ampl</span>
            <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="nb">set</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid Elem Property</span><span class="se">\n</span><span class="s2">  tag=</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">, set=</span><span class="si">{</span><span class="nb">set</span><span class="si">}</span><span class="s2">, name=</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;eltype=</span><span class="si">{</span><span class="n">eltype</span><span class="si">}</span><span class="s2">, section=</span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">, dload=</span><span class="si">{</span><span class="n">dload</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;eload=</span><span class="si">{</span><span class="n">eload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a deep copy of ourself.&quot;&quot;&quot;</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="n">newdict</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">newdict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">memo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newdict</span></div>


<span class="c1">##################################### Test ###########################</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__script__&#39;</span> <span class="ow">or</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__draw__&#39;</span><span class="p">:</span>

    <span class="n">P</span> <span class="o">=</span> <span class="n">PropertyDB</span><span class="p">()</span>

    <span class="n">Stick</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Stick&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                   <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;This could be anything: a gum, a frog, a usb-stick,...&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Stick</span><span class="p">)</span>

    <span class="n">author</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;Alfred E Neuman&#39;</span><span class="p">,</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">Dict</span><span class="p">({</span><span class="s1">&#39;street&#39;</span><span class="p">:</span> <span class="s1">&#39;Krijgslaan&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;Gent&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">}))</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">Stick</span><span class="o">.</span><span class="n">weight</span><span class="o">=</span><span class="mi">30</span>
    <span class="n">Stick</span><span class="o">.</span><span class="n">length</span><span class="o">=</span><span class="mi">10</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Stick</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">street</span><span class="p">)</span>
    <span class="n">author</span><span class="o">.</span><span class="n">street</span><span class="o">=</span><span class="s1">&#39;Voskenslaan&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">street</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">street</span><span class="p">)</span>
    <span class="n">author</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">street</span> <span class="o">=</span> <span class="s1">&#39;Wiemersdreef&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">street</span><span class="p">)</span>

    <span class="n">author</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
                    <span class="n">address</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;street&#39;</span><span class="p">:</span> <span class="s1">&#39;Downing Street 10&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">rec</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">nr</span><span class="p">)</span>


    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;green_elements&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;green_elements&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">thickness</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>
    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="s1">&#39;steel&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="s1">&#39;green_elements&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;green_elements&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">nr</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">transparent</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;transparent&#39;</span><span class="p">],</span> <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">P</span><span class="o">.</span><span class="n">delProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">rec</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span>
    <span class="n">P</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">Amplitude</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">times</span><span class="p">,</span> <span class="n">values</span><span class="p">]))</span>
    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="n">amp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;amp1&#39;</span><span class="p">)</span>

    <span class="n">P1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
    <span class="n">B1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
    <span class="n">CYL</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;cylindrical&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># node property on single node</span>
    <span class="n">P</span><span class="o">.</span><span class="n">nodeProp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cload</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="c1"># node property on nodes 2 and 3</span>
    <span class="n">P</span><span class="o">.</span><span class="n">nodeProp</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">bound</span><span class="o">=</span><span class="s1">&#39;pinned&#39;</span><span class="p">)</span>
    <span class="c1"># node property on ALL nodes</span>
    <span class="n">P</span><span class="o">.</span><span class="n">nodeProp</span><span class="p">(</span><span class="n">cload</span><span class="o">=</span><span class="n">P1</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">B1</span><span class="p">,</span> <span class="n">csys</span><span class="o">=</span><span class="n">CYL</span><span class="p">,</span> <span class="n">ampl</span><span class="o">=</span><span class="s1">&#39;amp1&#39;</span><span class="p">)</span>
    <span class="c1"># node property whose set will be reused</span>
    <span class="n">nset1</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">nodeProp</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;step1&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">cload</span><span class="o">=</span><span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">nr</span>
    <span class="c1"># node properties with an already named set</span>
    <span class="n">P</span><span class="o">.</span><span class="n">nodeProp</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;step2&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="n">Nset</span><span class="p">(</span><span class="n">nset1</span><span class="p">),</span> <span class="n">cload</span><span class="o">=</span><span class="n">P2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nodeproperties&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">nprop</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all nodeproperties&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;properties 0 and 2&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tags 1 and step1&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;step1&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cload attributes&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cload&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># Load the configured databases</span>
    <span class="n">P</span><span class="o">.</span><span class="n">matDB</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">P</span><span class="o">.</span><span class="n">secDB</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">matDB</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">secDB</span><span class="p">)</span>

    <span class="n">vert</span> <span class="o">=</span> <span class="n">ElemSection</span><span class="p">(</span><span class="s1">&#39;IPEA100&#39;</span><span class="p">,</span> <span class="s1">&#39;steel&#39;</span><span class="p">)</span>
    <span class="n">hor</span> <span class="o">=</span> <span class="n">ElemSection</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;IPEM800&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">951247</span><span class="p">,</span>
                       <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="n">CDict</span><span class="p">({</span><span class="s1">&#39;Ix&#39;</span><span class="p">:</span> <span class="mi">1542</span><span class="p">,</span> <span class="s1">&#39;Iy&#39;</span><span class="p">:</span> <span class="mi">6251</span><span class="p">,</span> <span class="s1">&#39;Ixy&#39;</span><span class="p">:</span> <span class="mi">352</span><span class="p">})},</span>
                      <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;S400&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">210</span><span class="p">,</span> <span class="s1">&#39;fy&#39;</span><span class="p">:</span> <span class="mi">400</span><span class="p">})</span>
    <span class="n">circ</span> <span class="o">=</span> <span class="n">ElemSection</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;sectiontype&#39;</span><span class="p">:</span> <span class="s1">&#39;circ&#39;</span><span class="p">},</span>
                       <span class="s1">&#39;steel&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Materials&quot;</span><span class="p">)</span>
    <span class="n">Mat</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">matDB</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">Mat</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Mat</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sections&quot;</span><span class="p">)</span>
    <span class="n">Sec</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">secDB</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Sec</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">Sec</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>

    <span class="n">q1</span> <span class="o">=</span> <span class="n">ElemLoad</span><span class="p">(</span><span class="s1">&#39;PZ&#39;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="n">ElemLoad</span><span class="p">(</span><span class="s1">&#39;PY&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elemProp</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;B22&#39;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">hor</span><span class="p">,</span> <span class="n">dload</span><span class="o">=</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elemProp</span><span class="p">(</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;B22&#39;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">vert</span><span class="p">)</span>
    <span class="n">diagonal</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elemProp</span><span class="p">(</span><span class="n">eltype</span><span class="o">=</span><span class="s1">&#39;B22&#39;</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">hor</span><span class="p">)</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elemProp</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">hor</span><span class="p">,</span> <span class="n">dload</span><span class="o">=</span><span class="n">q2</span><span class="p">,</span> <span class="n">ampl</span><span class="o">=</span><span class="s1">&#39;amp1&#39;</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;elemproperties&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">eprop</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;section properties&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;section&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">nr</span><span class="p">)</span>

    <span class="n">P</span><span class="o">.</span><span class="n">Prop</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="s1">&#39;cylinder&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cylsurf&#39;</span><span class="p">,</span> <span class="n">surftype</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SNEG&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">getProp</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;surftype&#39;</span><span class="p">]))</span>

<span class="c1"># End</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href="">plugins.properties</a></li--> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2023, Benedict Verhegghe.
    </span>
      Last updated on Mar 27, 2023.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.3.
    </span>
    </div>
  </body>
</html>