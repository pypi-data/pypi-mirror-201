

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!--
##
##  This file is part of the pyFormex project.
##  pyFormex is a tool for generating, manipulating and transforming 3D
##  geometrical models by sequences of mathematical operations.
##  Home page: http://pyformex.org
##  Project page:  http://savannah.nongnu.org/projects/pyformex/
##  Copyright (C) Benedict Verhegghe (benedict.verhegghe@ugent.be)
##  Distributed under the GNU General Public License version 3 or later.
##
##
##  This program is free software: you can redistribute it and/or modify
##  it under the terms of the GNU General Public License as published by
##  the Free Software Foundation, either version 3 of the License, or
##  (at your option) any later version.
##
##  This program is distributed in the hope that it will be useful,
##  but WITHOUT ANY WARRANTY; without even the implied warranty of
##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##  GNU General Public License for more details.
##
##  You should have received a copy of the GNU General Public License
##  along with this program.  If not, see http://www.gnu.org/licenses/.
##
-->
    <title>gui.menu &#8212; pyFormex 3.3 documentation</title>

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pyformex.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="icon" type="image/png" href="../../_static/pyformex_fav.png" />

  </head><body>

<div class="header">
  <a href="http://pyformex.org">
  <img src="../../_static/scallop_dome_small.png" alt="scallop dome" border="0" hspace="20" vspace="12" align="left" />
  <img src="../../_static/pyformex-logo-2.png" alt="pyformex logo" border="0" hspace="10" vspace="8" align="left" />
  </a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href="">gui.menu</a></li--> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<!-- PYFORMEX_SIDEBAR_LOGO -->
<!-- PYFORMEX_WEBSITE_SIDEBAR_TOP -->

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for gui.menu</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">##</span>
<span class="c1">##  SPDX-FileCopyrightText: Â© 2007-2023 Benedict Verhegghe &lt;bverheg@gmail.com&gt;</span>
<span class="c1">##  SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="c1">##</span>
<span class="c1">##  This file is part of pyFormex 3.3  (Sun Mar 26 20:16:15 CEST 2023)</span>
<span class="c1">##  pyFormex is a tool for generating, manipulating and transforming 3D</span>
<span class="c1">##  geometrical models by sequences of mathematical operations.</span>
<span class="c1">##  Home page: https://pyformex.org</span>
<span class="c1">##  Project page: https://savannah.nongnu.org/projects/pyformex/</span>
<span class="c1">##  Development: https://gitlab.com/bverheg/pyformex</span>
<span class="c1">##  Distributed under the GNU General Public License version 3 or later.</span>
<span class="c1">##</span>
<span class="c1">##  This program is free software: you can redistribute it and/or modify</span>
<span class="c1">##  it under the terms of the GNU General Public License as published by</span>
<span class="c1">##  the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">##  (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1">##  This program is distributed in the hope that it will be useful,</span>
<span class="c1">##  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">##  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">##  GNU General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1">##  You should have received a copy of the GNU General Public License</span>
<span class="c1">##  along with this program.  If not, see http://www.gnu.org/licenses/.</span>
<span class="c1">##</span>
<span class="sd">&quot;&quot;&quot;Menus for the pyFormex GUI.</span>

<span class="sd">This modules implements specialized classes and functions for building</span>
<span class="sd">the pyFormex GUI menu system.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pyformex</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="kn">from</span> <span class="nn">pyformex</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">pyformex</span> <span class="kn">import</span> <span class="n">script</span>
<span class="kn">from</span> <span class="nn">pyformex.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">pyformex.gui</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QPixmap</span>

<span class="c1">############################# Menu ##############################</span>

<div class="viewcode-block" id="BaseMenu"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu">[docs]</a><span class="k">class</span> <span class="nc">BaseMenu</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;A generic hierarchical menu class.</span>

<span class="sd">    The BaseMenu is a mixin class for Qt menu widgets. It has the</span>
<span class="sd">    following advantages over using plain Qt:</span>

<span class="sd">    - all the menu data can be collected in an easy readable form and</span>
<span class="sd">      then inserted at once in a menu,</span>
<span class="sd">    - an action item can have data stored that is passed to the</span>
<span class="sd">      action&#39;s function,</span>
<span class="sd">    - an item can also be a list of items, and a submenu is created</span>
<span class="sd">      automatically,</span>
<span class="sd">    - an item can even be any type of data and it will be stored in the item.</span>
<span class="sd">    - the menu can have a global function triggered by all the items in</span>
<span class="sd">      the menu or its submenu, and then operate on the triggering action</span>
<span class="sd">      according to the data stored in the item.</span>
<span class="sd">    - items can be easily looked up in the menu through a normalized</span>
<span class="sd">      item text. This facilitates dynamical changes to the menu.</span>

<span class="sd">    This class is not intended for direct use, but through the subclasses</span>
<span class="sd">    :class:`Menu` and :class`MenuBar`, which pack the QtWidgets.QMenu and</span>
<span class="sd">    QtWidgets.QMenuBar. See Notes if you want to create a subclass yourself.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent: QWidget</span>
<span class="sd">        The parent widget, which can be a BaseMenu itself. If provided,</span>
<span class="sd">        the menu will be added to that widget.</span>
<span class="sd">    before: str</span>
<span class="sd">        The name of an item in the parent menu. If parent was provided</span>
<span class="sd">        and is a BaseMenu having an item with that name, the menu will</span>
<span class="sd">        be inserted before that item instead of at the end.</span>
<span class="sd">    items: list</span>
<span class="sd">        A list of items to insert in the menu. See :meth:`insertItems`.</span>
<span class="sd">    func: callable</span>
<span class="sd">        A function that will be called whenever an item in the menu is</span>
<span class="sd">        clicked. The function is passed the triggering action as an</span>
<span class="sd">        argument.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Subclasses should implement at least the following methods:</span>

<span class="sd">    - addSeparator()</span>
<span class="sd">    - insertSeparator(before)</span>
<span class="sd">    - addAction(text,action)</span>
<span class="sd">    - insertAction(before,text,action)</span>
<span class="sd">    - addMenu(text,menu)</span>
<span class="sd">    - insertMenu(before,text,menu)</span>
<span class="sd">    - title(): returning the menu title</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a menu.&quot;&quot;&quot;</span>
        <span class="n">pf</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating menu </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">MENU</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertItems</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">BaseMenu</span><span class="p">):</span>
            <span class="n">before</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">before</span><span class="p">)</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">insert_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">before</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>

<div class="viewcode-block" id="BaseMenu.insertItems"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.insertItems">[docs]</a>    <span class="k">def</span> <span class="nf">insertItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a list of items in the menu.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        items: list</span>
<span class="sd">            A list of menuitem tuples. Each item is a tuple of two</span>
<span class="sd">            or three elements: (text, action, options):</span>

<span class="sd">            - text: the string that will be displayed in the menu.</span>
<span class="sd">              It can contain a &#39;&amp;&#39; before the character that will be</span>
<span class="sd">              used as a hot key for navigating the menu with the keyboard.</span>
<span class="sd">              In lookup operations the string is normalized by removing</span>
<span class="sd">              any &#39;&amp;&#39; characters and converting the text to lower case.</span>

<span class="sd">            - action: what to do when the menu item is selected.</span>
<span class="sd">              It can be any of the following:</span>

<span class="sd">              - None: a separator is inserted the items and it can not be</span>
<span class="sd">                selected itself.</span>
<span class="sd">              - list: the list should again be a list of menu items.</span>
<span class="sd">                A :class:`Menu` is created from it and treated as below.</span>
<span class="sd">              - :class:`Menu`: the menu will popup when the item is selected.</span>
<span class="sd">              - a Python function or instance method: the function is</span>
<span class="sd">                executed when the item is clicked. If `options` has a key</span>
<span class="sd">                `data`, its value will be passed as the single argument.</span>
<span class="sd">                Else, no argument is passed.</span>
<span class="sd">              - anything else will be stored as data in the action. This is</span>
<span class="sd">                useful in combination with a menuwide function `func`.</span>

<span class="sd">            - options: optional dictionary with following recognized keys:</span>

<span class="sd">              - &#39;icon&#39;: the name of an icon to be displayed with the item text.</span>
<span class="sd">                It should be one of the icons in the pyFormex</span>
<span class="sd">                configured icon dirs.</span>
<span class="sd">              - &#39;shortcut&#39;: an optional key combination to select the item.</span>
<span class="sd">              - &#39;tooltip&#39;: a help text to popup when the mouse is over the item.</span>
<span class="sd">              - &#39;checkable&#39;: if True, a item will present a check box.</span>
<span class="sd">              - &#39;checked&#39;: if True and checkable, the item&#39;s checkbox will</span>
<span class="sd">                initially be checked.</span>
<span class="sd">              - &#39;disabled&#39;: if True, the item will initially be disabled.</span>
<span class="sd">        before: str | QAction, optional</span>
<span class="sd">            If provided, the items will be inserted before the specified item.</span>
<span class="sd">            It should be the text *or* the action of one of the items already</span>
<span class="sd">            in self before this insert operation is started.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pf</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inserting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s2"> items in menu </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                 <span class="n">pf</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">MENU</span><span class="p">)</span>
        <span class="n">before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">before</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">txt</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="c1">#pf.debug(f&quot;Inserting {txt}: {val}&quot;, pf.DEBUG.MENU)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span>  <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># separator</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_sep</span><span class="p">(</span><span class="n">before</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>  <span class="c1"># Separators should have no text</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># submenu</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">before</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
                <span class="n">a</span><span class="o">.</span><span class="n">insertItems</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">BaseMenu</span><span class="p">):</span>
                <span class="c1"># also submenu</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insert_menu</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">before</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># action</span>
                <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">val</span><span class="p">,</span>
                               <span class="n">data</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="c1"># function is executed when triggering the item</span>
                    <span class="c1"># if &#39;data&#39; in options:</span>
                    <span class="c1">#     a = DAction(txt, parent=self, data = options.pop(&#39;data&#39;))</span>
                    <span class="c1">#     a.signal.connect(val)</span>
                    <span class="c1">#     # elif &#39;args&#39; in options:</span>
                    <span class="c1"># else:</span>
                    <span class="c1"># else:</span>
                    <span class="c1">#     a = QtWidgets.QAction(txt, parent=self)</span>
                    <span class="c1">#     a.triggered.connect(val)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># don&#39;t know what to do: just store it</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insert_action</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">before</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;icon&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">findIcon</span><span class="p">(</span><span class="n">v</span><span class="p">))))</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;shortcut&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;tooltip&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;checkable&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;checked&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;disabled&#39;</span><span class="p">:</span>
                        <span class="n">a</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="c1"># The need for the following functions demonstrates how much more</span>
    <span class="c1"># powerful a dynamically typed language as Python is as compared to</span>
    <span class="c1"># the C++ language used by Qt</span>
<div class="viewcode-block" id="BaseMenu.insert_sep"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.insert_sep">[docs]</a>    <span class="k">def</span> <span class="nf">insert_sep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create and insert a separator&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">before</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insertSeparator</span><span class="p">(</span><span class="n">before</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseMenu.insert_menu"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.insert_menu">[docs]</a>    <span class="k">def</span> <span class="nf">insert_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert an existing menu.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">before</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insertMenu</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">menu</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseMenu.insert_action"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.insert_action">[docs]</a>    <span class="k">def</span> <span class="nf">insert_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert an action.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">before</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">insertAction</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseMenu.itemNames"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.itemNames">[docs]</a>    <span class="k">def</span> <span class="nf">itemNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of normalized names of all items&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">strNorm</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()]</span></div>

<div class="viewcode-block" id="BaseMenu.menuNames"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.menuNames">[docs]</a>    <span class="k">def</span> <span class="nf">menuNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of normalized names of the submenus&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">strNorm</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">menu</span><span class="p">()]</span></div>

<div class="viewcode-block" id="BaseMenu.separators"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.separators">[docs]</a>    <span class="k">def</span> <span class="nf">separators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of separators&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">isSeparator</span><span class="p">()]</span></div>

<div class="viewcode-block" id="BaseMenu.index"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.index">[docs]</a>    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the named item.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text: str</span>
<span class="sd">            The text of one of the items in the menu. Case is ignored and</span>
<span class="sd">            &amp;&#39;s are removed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int:</span>
<span class="sd">            The index of the item in the menu, or -1 if there is no item with</span>
<span class="sd">            that name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemNames</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">strNorm</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>

<div class="viewcode-block" id="BaseMenu.action"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.action">[docs]</a>    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the action with the specified text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text: str</span>
<span class="sd">            The text of one of the items in the menu. Case is ignored and</span>
<span class="sd">            &amp;&#39;s are removed. A string like &#39;---i&#39; returns the i-th separator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QAction | QSeparator</span>
<span class="sd">            The QAction or QSeparator with the specified text, or None.</span>
<span class="sd">            Note that Daction and submenu items are also QAction instances.</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        item: like action, but returns a Menu for submenu items.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">separators</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">text</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BaseMenu.getItem"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.getItem">[docs]</a>    <span class="k">def</span> <span class="nf">getItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the item with specified text.</span>

<span class="sd">        This is like :meth:`action`, but returns the Menu for submenu items.</span>
<span class="sd">        The same is also obtained by simply indexing the menu: menu[text].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">m</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">a</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="fm">__getitem__</span> <span class="o">=</span> <span class="n">getItem</span>  <span class="c1"># allow indexing to get an item</span>

<div class="viewcode-block" id="BaseMenu.nextItem"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.nextItem">[docs]</a>    <span class="k">def</span> <span class="nf">nextItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the next item in the menu.</span>

<span class="sd">        This can be used to replace the current item with another menu</span>
<span class="sd">        or to reload a menu.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item: QAction | text</span>
<span class="sd">            One of the items in the menu. To get an item from its text,</span>
<span class="sd">            use :meth:`action`, not :meth:`getItem`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QAction</span>
<span class="sd">            The next item in the Menu, or None if item was not in self.actions().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">())</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="BaseMenu.removeItem"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.removeItem">[docs]</a>    <span class="k">def</span> <span class="nf">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove an item from this menu.&quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">):</span>
                <span class="n">action</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">action</span></div>

<div class="viewcode-block" id="BaseMenu.report"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.BaseMenu.report">[docs]</a>    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a report of the menu with the items and submenus.</span>

<span class="sd">        If recursive, also add report of the submenus.</span>
<span class="sd">        Beware: this may get huge</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fullname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">=== MENU: </span><span class="si">{</span><span class="n">fullname</span><span class="si">}</span><span class="s2"> ===</span>
<span class="s2">ACTIONS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">itemNames</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">SUBMENUS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">menuNames</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">():</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">BaseMenu</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="n">m</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">fullname</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span></div></div>


<span class="c1">################################ Menu ##################################</span>

<div class="viewcode-block" id="Menu"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.Menu">[docs]</a><span class="k">class</span> <span class="nc">Menu</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">,</span> <span class="n">BaseMenu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A popup/pulldown menu.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    title: str</span>
<span class="sd">        The name of the menu.</span>
<span class="sd">    parent: QWidget, optional</span>
<span class="sd">        If parent is a QMenu, the Menu will automatically</span>
<span class="sd">        be inserted in the parent. If parent is pf.GUI, the menu is</span>
<span class="sd">        inserted in the main window&#39;s menu bar. If not provided,</span>
<span class="sd">        the menu is a standalone popup menu.</span>
<span class="sd">    before, items, func: see :class:`BaseMenu`</span>
<span class="sd">    tearoff: bool</span>
<span class="sd">        If True, the Menu can be teared of from its parent and used as</span>
<span class="sd">        a standalone popup menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Menu&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the Menu.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">BaseMenu</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">before</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Dialog</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tearoff</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TEAR OFF menus are experimental&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setTearOffEnabled</span><span class="p">(</span><span class="n">tearoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Menu.remove"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.Menu.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close a Menu and remove it from its parent&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">removeItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">())</span></div>


<div class="viewcode-block" id="Menu.toolbar"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.Menu.toolbar">[docs]</a>    <span class="k">def</span> <span class="nf">toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new toolbar corresponding to the menu.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: Fix this error!</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolBar</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NEW TOOLBAR </span><span class="si">{</span><span class="n">nb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADDED ACTION </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">tb</span></div></div>


<span class="c1">################################ MenuBar ##################################</span>

<div class="viewcode-block" id="MenuBar"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.MenuBar">[docs]</a><span class="k">class</span> <span class="nc">MenuBar</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenuBar</span><span class="p">,</span> <span class="n">BaseMenu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A menu bar allowing easy menu creation.</span>

<span class="sd">    This can be set as the main window menubar using</span>
<span class="sd">    :meth:`QMainWindow.setMenuBar`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MenuBar&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create the menubar.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">title</span>  <span class="c1"># QMEnuBar does not have title</span>
        <span class="n">BaseMenu</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="n">before</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span></div>


<span class="c1">###################### Action List #########################################</span>


<div class="viewcode-block" id="Action"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.Action">[docs]</a><span class="k">class</span> <span class="nc">Action</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An Action is an executable menu item.</span>

<span class="sd">    The Action class provides some extra functionality over the default QAction.</span>
<span class="sd">    It can store an executable function and directly call it instead of using a</span>
<span class="sd">    signal. It can store any data and pass these data to the executed function.</span>
<span class="sd">    If the Action is inserted in a Menu that has its own executable function,</span>
<span class="sd">    that function can detect if the item has its own function and ignore it,</span>
<span class="sd">    or it can detect the stored data and act according to these data.</span>
<span class="sd">    An Action can be inserted in a Menu or in a Toolbar.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        The name of the item. In a Menu, this is the text displayed on the item.</span>
<span class="sd">        In a Toolbar the name may or may not be displayed. The name can be used</span>
<span class="sd">        to get the item from the Menu or Toolbar.</span>
<span class="sd">    parent: Menu</span>
<span class="sd">        The menu in which to insert the action. Inserting an item in a Menu</span>
<span class="sd">        makes sure the item is kept alive and selecting it will trigger the</span>
<span class="sd">        menu&#39;s function if it has one. The Action can be accessed as menu[name].</span>
<span class="sd">    icon: QICon | :term:`path_like`</span>
<span class="sd">        An icon for display in a Toolbar. It can be a QICon instance, or</span>
<span class="sd">        (more approperiately) the path to a file storing an image.</span>
<span class="sd">    func: callable</span>
<span class="sd">        If provided, the function is recorded in the Action and will be executed</span>
<span class="sd">        when the Action is triggered. The stored `data` will be passed as</span>
<span class="sd">        arguments. If an Action with a func is inserted in a Menu that has</span>
<span class="sd">        it&#39;s own executable function, it is often unwanted that both functions</span>
<span class="sd">        are executed. The menu function is passed the action as an argument</span>
<span class="sd">        and can detect that the action itself has a triggered executable from</span>
<span class="sd">        looking at ``action.func``.</span>
<span class="sd">    data:</span>
<span class="sd">        Anything passed as data will be stored in the Action. These data are</span>
<span class="sd">        passed as arguments to `func` when executed. Without a `func`, data</span>
<span class="sd">        are also often used together with a Menu function. The Menu function</span>
<span class="sd">        gets the action as an argument and has access to the action&#39;s data as</span>
<span class="sd">        ``action.data()``.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The user can identify an Action by its name or its icon. It is customary</span>
<span class="sd">    to display the name in menus, and show the icon in toolbars. This is the</span>
<span class="sd">    default in pyFormex. It is however possible to also add the icons in a menu</span>
<span class="sd">    or show the names in a toolbar, but it has to be explicitely set or</span>
<span class="sd">    configured.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the Action&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">icon</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">):</span>
                <span class="n">icon</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">icon</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Icon </span><span class="si">{</span><span class="n">icon</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
                <span class="n">icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">icon</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="Action.execute"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.Action.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute the connected function&quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#print(&quot;EXECUTE FUNC WITHOUT ARGS&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1">#print(f&quot;EXECUTE FUNC WITH ARGS {args}&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#print(f&quot;EXECUTE FUNC WITH SINGLE ARG {args}&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ActionList"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList">[docs]</a><span class="k">class</span> <span class="nc">ActionList</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Menu and toolbar with named actions.</span>

<span class="sd">    An action list is a list of strings, each connected to some action.</span>
<span class="sd">    The actions can be presented in a menu and/or a toolbar.</span>
<span class="sd">    On activating one of the menu or toolbar buttons, a given signal is</span>
<span class="sd">    emitted with the button string as parameter. A fixed function can be</span>
<span class="sd">    connected to this signal to act dependent on the string value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="p">[],</span> <span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toolbar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">icons</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an new action list, empty by default.</span>

<span class="sd">        A list of strings can be passed to initialize the actions.</span>
<span class="sd">        If a menu and/or toolbar are passed, a button is added to them</span>
<span class="sd">        for each string in the action list.</span>
<span class="sd">        If a function is passed, it will be called with the string as</span>
<span class="sd">        parameter when the item is triggered.</span>

<span class="sd">        If no icon names are specified, they are taken equal to the</span>
<span class="sd">        action names. Icons will be taken from the installed icon directory.</span>
<span class="sd">        If you want to specify other icons, use the add() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">toolbar</span>
        <span class="k">if</span> <span class="n">icons</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">icons</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="n">icons</span> <span class="o">=</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">findIcon</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">icons</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">icons</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>


<div class="viewcode-block" id="ActionList.add"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a new name to the actions list and create a matching DAction.</span>

<span class="sd">        If the actions list has an associated menu or toolbar,</span>
<span class="sd">        a matching button will be inserted in each of these.</span>
<span class="sd">        If an icon is specified, it will be used on the menu and toolbar.</span>
<span class="sd">        The icon is either a filename or a QIcon object.</span>
<span class="sd">        If text is specified, it is displayed instead of the action&#39;s name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">Action</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>


<div class="viewcode-block" id="ActionList.remove"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove an action by name&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">removeAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">removeAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>


<div class="viewcode-block" id="ActionList.removeAll"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList.removeAll">[docs]</a>    <span class="k">def</span> <span class="nf">removeAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all actions from self&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="ActionList.names"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList.names">[docs]</a>    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return an ordered list of names of the action items.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>


<div class="viewcode-block" id="ActionList.toolbar"><a class="viewcode-back" href="../../ref/gui.menu.html#gui.menu.ActionList.toolbar">[docs]</a>    <span class="k">def</span> <span class="nf">toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new toolbar corresponding to the menu.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: Fix this error!</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolBar</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NEW TOOLBAR </span><span class="si">{</span><span class="n">nb</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADDED ACTION </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">tb</span></div></div>


<span class="c1"># End</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyFormex 3.3 documentation</a> &gt;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &gt;</li>
        <!--li class="nav-item nav-item-this"><a href="">gui.menu</a></li--> 
      </ul>
    </div>
    <div class="footer">
    <span class="left">
        &copy; Copyright 2004-2023, Benedict Verhegghe.
    </span>
      Last updated on Mar 27, 2023.
    <span class="right">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.4.3.
    </span>
    </div>
  </body>
</html>